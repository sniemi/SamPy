'''
Created on Jan 26, 2010

@author: niemi
'''
import pyfits as PF
import glob as G

filelist = G.glob('*.fits')


fuv_smov_v2_r_lamp = {'PEDIGREE' : 'INFLIGHT 06/08/2009 07/08/2009',
                      'USEAFTER' : 'August 17 2009 00:00:00',
                      'DESCRIP' : 'FUV Lamp template reference file from data obtained during SMOV',
                      'COMMENT' : 'Reference file created by S. Beland',
                      'HISTORY': '''Table below contains entries for
Rootname, program ID, TARGNAME, DETECTOR, EXPTIME, GRATING,\n CENWAVE, FPOFFSET
la8m01k5 11488 WAVE FUV  120.0 G130M 1291 -2
la8m01k7 11488 WAVE FUV  120.0 G130M 1291 -1
la8m01k9 11488 WAVE FUV  120.0 G130M 1291  0
la8m01kb 11488 WAVE FUV  120.0 G130M 1291  1
la8m01kj 11488 WAVE FUV  120.0 G130M 1300 -2
la8m01km 11488 WAVE FUV  120.0 G130M 1300 -1
la8m01ko 11488 WAVE FUV  120.0 G130M 1300  0
la8m01kr 11488 WAVE FUV  120.0 G130M 1300  1
la8m01kw 11488 WAVE FUV  120.0 G130M 1309  0
la8m01ky 11488 WAVE FUV  120.0 G130M 1309 -2
la8m01l1 11488 WAVE FUV  120.0 G130M 1309 -1
la8m01l3 11488 WAVE FUV  120.0 G130M 1309  0
la8m01l5 11488 WAVE FUV  120.0 G130M 1309  1
la8m01l8 11488 WAVE FUV  120.0 G130M 1309  0
la8m01lc 11488 WAVE FUV  120.0 G130M 1318 -2
la8m01le 11488 WAVE FUV  120.0 G130M 1318 -1
la8m01lg 11488 WAVE FUV  120.0 G130M 1318  0
la8m01li 11488 WAVE FUV  120.0 G130M 1318  1
la8m01lo 11488 WAVE FUV  120.0 G130M 1327 -2
la8m01lq 11488 WAVE FUV  120.0 G130M 1327 -1
la8m01lt 11488 WAVE FUV  120.0 G130M 1327  0
la8m01lv 11488 WAVE FUV  120.0 G130M 1327  1
la8m01m0 11488 WAVE FUV  120.0 G130M 1309  0
la8m02me 11488 WAVE FUV  120.0 G160M 1577 -2
la8m02mj 11488 WAVE FUV  120.0 G160M 1577 -1
la8m02ml 11488 WAVE FUV  120.0 G160M 1577  0
la8m02mn 11488 WAVE FUV  120.0 G160M 1577  1
la8m02mu 11488 WAVE FUV  120.0 G160M 1589 -2
la8m02mx 11488 WAVE FUV  120.0 G160M 1589 -1
la8m02mz 11488 WAVE FUV  120.0 G160M 1589  0
la8m02nq 11488 WAVE FUV  120.0 G160M 1589  1
la8m02nu 11488 WAVE FUV  120.0 G160M 1600  0
la8m02nw 11488 WAVE FUV  120.0 G160M 1600 -2
la8m02nz 11488 WAVE FUV  120.0 G160M 1600 -1
la8m02o1 11488 WAVE FUV  120.0 G160M 1600  0
la8m02o4 11488 WAVE FUV  120.0 G160M 1600  1
la8m02o8 11488 WAVE FUV  120.0 G160M 1600  0
la8m02oe 11488 WAVE FUV  120.0 G160M 1611 -2
la8m02oi 11488 WAVE FUV  120.0 G160M 1611 -1
la8m02om 11488 WAVE FUV  120.0 G160M 1611  0
la8m02oo 11488 WAVE FUV  120.0 G160M 1611  1
la8m02ov 11488 WAVE FUV  120.0 G160M 1623 -2
la8m02ox 11488 WAVE FUV  120.0 G160M 1623 -1
la8m02oz 11488 WAVE FUV  120.0 G160M 1623  0
la8m02p1 11488 WAVE FUV  120.0 G160M 1623  1
la8m02p9 11488 WAVE FUV  120.0 G160M 1600  0
la8m03pq 11488 WAVE FUV  120.0 G140L 1105 -2
la8m03pu 11488 WAVE FUV  120.0 G140L 1105 -1
la8m03pz 11488 WAVE FUV  120.0 G140L 1105  0
la8m03q1 11488 WAVE FUV  120.0 G140L 1105  1
la8m03q6 11488 WAVE FUV  120.0 G140L 1230  0
la8m03q8 11488 WAVE FUV  120.0 G140L 1230 -2
la8m03qa 11488 WAVE FUV  120.0 G140L 1230 -1
la8m03qc 11488 WAVE FUV  120.0 G140L 1230  0
la8m03qe 11488 WAVE FUV  120.0 G140L 1230  1
la8m03qg 11488 WAVE FUV  120.0 G140L 1230  0
See COS ISR 2010-06 for information on how
data was processed.'''}

fuv_disp_smov_1 = {'PEDIGREE' : 'INFLIGHT 06/08/2009 07/08/2009',
                   'USEAFTER' : 'August 17 2009 00:00:00',
                   'DESCRIP' : 'Dispersion relation reference file from on-orbit data',
                   'COMMENT' : 'Reference file created by C. Oliveira',
                   'HISTORY' :
'''See COS ISR 2010-06 for info on how file was created;
table 2, of the ISR contains rootnames of the exposures
used to produce reference file.'''}

t2314311l_wcp = {'PEDIGREE' : 'GROUND',
                 'USEAFTER' : 'August 17 2009 00:00:00',
                 'DESCRIP' : 'FUV Wavecal parameters reference table from TV2003 data',
                 'COMMENT' : 'Reference file created by S. Beland',
                 'HISTORY' :
'''This file is the same as t2314311l_wcp.fits and reverts to
the original dispersion direction search range which was increased
while the updates to the lamp and dispersion reference files were
pending, so that the calcos pipeline could find G130M spectra.'''}

nuv_smov1_r_lamp = {'PEDIGREE' : 'INFLIGHT 04/08/2009 08/08/2009',
                    'USEAFTER' : 'July 28 2009 00:00:00',
                    'DESCRIP' : 'NUV Lamp template reference file from data obtained during SMOV',
                    'COMMENT' : 'Reference file created by S. Beland',
                    'HISTORY' :
'''For information about was data was processed see COS ISR 2010-05.
Table below lists info about exposures used to produce this file:
rootname, program ID, target, detector, exptime, aperture, grating,
cenwave, fpoffset:
la9k04na 11475 WAVE NUV 120.0 WCA G230L   2635 -2
la9k04ne 11475 WAVE NUV 120.0 WCA G230L   2635 -1
la9k04nu 11475 WAVE NUV 120.0 WCA G230L   2635  0
la9k04nw 11475 WAVE NUV 120.0 WCA G230L   2635  1
la9k04o0 11475 WAVE NUV 120.0 WCA G230L   2950  0
la9k04o2 11475 WAVE NUV 120.0 WCA G230L   2950 -2
la9k04o4 11475 WAVE NUV 120.0 WCA G230L   2950 -1
la9k04o6 11475 WAVE NUV 120.0 WCA G230L   2950  0
la9k04o8 11475 WAVE NUV 120.0 WCA G230L   2950  1
la9k04oa 11475 WAVE NUV 120.0 WCA G230L   2950  0
la9k04oi 11475 WAVE NUV 120.0 WCA G230L   3000 -2
la9k04oo 11475 WAVE NUV 120.0 WCA G230L   3000 -1
la9k04ot 11475 WAVE NUV 120.0 WCA G230L   3000  0
la9k04oz 11475 WAVE NUV 120.0 WCA G230L   3000  1
la9k04pd 11475 WAVE NUV 120.0 WCA G230L   3360 -2
la9k04pj 11475 WAVE NUV 120.0 WCA G230L   3360 -1
la9k04pl 11475 WAVE NUV 120.0 WCA G230L   3360  0
la9k04pn 11475 WAVE NUV 120.0 WCA G230L   3360  1
la9k04pu 11475 WAVE NUV 120.0 WCA G230L   2950  0
la9k01rx 11475 WAVE NUV 120.0 WCA G185M   1786 -2
la9k01rz 11475 WAVE NUV 120.0 WCA G185M   1786 -1
la9k01s1 11475 WAVE NUV 120.0 WCA G185M   1786  0
la9k01s6 11475 WAVE NUV 120.0 WCA G185M   1786  1
la9k01sg 11475 WAVE NUV 120.0 WCA G185M   1817 -2
la9k01sk 11475 WAVE NUV 120.0 WCA G185M   1817 -1
la9k01so 11475 WAVE NUV 120.0 WCA G185M   1817  0
la9k01st 11475 WAVE NUV 120.0 WCA G185M   1817  1
la9k01sx 11475 WAVE NUV 120.0 WCA G185M   1835 -2
la9k01sz 11475 WAVE NUV 120.0 WCA G185M   1835 -1 
la9k01t1 11475 WAVE NUV 120.0 WCA G185M   1835  0 
la9k01t3 11475 WAVE NUV 120.0 WCA G185M   1835  1 
la9k01t5 11475 WAVE NUV 120.0 WCA G185M   1850  0 
la9k01t7 11475 WAVE NUV 120.0 WCA G185M   1850 -2 
la9k01tb 11475 WAVE NUV 120.0 WCA G185M   1850 -1 
la9k01tf 11475 WAVE NUV 120.0 WCA G185M   1850  0 
la9k01tj 11475 WAVE NUV 120.0 WCA G185M   1850  1 
la9k01tl 11475 WAVE NUV 120.0 WCA G185M   1850  0 
la9k01tp 11475 WAVE NUV 120.0 WCA G185M   1864 -2 
la9k01tr 11475 WAVE NUV 120.0 WCA G185M   1864 -1 
la9k01tt 11475 WAVE NUV 120.0 WCA G185M   1864  0 
la9k01tv 11475 WAVE NUV 120.0 WCA G185M   1864  1 
la9k01u4 11475 WAVE NUV 120.0 WCA G185M   1882 -2 
la9k01u6 11475 WAVE NUV 120.0 WCA G185M   1882 -1 
la9k01u8 11475 WAVE NUV 120.0 WCA G185M   1882  0 
la9k01ua 11475 WAVE NUV 120.0 WCA G185M   1882  1 
la9k01ue 11475 WAVE NUV 120.0 WCA G185M   1890 -2 
la9k01ug 11475 WAVE NUV 120.0 WCA G185M   1890 -1 
la9k01uk 11475 WAVE NUV 120.0 WCA G185M   1890  0 
la9k01uo 11475 WAVE NUV 120.0 WCA G185M   1890  1 
la9k01us 11475 WAVE NUV 120.0 WCA G185M   1900 -2 
la9k01uw 11475 WAVE NUV 120.0 WCA G185M   1900 -1 
la9k01v0 11475 WAVE NUV 120.0 WCA G185M   1900  0 
la9k01v2 11475 WAVE NUV 120.0 WCA G185M   1900  1 
la9k01v6 11475 WAVE NUV 120.0 WCA G185M   1913 -2 
la9k01v8 11475 WAVE NUV 120.0 WCA G185M   1913 -1 
la9k01va 11475 WAVE NUV 120.0 WCA G185M   1913  0 
la9k01vc 11475 WAVE NUV 120.0 WCA G185M   1913  1 
la9k01vg 11475 WAVE NUV 120.0 WCA G185M   1921 -2 
la9k01vk 11475 WAVE NUV 120.0 WCA G185M   1921 -1 
la9k01vm 11475 WAVE NUV 120.0 WCA G185M   1921  0 
la9k01vo 11475 WAVE NUV 120.0 WCA G185M   1921  1 
la9k01vt 11475 WAVE NUV 120.0 WCA G185M   1941 -2 
la9k01vv 11475 WAVE NUV 120.0 WCA G185M   1941 -1 
la9k01vx 11475 WAVE NUV 120.0 WCA G185M   1941  0 
la9k01vz 11475 WAVE NUV 120.0 WCA G185M   1941  1 
la9k01w3 11475 WAVE NUV 120.0 WCA G185M   1953 -2 
la9k01w5 11475 WAVE NUV 120.0 WCA G185M   1953 -1 
la9k01w9 11475 WAVE NUV 120.0 WCA G185M   1953  0 
la9k01wd 11475 WAVE NUV 120.0 WCA G185M   1953  1 
la9k01wj 11475 WAVE NUV 120.0 WCA G185M   1971 -2 
la9k01wp 11475 WAVE NUV 120.0 WCA G185M   1971 -1 
la9k01ws 11475 WAVE NUV 120.0 WCA G185M   1971  0 
la9k01wu 11475 WAVE NUV 120.0 WCA G185M   1971  1
la9k01wy 11475 WAVE NUV 120.0 WCA G185M   1986 -2
la9k01x0 11475 WAVE NUV 120.0 WCA G185M   1986 -1
la9k01x2 11475 WAVE NUV 120.0 WCA G185M   1986  0 
la9k01x4 11475 WAVE NUV 120.0 WCA G185M   1986  1 
la9k01x8 11475 WAVE NUV 120.0 WCA G185M   2010 -2 
la9k01xa 11475 WAVE NUV 120.0 WCA G185M   2010 -1 
la9k01xc 11475 WAVE NUV 120.0 WCA G185M   2010  0 
la9k01xe 11475 WAVE NUV 120.0 WCA G185M   2010  1 
la9k01xj 11475 WAVE NUV 120.0 WCA G185M   1850  0 
la9k02yc 11475 WAVE NUV 120.0 WCA G225M   2186 -2 
la9k02ye 11475 WAVE NUV 120.0 WCA G225M   2186 -1 
la9k02yg 11475 WAVE NUV 120.0 WCA G225M   2186  0 
la9k02ys 11475 WAVE NUV 120.0 WCA G225M   2186  1 
la9k02z6 11475 WAVE NUV 120.0 WCA G225M   2217 -2 
la9k02zc 11475 WAVE NUV 120.0 WCA G225M   2217 -1 
la9k02zg 11475 WAVE NUV 120.0 WCA G225M   2217  0 
la9k02zi 11475 WAVE NUV 120.0 WCA G225M   2217  1 
la9k02zm 11475 WAVE NUV 120.0 WCA G225M   2233 -2 
la9k02zo 11475 WAVE NUV 120.0 WCA G225M   2233 -1 
la9k02zq 11475 WAVE NUV 120.0 WCA G225M   2233  0 
la9k02zs 11475 WAVE NUV 120.0 WCA G225M   2233  1 
la9k02zu 11475 WAVE NUV 120.0 WCA G225M   2250  0 
la9k02zw 11475 WAVE NUV 120.0 WCA G225M   2250 -2 
la9k02zy 11475 WAVE NUV 120.0 WCA G225M   2250 -1 
la9k02a5 11475 WAVE NUV 120.0 WCA G225M   2250  0 
la9k02ac 11475 WAVE NUV 120.0 WCA G225M   2250  1 
la9k02af 11475 WAVE NUV 120.0 WCA G225M   2250  0 
la9k02aj 11475 WAVE NUV 120.0 WCA G225M   2268 -2 
la9k02al 11475 WAVE NUV 120.0 WCA G225M   2268 -1 
la9k02an 11475 WAVE NUV 120.0 WCA G225M   2268  0 
la9k02ap 11475 WAVE NUV 120.0 WCA G225M   2268  1 
la9k02aw 11475 WAVE NUV 120.0 WCA G225M   2283 -2 
la9k02ay 11475 WAVE NUV 120.0 WCA G225M   2283 -1 
la9k02b0 11475 WAVE NUV 120.0 WCA G225M   2283  0 
la9k02b2 11475 WAVE NUV 120.0 WCA G225M   2283  1 
la9k02b6 11475 WAVE NUV 120.0 WCA G225M   2306 -2 
la9k02b8 11475 WAVE NUV 120.0 WCA G225M   2306 -1 
la9k02ba 11475 WAVE NUV 120.0 WCA G225M   2306  0 
la9k02bm 11475 WAVE NUV 120.0 WCA G225M   2306  1 
la9k02bq 11475 WAVE NUV 120.0 WCA G225M   2325 -2 
la9k02bs 11475 WAVE NUV 120.0 WCA G225M   2325 -1 
la9k02bu 11475 WAVE NUV 120.0 WCA G225M   2325  0 
la9k02bw 11475 WAVE NUV 120.0 WCA G225M   2325  1 
la9k02c0 11475 WAVE NUV 120.0 WCA G225M   2339 -2 
la9k02c2 11475 WAVE NUV 120.0 WCA G225M   2339 -1 
la9k02c4 11475 WAVE NUV 120.0 WCA G225M   2339  0 
la9k02c7 11475 WAVE NUV 120.0 WCA G225M   2339  1 
la9k02ce 11475 WAVE NUV 120.0 WCA G225M   2357 -2 
la9k02ch 11475 WAVE NUV 120.0 WCA G225M   2357 -1 
la9k02cj 11475 WAVE NUV 120.0 WCA G225M   2357  0 
la9k02cl 11475 WAVE NUV 120.0 WCA G225M   2357  1 
la9k02cr 11475 WAVE NUV 120.0 WCA G225M   2373 -2 
la9k02cv 11475 WAVE NUV 120.0 WCA G225M   2373 -1 
la9k02cz 11475 WAVE NUV 120.0 WCA G225M   2373  0 
la9k02d3 11475 WAVE NUV 120.0 WCA G225M   2373  1 
la9k02da 11475 WAVE NUV 120.0 WCA G225M   2390 -2 
la9k02dc 11475 WAVE NUV 120.0 WCA G225M   2390 -1 
la9k02de 11475 WAVE NUV 120.0 WCA G225M   2390  0 
la9k02dg 11475 WAVE NUV 120.0 WCA G225M   2390  1 
la9k02dk 11475 WAVE NUV 120.0 WCA G225M   2410 -2 
la9k02dm 11475 WAVE NUV 120.0 WCA G225M   2410 -1 
la9k02do 11475 WAVE NUV 120.0 WCA G225M   2410  0 
la9k02dq 11475 WAVE NUV 120.0 WCA G225M   2410  1
la9k02du 11475 WAVE NUV 120.0 WCA G225M   2250  0
la9k03z4 11475 WAVE NUV 120.0 WCA G285M   2617 -2 
la9k03z6 11475 WAVE NUV 120.0 WCA G285M   2617 -1 
la9k03z9 11475 WAVE NUV 120.0 WCA G285M   2617  0 
la9k03zb 11475 WAVE NUV 120.0 WCA G285M   2617  1 
la9k03zk 11475 WAVE NUV 120.0 WCA G285M   2637 -2 
la9k03zm 11475 WAVE NUV 120.0 WCA G285M   2637 -1 
la9k03zo 11475 WAVE NUV 120.0 WCA G285M   2637  0 
la9k03zq 11475 WAVE NUV 120.0 WCA G285M   2637  1 
la9k03zu 11475 WAVE NUV 120.0 WCA G285M   2657 -2 
la9k03zy 11475 WAVE NUV 120.0 WCA G285M   2657 -1 
la9k03a1 11475 WAVE NUV 120.0 WCA G285M   2657  0 
la9k03a3 11475 WAVE NUV 120.0 WCA G285M   2657  1 
la9k03a9 11475 WAVE NUV 120.0 WCA G285M   2676 -2 
la9k03ac 11475 WAVE NUV 120.0 WCA G285M   2676 -1 
la9k03ae 11475 WAVE NUV 120.0 WCA G285M   2676  0 
la9k03ai 11475 WAVE NUV 120.0 WCA G285M   2676  1 
la9k03ao 11475 WAVE NUV 120.0 WCA G285M   2695 -2 
la9k03aq 11475 WAVE NUV 120.0 WCA G285M   2695 -1 
la9k03as 11475 WAVE NUV 120.0 WCA G285M   2695  0 
la9k03au 11475 WAVE NUV 120.0 WCA G285M   2695  1 
la9k03ay 11475 WAVE NUV 120.0 WCA G285M   2709 -2 
la9k03b0 11475 WAVE NUV 120.0 WCA G285M   2709 -1 
la9k03b2 11475 WAVE NUV 120.0 WCA G285M   2709  0 
la9k03b4 11475 WAVE NUV 120.0 WCA G285M   2709  1 
la9k03b8 11475 WAVE NUV 120.0 WCA G285M   2719 -2 
la9k03bd 11475 WAVE NUV 120.0 WCA G285M   2719 -1 
la9k03bf 11475 WAVE NUV 120.0 WCA G285M   2719  0 
la9k03bh 11475 WAVE NUV 120.0 WCA G285M   2719  1 
la9k03bl 11475 WAVE NUV 120.0 WCA G285M   2739 -2 
la9k03bp 11475 WAVE NUV 120.0 WCA G285M   2739 -1 
la9k03br 11475 WAVE NUV 120.0 WCA G285M   2739  0 
la9k03bt 11475 WAVE NUV 120.0 WCA G285M   2739  1
la9k03bv 11475 WAVE NUV 120.0 WCA G285M   2850  0 
la9k03bx 11475 WAVE NUV 120.0 WCA G285M   2850 -2 
la9k03bz 11475 WAVE NUV 120.0 WCA G285M   2850 -1 
la9k03c1 11475 WAVE NUV 120.0 WCA G285M   2850  0 
la9k03c3 11475 WAVE NUV 120.0 WCA G285M   2850  1 
la9k03c5 11475 WAVE NUV 120.0 WCA G285M   2850  0 
la9k03c9 11475 WAVE NUV 150.0 WCA G285M   2952 -2 
la9k03cb 11475 WAVE NUV 150.0 WCA G285M   2952 -1 
la9k03cd 11475 WAVE NUV 150.0 WCA G285M   2952  0 
la9k03cf 11475 WAVE NUV 150.0 WCA G285M   2952  1 
la9k03cj 11475 WAVE NUV 150.0 WCA G285M   2979 -2 
la9k03cm 11475 WAVE NUV 150.0 WCA G285M   2979 -1 
la9k03cq 11475 WAVE NUV 150.0 WCA G285M   2979  0 
la9k03cs 11475 WAVE NUV 150.0 WCA G285M   2979  1 
la9k03cx 11475 WAVE NUV 130.0 WCA G285M   2996 -2 
la9k03d1 11475 WAVE NUV 130.0 WCA G285M   2996 -1 
la9k03d3 11475 WAVE NUV 130.0 WCA G285M   2996  0 
la9k03d9 11475 WAVE NUV 130.0 WCA G285M   2996  1 
la9k03de 11475 WAVE NUV 120.0 WCA G285M   3018 -2 
la9k03dg 11475 WAVE NUV 120.0 WCA G285M   3018 -1 
la9k03di 11475 WAVE NUV 120.0 WCA G285M   3018  0 
la9k03dk 11475 WAVE NUV 120.0 WCA G285M   3018  1 
la9k03do 11475 WAVE NUV 120.0 WCA G285M   3035 -2 
la9k03dr 11475 WAVE NUV 120.0 WCA G285M   3035 -1 
la9k03dv 11475 WAVE NUV 120.0 WCA G285M   3035  0 
la9k03dz 11475 WAVE NUV 120.0 WCA G285M   3035  1 
la9k03e7 11475 WAVE NUV 120.0 WCA G285M   3057 -2 
la9k03eb 11475 WAVE NUV 120.0 WCA G285M   3057 -1 
la9k03ee 11475 WAVE NUV 120.0 WCA G285M   3057  0 
la9k03eg 11475 WAVE NUV 120.0 WCA G285M   3057  1 
la9k03ek 11475 WAVE NUV 150.0 WCA G285M   3074 -2 
la9k03em 11475 WAVE NUV 150.0 WCA G285M   3074 -1 
la9k03eo 11475 WAVE NUV 150.0 WCA G285M   3074  0 
la9k03eq 11475 WAVE NUV 150.0 WCA G285M   3074  1 
la9k03eu 11475 WAVE NUV 150.0 WCA G285M   3094 -2 
la9k03ew 11475 WAVE NUV 150.0 WCA G285M   3094 -1 
la9k03ez 11475 WAVE NUV 150.0 WCA G285M   3094  0 
la9k03f3 11475 WAVE NUV 150.0 WCA G285M   3094  1 
la9k03fe 11475 WAVE NUV 120.0 WCA G285M   2850  0'''}

nuv_disp_smov = {'PEDIGREE' : 'INFLIGHT 28/07/2009 29/07/2009',
                 'USEAFTER' : 'July 28 2009 00:00:00',
                 'DESCRIP' : 'NUV Dispersion relation reference file from on-orbit data',
                 'COMMENT' : 'Reference file created by C. Oliveira',
                 'HISTORY' : 
'''See COS ISR 2010-05 for info on how file was created;
table 4 of the ISR contains rootnames of the exposures
used to produce reference file.'''}

change = {'fuv_smov_v2_r_lamp.fits': fuv_smov_v2_r_lamp,
          'fuv_disp_smov_1.fits': fuv_disp_smov_1,
          't2314311l_wcp.fits': t2314311l_wcp,
          'nuv_smov1_r_lamp.fits' : nuv_smov1_r_lamp,
          'nuv_disp_smov_1.fits' :  nuv_disp_smov}


for file in filelist:
    fd = PF.open(file, mode='update')
    phdr = fd[0].header
    hdr1 = fd[1].header
    
    print '\n\nProcessing file %s' % file
    
    del phdr['COMMENT']
    del phdr['HISTORY']
    
    for key in change:
        if file == key:
            for ch in change[key]:
                if ch == 'DESCRIP':
                    #weird CDBS rule of 67 chars... 
                    l = len(change[key][ch])
                    if l <= 67:
                        pad = '-'*(67 - l)
                        change[key][ch] += pad
                    else:
                        print 'Problem with DESCRIP keyword, will truncate'
                        change[key][ch] = change[key][ch][:68]
                    print '%s updated to %s' % (ch, change[key][ch])
                    phdr.update(ch, change[key][ch])
                elif ch == 'COMMENT':
                    print '%s updated to \"%s\"' % (ch, change[key][ch])
                    phdr.add_comment('= \"%s\"' % change[key][ch])  
                elif ch == 'HISTORY':
                    print '%s updated to:' % ch
                    for line in change[key][ch].split('\n'):
                        print 'HISTORY %s' % line
                        phdr.add_history(line)
                else:
                    print '%s updated to %s' % (ch, change[key][ch])
                    phdr[ch] = change[key][ch]
    
        else:
            print 'Could not find file', file
    
    fd.close()
    print 'Keywords of file %s have been modified...' % file
    
print 'Script ends...'
