

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>SamPy.plot.interactive_two_sample_t_test &mdash; SamPy v0.1 documentation</title>
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="SamPy v0.1 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">home</a>|&nbsp;</li>
        <li><a href="../../../search.html">search</a>|&nbsp;</li>

          <li><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for SamPy.plot.interactive_two_sample_t_test</h1><div class="highlight"><pre>
<span class="c">### Interactively plot points</span>
<span class="c">### to show the two-sample t-test of the y-values.</span>
<span class="c">### By Rajeev Raizada, Jan.2011.</span>
<span class="c">### Requires Python, with the Matplotlib and SciPy modules.</span>
<span class="c">### You can download Python and those modules for free from</span>
<span class="c">### http://www.python.org/download</span>
<span class="c">### http://scipy.org</span>
<span class="c">### http://matplotlib.sourceforge.net</span>
<span class="c">###</span>
<span class="c">### Please feel more than free to use this code for teaching.</span>
<span class="c">### If you use it, I&#39;d love to hear from you!</span>
<span class="c">### If you have any questions, comments or feedback, </span>
<span class="c">### please send them to me: rajeev dot raizada at dartmouth dot edu</span>
<span class="c">###</span>
<span class="c">### Some tutorial exercises which might be useful to try:</span>
<span class="c">### 1. Click in the left-half of the figure</span>
<span class="c">###    to make a few points in Group A with a mean of around 5,</span>
<span class="c">###    and in the right-half to make a few points in Group B</span>
<span class="c">###    with a mean of around 10.</span>
<span class="c">###    The red bars show the 95% confidence interval for each group.</span>
<span class="c">###    This means that if the data points were randomly sampled</span>
<span class="c">###    from a broader group-population, then we can be 95% sure</span>
<span class="c">###    that the actual mean of that broader group-population</span>
<span class="c">###    sits somewhere within that confidence-interval.</span>
<span class="c">### 2. What is the size of the p-value of the two-sample t-test for the groups you made?</span>
<span class="c">###    What is the size of the t-value for the difference between the two group-means?</span>
<span class="c">###    The meaning of the p-value is that it is the probability of observing </span>
<span class="c">###    that t-value, if the two group-populations that the data points </span>
<span class="c">###    were sampled from actually had the same means as each other.</span>
<span class="c">###    How much overlap is there between the 95% confidence intervals</span>
<span class="c">###    of the two groups?</span>
<span class="c">### 3. Click to add or delete some points so that the confidence intervals</span>
<span class="c">###    of the two groups become more overlapping with each other.</span>
<span class="c">###    What is the new t-value? What is the new p-value?</span>
<span class="c">### 4. Can you make two groups which have quite similar mean-values,</span>
<span class="c">###    but where those mean-values are still significantly different from each other?</span>
<span class="c">### 5. Now try to make two groups which have very different means,</span>
<span class="c">###    but where the mean-values are *not* significantly different from each other.</span>

<span class="c">###########################################</span>
<span class="c"># First, we import the modules that we need</span>
<span class="kn">import</span> <span class="nn">pylab</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span>  <span class="c"># We need this one for the norm.pdf function</span>

<span class="c">#####################################################</span>
<span class="c"># Next, we define the functions that the program uses</span>

<span class="c">### This function clears the figure and empties the points list</span>
<div class="viewcode-block" id="clear_the_figure_and_empty_points_list"><a class="viewcode-back" href="../../../SamPy.plot.html#SamPy.plot.interactive_two_sample_t_test.clear_the_figure_and_empty_points_list">[docs]</a><span class="k">def</span> <span class="nf">clear_the_figure_and_empty_points_list</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">coords_array</span> 
    <span class="k">global</span> <span class="n">point_handles_array</span>  
    <span class="c"># Reset our variables to be empty</span>
    <span class="n">coords_array</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="n">point_handles_array</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="n">handle_of_conf_ints_plot</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">handle_of_means_plot</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c">### Clear the figure window</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>  <span class="c"># clf means &quot;clear the figure&quot;</span>
    <span class="c">### In order to keep the boundaries of the figure fixed in place,</span>
    <span class="c">### we will draw a black box around the region that we want.</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axis_x_range</span><span class="o">*</span><span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
           <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">axis_y_lower_lim</span><span class="p">,</span><span class="n">axis_y_lower_lim</span><span class="p">,</span><span class="n">axis_y_upper_lim</span><span class="p">,</span><span class="n">axis_y_upper_lim</span><span class="p">]),</span><span class="s">&#39;k-&#39;</span><span class="p">)</span>
    <span class="c">### We want a long title, so we put a \n in the middle, to start a new line of title-text      </span>
    <span class="n">multiline_title_string</span> <span class="o">=</span> <span class="s">&#39;Click to add points, on old points to delete,&#39;</span> \
                             <span class="s">&#39; outside axes to reset.</span><span class="se">\n</span><span class="s">&#39;</span> \
                             <span class="s">&#39;Dots show the means. Bars show 95</span><span class="si">% c</span><span class="s">onfidence intervals for means&#39;</span>   
    <span class="n">pylab</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">multiline_title_string</span><span class="p">)</span>
    <span class="c">### Plot a line at x=0, which divides the Group A side from the Group B side</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="n">axis_y_lower_lim</span><span class="p">,</span> <span class="n">axis_y_upper_lim</span> <span class="p">],</span><span class="s">&#39;k--&#39;</span><span class="p">)</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>  <span class="c"># Add a grid on to the figure window</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="n">axis_x_range</span><span class="p">,</span> <span class="n">axis_x_range</span><span class="p">,</span> <span class="n">axis_y_lower_lim</span><span class="p">,</span> <span class="n">axis_y_upper_lim</span><span class="p">])</span>
    <span class="c">### Because we are only looking at the y-axis mean and std,</span>
    <span class="c">### we will only show tick-labels on the y-axis, with no ticks on the x-axis</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span> <span class="n">scipy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">axis_y_lower_lim</span><span class="p">,</span><span class="n">axis_y_upper_lim</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="o">-</span><span class="n">axis_x_range</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">axis_x_range</span><span class="o">*</span><span class="mf">0.5</span><span class="p">],[</span><span class="s">&#39;Group A&#39;</span><span class="p">,</span><span class="s">&#39;Group B&#39;</span><span class="p">])</span>
    
<span class="c"># This is the function which gets called when the mouse is clicked in the figure window</span></div>
<div class="viewcode-block" id="do_this_when_the_mouse_is_clicked"><a class="viewcode-back" href="../../../SamPy.plot.html#SamPy.plot.interactive_two_sample_t_test.do_this_when_the_mouse_is_clicked">[docs]</a><span class="k">def</span> <span class="nf">do_this_when_the_mouse_is_clicked</span><span class="p">(</span><span class="n">this_event</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">coords_array</span> 
    <span class="k">global</span> <span class="n">point_handles_array</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">this_event</span><span class="o">.</span><span class="n">xdata</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">this_event</span><span class="o">.</span><span class="n">ydata</span>
    <span class="c">### If the click is outside the range, then clear figure and points list</span>
    <span class="k">if</span> <span class="n">this_event</span><span class="o">.</span><span class="n">xdata</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="c"># This means we clicked outside the axis</span>
        <span class="n">clear_the_figure_and_empty_points_list</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span> <span class="c"># We clicked inside the axis</span>
        <span class="c">### First, check to see if we are clicking on an existing point, to delete it</span>
        <span class="c">### This can only happen if there are more than zero points.</span>
        <span class="n">number_of_points</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">coords_array</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">number_of_points</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">point_to_be_deleted</span> <span class="o">=</span> <span class="n">check_if_click_is_on_an_existing_point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="n">point_to_be_deleted</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c"># We are using this to code &quot;No point to be deleted&quot;</span>
        <span class="c">### If a value of point_to_be_deleted other than -1 is returned,</span>
        <span class="c">### then that value is the row-number of the point we are going to delete</span>
        <span class="k">if</span> <span class="n">point_to_be_deleted</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="c"># We delete a point</span>
            <span class="c"># We will delete that row from coords_array. The rows are axis 0</span>
            <span class="n">coords_array</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">coords_array</span><span class="p">,</span><span class="n">point_to_be_deleted</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="c"># We will also hide that point on the figure, by finding its handle</span>
            <span class="n">handle_of_point_to_be_deleted</span> <span class="o">=</span> <span class="n">point_handles_array</span><span class="p">[</span><span class="n">point_to_be_deleted</span><span class="p">]</span>
            <span class="n">pylab</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">handle_of_point_to_be_deleted</span><span class="p">,</span><span class="n">visible</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="c"># Now that we have erased the point with that handle,</span>
            <span class="c"># we can delete that handle from the handles list</span>
            <span class="n">point_handles_array</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">point_handles_array</span><span class="p">,</span><span class="n">point_to_be_deleted</span><span class="p">)</span>
            <span class="c"># After this possible point deletion, let&#39;s re-check</span>
            <span class="c"># to see whether we have fewer than two points in either class.</span>
            <span class="c"># If we do, then delete the mean and confidence interval for that class, </span>
            <span class="c"># as it isn&#39;t meaningful for just one data point</span>
            <span class="n">group_A_points</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">coords_array</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">group_B_points</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">coords_array</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">number_of_points_A</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">group_A_points</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">number_of_points_B</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">group_B_points</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="c"># Also, let&#39;s re-check whether there are still enough points</span>
            <span class="c"># for a two-sample t-test to be meaningful.</span>
            <span class="c"># If neither of the classes has two or more points,</span>
            <span class="c"># or either of the classes is empty,</span>
            <span class="c"># then we will delete the two-sample t-test results.</span>
            <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">number_of_points_A</span><span class="p">,</span><span class="n">number_of_points_B</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">)</span> <span class="o">|</span>
                 <span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">number_of_points_A</span><span class="p">,</span><span class="n">number_of_points_B</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="p">):</span>
                <span class="n">pylab</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
                <span class="n">pylab</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># We are not deleting any point, so we are making a new point</span>
            <span class="c">### We are going to treat all the points to the left of x=0 as Group A,</span>
            <span class="c">### and all the points to the right of x=0 as Group B.</span>
            <span class="c">### We&#39;ll plot Group A in blue, and Group B in black</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c">### Group A</span>
                <span class="n">colour_of_this_point</span> <span class="o">=</span> <span class="s">&#39;cyan&#39;</span>
            <span class="k">else</span><span class="p">:</span>      <span class="c">### Group B</span>
                <span class="n">colour_of_this_point</span> <span class="o">=</span> <span class="s">&#39;black&#39;</span>
            <span class="c">### We need slightly different commands for adding a row of coords</span>
            <span class="c">### to an existing coords_array when there are already some points,</span>
            <span class="c">### versus making the very first row of a new array, for the first point.</span>
            <span class="n">number_of_points</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">coords_array</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">number_of_points</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">coords_array</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">coords_array</span><span class="p">,[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]))</span> <span class="c"># Add a new row</span>
            <span class="k">else</span><span class="p">:</span> <span class="c"># This is the first point</span>
                <span class="n">coords_array</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]])</span> <span class="c"># Make the very first row</span>
            <span class="c">### Plot the new point in the group-appropriate colour, and record its handle</span>
            <span class="n">new_point_handle</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s">&#39;*&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colour_of_this_point</span><span class="p">)</span>
            <span class="n">point_handles_array</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point_handles_array</span><span class="p">,</span><span class="n">new_point_handle</span><span class="p">)</span> 
        <span class="c">### Now plot the statistics that this program is demonstrating</span>
        <span class="n">number_of_points</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">coords_array</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c"># Recount how many points we have now</span>
        <span class="k">if</span> <span class="n">number_of_points</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> 
            <span class="n">plot_the_two_sample_t_test</span><span class="p">()</span>
        <span class="c"># Set the axis back to its original value, in case Python has changed it during plotting</span>
        <span class="n">pylab</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="n">axis_x_range</span><span class="p">,</span> <span class="n">axis_x_range</span><span class="p">,</span> <span class="n">axis_y_lower_lim</span><span class="p">,</span> <span class="n">axis_y_upper_lim</span><span class="p">])</span>


<span class="c"># This is the function which calculates and plots the statistics</span></div>
<div class="viewcode-block" id="plot_the_two_sample_t_test"><a class="viewcode-back" href="../../../SamPy.plot.html#SamPy.plot.interactive_two_sample_t_test.plot_the_two_sample_t_test">[docs]</a><span class="k">def</span> <span class="nf">plot_the_two_sample_t_test</span><span class="p">():</span>
    <span class="c"># First, delete any existing normal-curve and mean plots from the figure</span>
    <span class="k">global</span> <span class="n">handle_of_group_A_conf_int</span>
    <span class="k">global</span> <span class="n">handle_of_group_B_conf_int</span>
    <span class="k">global</span> <span class="n">handle_of_group_A_mean</span>
    <span class="k">global</span> <span class="n">handle_of_group_B_mean</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">handle_of_group_A_conf_int</span><span class="p">,</span><span class="n">visible</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">handle_of_group_B_conf_int</span><span class="p">,</span><span class="n">visible</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">handle_of_group_A_mean</span><span class="p">,</span><span class="n">visible</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">handle_of_group_B_mean</span><span class="p">,</span><span class="n">visible</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="c">#### Next, calculate and plot the stats</span>
    <span class="c">#### We do this separately for Group A and Group B</span>
    <span class="c">#### The groupes are defined by whether their x-coord is &gt; 0 or &lt; 0</span>
    <span class="n">group_A_points</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">coords_array</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">group_B_points</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">coords_array</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">number_of_points_A</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">group_A_points</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">y_coords_A</span> <span class="o">=</span> <span class="n">coords_array</span><span class="p">[</span><span class="n">group_A_points</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="c"># y-coords are the second column, which is 1 in Python</span>
    <span class="k">if</span> <span class="n">number_of_points_A</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">y_mean_A</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">y_coords_A</span><span class="p">)</span>
        <span class="n">y_std_A</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">y_coords_A</span><span class="p">)</span> 
        <span class="n">y_ste_A</span> <span class="o">=</span> <span class="n">y_std_A</span> <span class="o">/</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">number_of_points_A</span><span class="p">)</span> <span class="c"># ste stands for Standard Error of the Mean</span>
    <span class="k">if</span> <span class="n">number_of_points_A</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_A</span> <span class="o">=</span> <span class="n">number_of_points_A</span> <span class="o">-</span> <span class="mi">1</span>   <span class="c"># df stands for &quot;degrees of freedom&quot;</span>
        <span class="n">t_crit_A</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">,</span><span class="n">df_A</span><span class="p">)</span>  <span class="c"># 95% critical value of t, two-tailed</span>
        <span class="n">confidence_interval_A</span> <span class="o">=</span> <span class="n">y_mean_A</span> <span class="o">+</span> <span class="n">t_crit_A</span><span class="o">*</span><span class="n">y_ste_A</span><span class="o">*</span><span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
        <span class="c">### Now plot the mean and confidence interval for this group</span>
        <span class="c">### For more explanation of what the confidence interval means,</span>
        <span class="c">### see the accompanying script interactive_one_sample_t_test.py </span>
        <span class="n">handle_of_group_A_mean</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">axis_x_range</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span><span class="n">y_mean_A</span><span class="p">,</span><span class="s">&#39;co&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">handle_of_group_A_conf_int</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">axis_x_range</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="n">axis_x_range</span><span class="o">*</span><span class="mf">0.5</span><span class="p">],</span>
                                                 <span class="n">confidence_interval_A</span><span class="p">,</span><span class="s">&#39;r-&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>                                              
    <span class="c">#### Now do the same for Group B</span>
    <span class="n">number_of_points_B</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">group_B_points</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">y_coords_B</span> <span class="o">=</span> <span class="n">coords_array</span><span class="p">[</span><span class="n">group_B_points</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="c"># y-coords are the second column, which is 1 in Python</span>
    <span class="k">if</span> <span class="n">number_of_points_B</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">y_mean_B</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">y_coords_B</span><span class="p">)</span>    
        <span class="n">y_std_B</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">y_coords_B</span><span class="p">)</span> 
        <span class="n">y_ste_B</span> <span class="o">=</span> <span class="n">y_std_B</span> <span class="o">/</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">number_of_points_B</span><span class="p">)</span> <span class="c"># ste stands for Standard Error of the Mean</span>
    <span class="k">if</span> <span class="n">number_of_points_B</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_B</span> <span class="o">=</span> <span class="n">number_of_points_B</span> <span class="o">-</span> <span class="mi">1</span>   <span class="c"># df stands for &quot;degrees of freedom&quot;</span>
        <span class="n">t_crit_B</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">,</span><span class="n">df_B</span><span class="p">)</span>  <span class="c"># 95% critical value of t, two-tailed</span>
        <span class="n">confidence_interval_B</span> <span class="o">=</span> <span class="n">y_mean_B</span> <span class="o">+</span> <span class="n">t_crit_B</span><span class="o">*</span><span class="n">y_ste_B</span><span class="o">*</span><span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
        <span class="c">### Now plot the mean and confidence interval for this group</span>
        <span class="n">handle_of_group_B_mean</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axis_x_range</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span><span class="n">y_mean_B</span><span class="p">,</span><span class="s">&#39;ko&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">handle_of_group_B_conf_int</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">axis_x_range</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">axis_x_range</span><span class="o">*</span><span class="mf">0.5</span><span class="p">],</span>
                                                 <span class="n">confidence_interval_B</span><span class="p">,</span><span class="s">&#39;r-&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>                                              
    <span class="c">#### Next: if at least one of the classes has two or more points,</span>
    <span class="c">#### and neither of the classes is empty, then we will perform </span>
    <span class="c">#### the two-sample t-test and display the results.</span>
    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">number_of_points_A</span><span class="p">,</span><span class="n">number_of_points_B</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span>
         <span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">number_of_points_A</span><span class="p">,</span><span class="n">number_of_points_B</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="p">):</span>
        <span class="c">#### SciPy refers to its two-sample t-test as ttest_ind,</span>
        <span class="c">#### meaning that this is the test two use for two independent groups.</span>
        <span class="c">#### It requires that the inputs be column vectors, so we need to flip them</span>
        <span class="n">y_coords_A_column_vec</span> <span class="o">=</span> <span class="n">y_coords_A</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">y_coords_B_column_vec</span> <span class="o">=</span> <span class="n">y_coords_B</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>    
        <span class="p">[</span><span class="n">t_value_AvsB</span><span class="p">,</span><span class="n">p_value_AvsB</span><span class="p">]</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">y_coords_A_column_vec</span><span class="p">,</span>
                                                            <span class="n">y_coords_B_column_vec</span><span class="p">)</span>  
        <span class="c">#### In order to make the p-values format nicely</span>
        <span class="c">#### even when they have a bunch of zeros at the start, we do this:</span>
        <span class="n">p_value_string</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%1.2g</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">p_value_AvsB</span>                                                         
        <span class="n">pylab</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Mean-A=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">y_mean_A</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span>  <span class="c"># The &#39;,2&#39; means show 2 decimal places</span>
                     <span class="s">&#39;, Mean-B=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">y_mean_B</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span>
                     <span class="s">&#39;, t=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">t_value_AvsB</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span>
                     <span class="s">&#39;, p= &#39;</span> <span class="o">+</span> <span class="n">p_value_string</span> <span class="p">)</span>
        <span class="n">pylab</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;n(A)=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">number_of_points_A</span><span class="p">)</span> <span class="o">+</span>
                     <span class="s">&#39;, n(B)=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">number_of_points_B</span><span class="p">)</span> <span class="o">+</span> 
                     <span class="s">&#39;, df=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">number_of_points_A</span><span class="o">+</span><span class="n">number_of_points_B</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
                     <span class="c"># Note: this df=n(A)+n(B)-2 formula is for the simple case</span>
                     <span class="c"># where the two-sample t-test assumes that the two groups</span>
                     <span class="c"># have equal variance, which is what we are doing here.</span>
    <span class="c"># Set the axis back to its original value, in case Python has changed it during plotting</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="n">axis_x_range</span><span class="p">,</span> <span class="n">axis_x_range</span><span class="p">,</span> <span class="n">axis_y_lower_lim</span><span class="p">,</span> <span class="n">axis_y_upper_lim</span><span class="p">])</span>

        
<span class="c"># This is the function which deletes existing points if you click on them       </span></div>
<div class="viewcode-block" id="check_if_click_is_on_an_existing_point"><a class="viewcode-back" href="../../../SamPy.plot.html#SamPy.plot.interactive_two_sample_t_test.check_if_click_is_on_an_existing_point">[docs]</a><span class="k">def</span> <span class="nf">check_if_click_is_on_an_existing_point</span><span class="p">(</span><span class="n">mouse_x_coord</span><span class="p">,</span><span class="n">mouse_y_coord</span><span class="p">):</span>
    <span class="c"># First, figure out how many points we have.</span>
    <span class="c"># Each point is one row in the coords_array,</span>
    <span class="c"># so we count the number of rows, which is dimension-0 for Python</span>
    <span class="n">number_of_points</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">coords_array</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>    
    <span class="n">this_coord</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="n">mouse_x_coord</span><span class="p">,</span> <span class="n">mouse_y_coord</span> <span class="p">]])</span> 
            <span class="c"># The double square brackets above give the this_coord array </span>
            <span class="c"># an explicit structure of having rows and also columns</span>
    <span class="k">if</span> <span class="n">number_of_points</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  
        <span class="c"># If there are some points, we want to calculate the distance</span>
        <span class="c"># of the new mouse-click location from every existing point.</span>
        <span class="c"># One way to do this is to make an array which is the same size</span>
        <span class="c"># as coords_array, and which contains the mouse x,y-coords on every row.</span>
        <span class="c"># Then we can subtract that xy_coord_matchng_matrix from coords_array</span>
        <span class="n">ones_vec</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">number_of_points</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">xy_coord_matching_matrix</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ones_vec</span><span class="p">,</span><span class="n">this_coord</span><span class="p">)</span>
        <span class="n">distances_from_existing_points</span> <span class="o">=</span> <span class="p">(</span><span class="n">coords_array</span> <span class="o">-</span> <span class="n">xy_coord_matching_matrix</span><span class="p">)</span>
        <span class="c"># Because the x and y axes have different scales,</span>
        <span class="c"># we need to rescale the distances so that itdoesn&#39;t matter whether</span>
        <span class="c"># you try to delete a dot by clicking near it in the x or y directions.</span>
        <span class="c"># When we extract the columns of distances_from_existing_points,</span>
        <span class="c"># scipy returns the values as row vectors for some reason.</span>
        <span class="c"># So, we transpose them back to column vectors and stack them horizontally</span>
        <span class="n">axis_range_scaled_distances</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
            <span class="p">(</span> <span class="n">distances_from_existing_points</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">axis_x_range</span><span class="p">),</span>
              <span class="n">distances_from_existing_points</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">axis_y_upper_lim</span><span class="o">-</span><span class="n">axis_y_lower_lim</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">squared_distances_from_existing_points</span> <span class="o">=</span> <span class="n">axis_range_scaled_distances</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">sum_sq_dists</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">squared_distances_from_existing_points</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
                   <span class="c"># The axis=1 means &quot;sum over dimension 1&quot;, which is columns for Python          </span>
        <span class="n">euclidean_dists</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sum_sq_dists</span><span class="p">)</span>
        <span class="n">distance_threshold</span> <span class="o">=</span> <span class="mf">0.01</span>
        <span class="n">within_threshold_points</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">euclidean_dists</span> <span class="o">&lt;</span> <span class="n">distance_threshold</span> <span class="p">)</span>
        <span class="n">num_within_threshold_points</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">within_threshold_points</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">num_within_threshold_points</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c"># We only want one matching point.</span>
            <span class="c"># It&#39;s possible that more than one might be within threshold.</span>
            <span class="c"># So, we take the unique smallest distance</span>
            <span class="n">point_to_be_deleted</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">euclidean_dists</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">point_to_be_deleted</span>
        <span class="k">else</span><span class="p">:</span> <span class="c"># If there are zero points, then we are not deleting any </span>
            <span class="n">point_to_be_deleted</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">return</span> <span class="n">point_to_be_deleted</span>


<span class="c">#######################################################################</span>
<span class="c"># This is the main part of the program, which calls the above functions </span>
<span class="c">#######################################################################</span>
<span class="c"># First, initialise some of our variables to be empty</span></div>
<span class="n">coords_array</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">point_handles_array</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">handle_of_group_A_conf_int</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">handle_of_group_B_conf_int</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">handle_of_group_A_mean</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">handle_of_group_B_mean</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c">### Set up an initial space to click inside</span>
<span class="n">axis_x_range</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">axis_y_upper_lim</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">axis_y_lower_lim</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>
<span class="c">### Make the figure window</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="c">### Clear the figure window</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span> <span class="c"># clf means &quot;clear the figure&quot;</span>
<span class="c">### In order to keep the boundaries of the figure fixed in place,</span>
<span class="c">### we will draw a black box around the region that we want.</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axis_x_range</span><span class="o">*</span><span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
           <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">axis_y_lower_lim</span><span class="p">,</span><span class="n">axis_y_lower_lim</span><span class="p">,</span><span class="n">axis_y_upper_lim</span><span class="p">,</span><span class="n">axis_y_upper_lim</span><span class="p">]),</span><span class="s">&#39;k-&#39;</span><span class="p">)</span>
<span class="c">### Tell Python to call a function every time</span>
<span class="c">### when the mouse is pressed in this figure</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;button_press_event&#39;</span><span class="p">,</span> <span class="n">do_this_when_the_mouse_is_clicked</span><span class="p">)</span>

<span class="n">clear_the_figure_and_empty_points_list</span><span class="p">()</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>    <span class="c"># This shows the figure window onscreen</span>
    
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">home</a>|&nbsp;</li>
        <li><a href="../../../search.html">search</a>|&nbsp;</li>

          <li><a href="../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Sami-Matias Niemi.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>