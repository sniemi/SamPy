

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>SamPy.plot.COSIHB.plotting &mdash; SamPy v0.1 documentation</title>
    <link rel="stylesheet" href="../../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <link rel="top" title="SamPy v0.1 documentation" href="../../../../index.html" />
    <link rel="up" title="Module code" href="../../../index.html" /> 
  </head>
  <body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../../index.html">home</a>|&nbsp;</li>
        <li><a href="../../../../search.html">search</a>|&nbsp;</li>

          <li><a href="../../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for SamPy.plot.COSIHB.plotting</h1><div class="highlight"><pre>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">A class to plot COS instrument handbook plots. Each figure </span>
<span class="sd">is generated by it&#39;s own function.</span>

<span class="sd">Note that the same function can be used to generate multiple</span>
<span class="sd">figures of similar type. </span>

<span class="sd">@author: Sami-Matias Niemi (niemi@stsci.edu) for STScI</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s">&#39;xtick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> 
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s">&#39;axes&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s">&#39;lines&#39;</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;lines.linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;legend.fontsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">11</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;legend.handlelength&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">13</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;xtick.major.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="c">#matplotlib.rcParams[&#39;xtick.labelsize&#39;] = &#39;large&#39;</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;ytick.major.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="c">#matplotlib.rcParams[&#39;ytick.labelsize&#39;] = &#39;large&#39;</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;legend.fancybox&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
<span class="c">#matplotlib.rcParams[&#39;figure.figsize&#39;] = [12,8]</span>
<span class="c">#matplotlib.rcParams[&#39;figure.dpi&#39;] = 100</span>
<span class="c">#matplotlib.rcParams[&#39;savefig.dpi&#39;] = 300</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s">&#39;PDF&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">MultipleLocator</span><span class="p">,</span> <span class="n">FormatStrFormatter</span><span class="p">,</span> <span class="n">NullFormatter</span><span class="p">,</span> <span class="n">LogLocator</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="kn">import</span> <span class="nn">matplotlib.mlab</span> <span class="kn">as</span> <span class="nn">mlab</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.collections</span> <span class="kn">as</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">pylab</span> <span class="kn">as</span> <span class="nn">P</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">N</span>
<span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="kn">as</span> <span class="nn">cm</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s">&#39;Sami-Matias Niemi&#39;</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s">&#39;1.4&#39;</span>

<div class="viewcode-block" id="Sensitivity2EffectiveArea"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Sensitivity2EffectiveArea">[docs]</a><span class="k">def</span> <span class="nf">Sensitivity2EffectiveArea</span><span class="p">(</span><span class="n">sensitivity</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">,</span> <span class="n">dispersion</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c">#effective area</span>
    <span class="c">#area = const*sensitivity/(wave*dlam_dx)</span>
    <span class="n">const</span> <span class="o">=</span> <span class="mf">2.998e10</span> <span class="o">*</span> <span class="mf">6.626e-27</span> <span class="o">/</span> <span class="mf">1.0e-8</span> <span class="c">#h*c*1.e-8 (to convert Ang to cm)</span>
    <span class="n">effA</span> <span class="o">=</span> <span class="n">const</span> <span class="o">*</span> <span class="n">sensitivity</span> <span class="o">/</span> <span class="p">(</span><span class="n">wavelength</span> <span class="o">*</span> <span class="n">dispersion</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">effA</span>
</div>
<div class="viewcode-block" id="Sensitivity2EffectiveAreaForArrays"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Sensitivity2EffectiveAreaForArrays">[docs]</a><span class="k">def</span> <span class="nf">Sensitivity2EffectiveAreaForArrays</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="n">sens</span><span class="p">,</span> <span class="n">disp</span><span class="p">):</span>
    <span class="n">waveA</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">effA</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="n">sens</span><span class="p">):</span>
        <span class="n">waveA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
        <span class="n">effA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Sensitivity2EffectiveArea</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">disp</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">waveA</span><span class="p">,</span> <span class="n">effA</span>
</div>
<div class="viewcode-block" id="Smooth"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Smooth">[docs]</a><span class="k">def</span> <span class="nf">Smooth</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="n">eff</span><span class="p">):</span>
    <span class="n">step</span> <span class="o">=</span> <span class="mf">10.</span>
    <span class="n">zero</span> <span class="o">=</span> <span class="n">wave</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">w</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">e</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">wa</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ef</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="n">eff</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">1600</span> <span class="ow">and</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">3000</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;=</span> <span class="n">zero</span> <span class="o">+</span> <span class="n">step</span><span class="p">:</span>
                <span class="n">w</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="n">e</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="nb">max</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">max</span> <span class="o">=</span> <span class="n">b</span>
                <span class="n">wa</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">w</span><span class="p">)))</span>
                <span class="n">ef</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">)</span>
                <span class="n">w</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">e</span> <span class="o">=</span> <span class="p">[]</span>  
                <span class="n">zero</span> <span class="o">=</span> <span class="n">a</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">wa</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="n">ef</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">wa</span><span class="p">),</span> <span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ef</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Fix"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Fix">[docs]</a><span class="k">def</span> <span class="nf">Fix</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">smooth</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Simple function to separate 1st and 2nd-order light from 230L.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">wave</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">data</span><span class="p">])</span>
    <span class="n">eff</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">e</span> <span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">data</span><span class="p">])</span>
    <span class="c">#wavelengths that bracket 2nd-order</span>
    <span class="n">maxEW</span> <span class="o">=</span> <span class="n">wave</span><span class="p">[</span><span class="n">N</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">eff</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">eff</span><span class="p">))][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">maxEW1</span> <span class="o">=</span>  <span class="n">wave</span><span class="p">[</span><span class="n">N</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">eff</span> <span class="o">==</span> <span class="n">N</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">eff</span><span class="p">[</span><span class="n">wave</span> <span class="o">&lt;</span> <span class="n">maxEW</span><span class="p">]))][</span><span class="mi">0</span><span class="p">]</span>
    <span class="c">#steps for interpolation</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wave</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wave</span><span class="p">)</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">wave</span><span class="p">)</span> <span class="o">-</span> <span class="n">N</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">wave</span><span class="p">))</span> <span class="o">+</span> <span class="n">N</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">wave</span><span class="p">)</span>
    <span class="c">#interpolation between value</span>
    <span class="n">intE</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">wave</span><span class="p">,</span> <span class="n">eff</span><span class="p">)</span>
    <span class="c">#choose maximum from interpolation</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">intE</span> <span class="o">&gt;</span> <span class="n">eff</span><span class="p">)</span>
    <span class="n">eff</span><span class="p">[</span><span class="n">tmp</span><span class="p">]</span> <span class="o">=</span> <span class="n">intE</span><span class="p">[</span><span class="n">tmp</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">smooth</span><span class="p">:</span>
        <span class="n">wa</span><span class="p">,</span> <span class="n">eb</span> <span class="o">=</span> <span class="n">Smooth</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">eff</span><span class="p">)</span>
        <span class="n">criterium</span> <span class="o">=</span> <span class="p">(</span><span class="n">wa</span> <span class="o">&lt;=</span> <span class="n">maxEW1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">wa</span> <span class="o">&gt;=</span> <span class="n">maxEW</span><span class="p">)</span>  
        <span class="k">return</span> <span class="n">wa</span><span class="p">[</span><span class="n">criterium</span><span class="p">],</span> <span class="n">eb</span><span class="p">[</span><span class="n">criterium</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">wave</span><span class="p">,</span> <span class="n">eff</span>
</div>
<div class="viewcode-block" id="Plotting"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting">[docs]</a><span class="k">class</span> <span class="nc">Plotting</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    A class to plot COS instrument handbook plots.</span>
<span class="sd">    Each figure is generated by a function.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="s">&#39;.pdf&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Initialization: sets the used file type e.g. eps for the output.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">filetype</span>
    
<div class="viewcode-block" id="Plotting.FUVsensitivity"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.FUVsensitivity">[docs]</a>    <span class="k">def</span> <span class="nf">FUVsensitivity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">G130</span><span class="p">,</span> <span class="n">G160</span><span class="p">,</span> <span class="n">G140</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots FUV point-source sensitivities in units of effective area</span>
<span class="sd">        and throughput.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">ar</span> <span class="o">=</span> <span class="mf">45238.93416</span> <span class="c">#HST primary area in cm**2</span>
        
        <span class="c">#fixer</span>
        <span class="n">fixer</span> <span class="o">=</span> <span class="mf">1122.</span>
        
        <span class="c">#Extension for 140L (McCandliss paper data)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">&#39;./data/G140Leff.dat&#39;</span><span class="p">,</span> <span class="n">comments</span><span class="o">=</span><span class="s">&#39;#&#39;</span><span class="p">,</span> <span class="n">usecols</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        
        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="c">#P.title(&#39;FUV point-source sensitivities&#39;)</span>

        <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
        
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G130</span><span class="p">],</span>
                 <span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G130</span><span class="p">])</span><span class="o">/</span><span class="n">ar</span><span class="p">,</span> <span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G130M&#39;</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="c">#        ax2.plot([line[0] for line in G140 if line[0] &gt; fixer],</span>
<span class="c">#                 N.array([line[1] for line in G140 if line[0] &gt; fixer])/ar, &#39;r-&#39;, label=&#39;G140L&#39;)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G140</span> <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">fixer</span><span class="p">],</span>
                 <span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G140</span> <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">fixer</span><span class="p">])</span><span class="o">/</span><span class="n">ar</span><span class="p">,</span>
                 <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G140L&#39;</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>        
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G160</span><span class="p">],</span>
                 <span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G160</span><span class="p">])</span><span class="o">/</span><span class="n">ar</span><span class="p">,</span> <span class="s">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G160M&#39;</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G130</span><span class="p">],</span>
                <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G130</span><span class="p">],</span> <span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G130M&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="c">#        ax.plot([line[0] for line in G140 if line[0] &gt; fixer],</span>
<span class="c">#                [line[1] for line in G140 if line[0] &gt; fixer], &#39;r-&#39;, label=&#39;G140L&#39;, lw = 3)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G140</span> <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">fixer</span><span class="p">],</span>
                <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G140</span> <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">fixer</span><span class="p">],</span>
                <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G140L&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>        
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G160</span><span class="p">],</span>
                <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G160</span><span class="p">],</span> <span class="s">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G160M&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
     

        <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">G130</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mf">1100.</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mf">2000.</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0001</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="mf">1.05</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0001</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="mf">1.05</span><span class="o">/</span><span class="n">ar</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">920.</span><span class="p">,</span> <span class="mf">2140.</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">920.</span><span class="p">,</span> <span class="mf">2140.</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Wavelength (\AA)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;Effective Area (cm$^{2}$)&#39;</span><span class="p">)</span> 
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;Fractional Throughput&#39;</span><span class="p">)</span> 
        
        <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">500</span><span class="o">/</span><span class="mi">5</span><span class="p">))</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">0.01</span><span class="o">/</span><span class="mi">5</span><span class="p">))</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

        <span class="n">P</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    </div>
<div class="viewcode-block" id="Plotting.FUVsensitivityOLD"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.FUVsensitivityOLD">[docs]</a>    <span class="k">def</span> <span class="nf">FUVsensitivityOLD</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datax1</span><span class="p">,</span> <span class="n">datay1</span><span class="p">,</span> <span class="n">datax2</span><span class="p">,</span> <span class="n">datay2</span><span class="p">,</span> <span class="n">datax3</span><span class="p">,</span> <span class="n">datay3</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots the FUV point-source sensitivities for three grating.</span>
<span class="sd">        Corresponds to Figure 5.2 on page 40 at the first COS instrument handbook.</span>
<span class="sd">        &#39;&#39;&#39;</span>    
        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;FUV point-source sensitivities&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Wavelength (\AA)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;counts resel$^{-1}$ sec$^{-1}$ per FEFU&#39;</span><span class="p">)</span>      
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax1</span><span class="p">,</span> <span class="n">datay1</span><span class="p">,</span> <span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G130M&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax2</span><span class="p">,</span> <span class="n">datay2</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G140L&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax3</span><span class="p">,</span> <span class="n">datay3</span><span class="p">,</span> <span class="s">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G160M&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1077.</span><span class="p">,</span> <span class="mf">2140.</span><span class="p">)</span>
        
        <span class="c">#limits the y axis between realistic values</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">datax2</span><span class="p">,</span> <span class="n">datay2</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mf">1100.</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mf">2000.</span><span class="p">]</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0001</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="mf">1.05</span><span class="p">)</span>

        <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">()</span>
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Plotting.Chapter13SNPlot"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.Chapter13SNPlot">[docs]</a>    <span class="k">def</span> <span class="nf">Chapter13SNPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">stlim</span><span class="p">,</span> <span class="n">grating</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">FUV</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Creates signal-to-noise plots for COS instrument HB Chapter 15.</span>
<span class="sd">        Bright limit has been set for point source, should be changed if</span>
<span class="sd">        adapted for diffuse source.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="mf">10.</span><span class="o">**</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">)</span><span class="o">*</span><span class="mf">3.63e-9</span>
        
        <span class="c">#limiting area factor</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="mf">0.5</span>
        
        <span class="n">second</span> <span class="o">=</span> <span class="bp">True</span>
   
        <span class="k">if</span> <span class="n">FUV</span><span class="p">:</span>
            <span class="n">minmag</span> <span class="o">=</span> <span class="mi">5</span>
            <span class="n">maxmag</span> <span class="o">=</span> <span class="mi">25</span>
            <span class="c">#newer version automatically calculagtes these, thus, no need</span>
            <span class="c">#values taken from Table 11.2 of COS instrument HB, version 1.</span>
            <span class="c">#might require updating!</span>
            <span class="c">#if grating.find(&#39;G130M&#39;) &gt; -1: stlim = 9.8</span>
            <span class="c">#if grating.find(&#39;G160M&#39;) &gt; -1: stlim = 7.9</span>
            <span class="c">#if grating.find(&#39;G140L&#39;) &gt; -1: stlim = 12.3</span>
            <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;G130MSSNR&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">minmag</span> <span class="o">=</span> <span class="mi">3</span>
                <span class="n">maxmag</span> <span class="o">=</span> <span class="mi">16</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">minmag</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">maxmag</span> <span class="o">=</span> <span class="mi">25</span>
            <span class="c">#if grating.find(&#39;G185M&#39;) &gt; -1: stlim = 8.1</span>
            <span class="c">#if grating.find(&#39;G225M&#39;) &gt; -1: stlim = 7.4</span>
            <span class="c">#if grating.find(&#39;G285M&#39;) &gt; -1: stlim = 6.6</span>
            <span class="c">#if grating.find(&#39;G230L&#39;) &gt; -1: stlim = 9.1</span>

        <span class="n">yMajorFormattor</span> <span class="o">=</span> <span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%i</span><span class="s">&#39;</span><span class="p">)</span>
        
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        
        <span class="c">#ax1.set_xlabel(&#39;V + STMAG$_{\lambda}$ (magnitudes)&#39;)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;STMAG (magnitudes)&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;SNR for </span><span class="si">%s</span><span class="s"> at </span><span class="si">%s</span><span class="s"> \AA&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">grating</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">))</span>

        <span class="c">#x 2 axis</span>
        <span class="k">if</span> <span class="n">second</span><span class="p">:</span>
            <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Constant $F_{\lambda}$ (erg cm$^{-2}$ s$^{-1}$ \AA$^{-1}$)&#39;</span><span class="p">)</span>

        <span class="n">dark</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sky</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">darkDom</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">skyDom</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">time</span> <span class="o">=</span>  <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="c">#Signal-to-noise ratio, source counts, source noise, dark current counts, sky, background, total noise</span>
                <span class="n">snr</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">sourceCounts</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">sourceNoise</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">darkCounts</span> <span class="o">=</span>  <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
                <span class="n">skyCounts</span> <span class="o">=</span>  <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>
                <span class="n">background</span> <span class="o">=</span>  <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span>
                <span class="n">totalNoise</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span> 
                
                <span class="c">#tests if limitations</span>
                <span class="k">if</span> <span class="n">darkCounts</span> <span class="o">&gt;</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">sourceCounts</span> <span class="ow">and</span> <span class="n">snr</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
                <span class="c">#if darkCounts &gt; factor * totalNoise and snr &gt; 1.0:</span>
                    <span class="n">dark</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">snr</span><span class="p">])</span>
                    <span class="n">darkDom</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="c">#print &#39;Dark limited area found...&#39;, y[0], snr</span>
                    
                <span class="k">if</span> <span class="n">skyCounts</span> <span class="o">&gt;</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">sourceCounts</span> <span class="ow">and</span> <span class="n">snr</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
                <span class="c">#if skyCounts &gt; factor * totalNoise and snr &gt; 1.0:</span>
                    <span class="n">sky</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">snr</span><span class="p">])</span>
                    <span class="n">skyDom</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="c">#print &#39;Sky limited area found...&#39;, y[0], snr</span>
                    
                <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">snr</span><span class="p">])</span> <span class="c">#(flux, SN)</span>
              
            <span class="n">st</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            
            <span class="c">#line plots</span>
            <span class="k">if</span> <span class="n">second</span><span class="p">:</span> <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">st</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">st</span><span class="p">],</span> <span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> 
            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">2.5</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mf">3.63e-9</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">st</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">st</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">))</span> <span class="o">+</span> <span class="s">&#39; s&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        

        <span class="c">#bright limit area</span>
        <span class="c">#stlim = -2.5*math.log10(brightlim/3.63e-9)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">stlim</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Bright Limit&#39;</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
        
        <span class="n">dk</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dark</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">sk</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">sky</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        
        <span class="c">#dark</span>
        <span class="k">if</span> <span class="n">darkDom</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">second</span><span class="p">:</span> <span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">dk</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">dk</span><span class="p">],</span> <span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="o">-</span><span class="mf">2.5</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mf">3.63e-9</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">dk</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">dk</span><span class="p">],</span>
                        <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">&#39;Dark Dominates&#39;</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
        
        <span class="c">#sky</span>
        <span class="k">if</span> <span class="n">skyDom</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">second</span><span class="p">:</span> <span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">sk</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">sk</span><span class="p">],</span> <span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="o">-</span><span class="mf">2.5</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mf">3.63e-9</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">sk</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">sk</span><span class="p">],</span>
                        <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">&#39;Sky Dominates&#39;</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

        <span class="n">l</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">scatterpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">l</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

        <span class="c">#x1 and x2 axis</span>
        <span class="k">if</span> <span class="n">second</span><span class="p">:</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">convert</span><span class="p">(</span><span class="n">maxmag</span><span class="p">),</span> <span class="n">convert</span><span class="p">(</span><span class="n">minmag</span><span class="p">))</span>
            <span class="c">#ax2.xaxis.tick_top()</span>
            <span class="n">xminor</span> <span class="o">=</span> <span class="n">LogLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">subs</span><span class="o">=</span><span class="n">N</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">))</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminor</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
        <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">NullFormatter</span><span class="p">())</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick_bottom</span><span class="p">()</span>

        <span class="c">#y axis</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">100</span><span class="p">])</span>    
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">minmag</span><span class="p">,</span> <span class="n">maxmag</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">120.</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">second</span><span class="p">:</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">100</span><span class="p">])</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">120.</span><span class="p">)</span>
            
        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">yMajorFormattor</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">yMajorFormattor</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Plotting.Chapeter13SensitivityNew"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.Chapeter13SensitivityNew">[docs]</a>    <span class="k">def</span> <span class="nf">Chapeter13SensitivityNew</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psa</span><span class="p">,</span> <span class="n">boa</span><span class="p">,</span> <span class="n">disp</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">G140L</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">logy</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots the FUV point-source sensitivities for Chapter 13.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">boaFactor</span> <span class="o">=</span> <span class="mf">100.</span>
        
        <span class="c">#manipulate data</span>
        <span class="n">PSASegA</span> <span class="o">=</span> <span class="p">[[</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">]]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">psa</span> <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;FUVA&#39;</span><span class="p">]</span>
        <span class="n">PSASegB</span> <span class="o">=</span> <span class="p">[[</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">]]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">psa</span> <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;FUVB&#39;</span><span class="p">]</span>        
        <span class="n">BOASegA</span> <span class="o">=</span> <span class="p">[[</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">]]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">boa</span> <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;FUVA&#39;</span><span class="p">]</span>
        <span class="n">BOASegB</span> <span class="o">=</span> <span class="p">[[</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">]]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">boa</span> <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;FUVB&#39;</span><span class="p">]</span>
        
        <span class="c">#effective area</span>
        <span class="n">PSASegAw</span><span class="p">,</span> <span class="n">PSASegAe</span> <span class="o">=</span> <span class="n">Sensitivity2EffectiveAreaForArrays</span><span class="p">(</span><span class="n">PSASegA</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">PSASegA</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">disp</span><span class="p">)</span>
        <span class="n">PSASegBw</span><span class="p">,</span> <span class="n">PSASegBe</span> <span class="o">=</span> <span class="n">Sensitivity2EffectiveAreaForArrays</span><span class="p">(</span><span class="n">PSASegB</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">PSASegB</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">disp</span><span class="p">)</span>
        <span class="n">BOASegAw</span><span class="p">,</span> <span class="n">BOASegAe</span> <span class="o">=</span> <span class="n">Sensitivity2EffectiveAreaForArrays</span><span class="p">(</span><span class="n">BOASegA</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">boaFactor</span><span class="o">*</span><span class="n">BOASegA</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">disp</span><span class="p">)</span>
        <span class="n">BOASegBw</span><span class="p">,</span> <span class="n">BOASegBe</span> <span class="o">=</span> <span class="n">Sensitivity2EffectiveAreaForArrays</span><span class="p">(</span><span class="n">BOASegB</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">boaFactor</span><span class="o">*</span><span class="n">BOASegB</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">disp</span><span class="p">)</span>
       
        <span class="c">#plot</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

        <span class="c">#two axis</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
        
        <span class="c">#plot, axis 1</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Wavelength (\AA)&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;counts pixel$^{-1}$ s$^{-1}$ / (erg s$^{-1}$ cm$^{-2}$ \AA$^{-1}$)&#39;</span><span class="p">)</span>      
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">PSASegA</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">PSASegA</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;PSA Segment A&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">PSASegB</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">PSASegB</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;r:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;PSA Segment B&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">BOASegA</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">boaFactor</span><span class="o">*</span><span class="n">BOASegA</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;g--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;BOA x </span><span class="si">%i</span><span class="s"> Segment A&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">boaFactor</span><span class="p">),</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">BOASegB</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">boaFactor</span><span class="o">*</span><span class="n">BOASegB</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;g-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;BOA x </span><span class="si">%i</span><span class="s"> Segment B&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">boaFactor</span><span class="p">),</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
       <span class="c">#plot, axis2</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;Effective Area (cm$^{2}$)&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">PSASegAw</span><span class="p">,</span> <span class="n">PSASegAe</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span><span class="c">#, visible = False)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">PSASegBw</span><span class="p">,</span> <span class="n">PSASegBe</span><span class="p">,</span> <span class="s">&#39;r:&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span><span class="c">#, visible = False)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">BOASegAw</span><span class="p">,</span> <span class="n">BOASegAe</span><span class="p">,</span> <span class="s">&#39;g--&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span><span class="c">#, visible = False)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">BOASegBw</span><span class="p">,</span> <span class="n">BOASegBe</span><span class="p">,</span> <span class="s">&#39;g-.&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span><span class="c">#, visible = False)</span>
        
        <span class="k">if</span> <span class="n">G140L</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">PSASegA</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">PSASegA</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mf">1100.</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mf">2000.</span><span class="p">]</span>
            <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">BOASegA</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="mf">1.02</span><span class="p">)</span>

        <span class="n">m</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">yminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="n">m</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">yminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">yminorLocator</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">yminorFormattor</span><span class="p">)</span>      
        
        <span class="k">if</span> <span class="n">G140L</span><span class="p">:</span>
            <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">940</span><span class="p">,</span> <span class="mi">2140</span><span class="p">)</span>
            <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
            <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span> 
        <span class="k">elif</span> <span class="n">title</span> <span class="o">==</span> <span class="s">&#39;G230L&#39;</span><span class="p">:</span>
            <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3250</span><span class="p">)</span>
            <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
            <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
            <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">logy</span><span class="p">:</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>

        <span class="c">#delete the lowest tick</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()[</span><span class="mi">1</span><span class="p">:])</span>

        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>

        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    </div>
<div class="viewcode-block" id="Plotting.Chapeter13Sensitivity"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.Chapeter13Sensitivity">[docs]</a>    <span class="k">def</span> <span class="nf">Chapeter13Sensitivity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psa</span><span class="p">,</span> <span class="n">boa</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">G140L</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">logy</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots the FUV point-source sensitivities for Chapter 13.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">boaFactor</span> <span class="o">=</span> <span class="mf">100.</span>
        
        <span class="c">#manipulate data</span>
        <span class="n">PSASegA</span> <span class="o">=</span> <span class="p">[[</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">]]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">psa</span> <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;FUVA&#39;</span><span class="p">]</span>
        <span class="n">PSASegB</span> <span class="o">=</span> <span class="p">[[</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">]]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">psa</span> <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;FUVB&#39;</span><span class="p">]</span>        
        <span class="n">BOASegA</span> <span class="o">=</span> <span class="p">[[</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">]]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">boa</span> <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;FUVA&#39;</span><span class="p">]</span>
        <span class="n">BOASegB</span> <span class="o">=</span> <span class="p">[[</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">]]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">boa</span> <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;FUVB&#39;</span><span class="p">]</span>
       
        <span class="c">#plot</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Wavelength (\AA)&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;counts pixel$^{-1}$ s$^{-1}$ / (erg s$^{-1}$ cm$^{-2}$ \AA$^{-1}$)&#39;</span><span class="p">)</span>      
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">PSASegA</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">PSASegA</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;PSA Segment A&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">PSASegB</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">PSASegB</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;r:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;PSA Segment B&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">BOASegA</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">boaFactor</span><span class="o">*</span><span class="n">BOASegA</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;g--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;BOA x </span><span class="si">%i</span><span class="s"> Segment A&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">boaFactor</span><span class="p">),</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">BOASegB</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">boaFactor</span><span class="o">*</span><span class="n">BOASegB</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;g-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;BOA x </span><span class="si">%i</span><span class="s"> Segment B&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">boaFactor</span><span class="p">),</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
       
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
        <span class="c">#ax2 = ax1.twinx()</span>
        <span class="c">#ax2.set_ylabel(&#39;another axis (to be decided)&#39;)</span>
        <span class="c">#ax2.yaxis.tick_right()</span>
        <span class="c">#ax2.plot(boax2, boay2, &#39;r-&#39;, label=&#39;PSA&#39;, lw = 3, visible = False)</span>
        <span class="c">#ax2.plot(datax1, datay1, &#39;r-&#39;, label=&#39;PSA&#39;, lw = 3, visible = False)</span>
        <span class="c">#ax2.set_yticks(ax2.get_yticks()[1:])</span>

        <span class="k">if</span> <span class="n">G140L</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">PSASegA</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">PSASegA</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mf">1100.</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mf">2000.</span><span class="p">]</span>
            <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">BOASegA</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="mf">1.02</span><span class="p">)</span>

        <span class="n">m</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">yminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="n">m</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">yminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">yminorLocator</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">yminorFormattor</span><span class="p">)</span>      
        
        <span class="k">if</span> <span class="n">G140L</span><span class="p">:</span>
            <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">940</span><span class="p">,</span> <span class="mi">2140</span><span class="p">)</span>
            <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
            <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span> 
        <span class="k">elif</span> <span class="n">title</span> <span class="o">==</span> <span class="s">&#39;G230L&#39;</span><span class="p">:</span>
            <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>
            <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
            <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
            <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">logy</span><span class="p">:</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>

        <span class="n">ax1</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()[</span><span class="mi">1</span><span class="p">:])</span> <span class="c">#deletes the lowest y axis tick!</span>

        
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="Plotting.Chapeter13Plots"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.Chapeter13Plots">[docs]</a>    <span class="k">def</span> <span class="nf">Chapeter13Plots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datax1</span><span class="p">,</span> <span class="n">datay1</span><span class="p">,</span> <span class="n">boax2</span><span class="p">,</span> <span class="n">boay2</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">G140L</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">logy</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots the FUV point-source sensitivities for Chapter 13. Old method, still used for NUV.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">boaFactor</span> <span class="o">=</span> <span class="mf">100.</span>
        
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Wavelength (\AA)&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;counts pixel$^{-1}$ s$^{-1}$ / (erg s$^{-1}$ cm$^{-2}$ \AA$^{-1}$)&#39;</span><span class="p">)</span>      
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax1</span><span class="p">,</span> <span class="n">datay1</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;PSA&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">boax2</span><span class="p">,</span> <span class="n">boaFactor</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">boay2</span><span class="p">),</span> <span class="s">&#39;g--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;BOA x </span><span class="si">%i</span><span class="s">&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">boaFactor</span><span class="p">),</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
        <span class="c">#ax2 = ax1.twinx()</span>
        <span class="c">#ax2.set_ylabel(&#39;another axis (to be decided)&#39;)</span>
        <span class="c">#ax2.yaxis.tick_right()</span>
        <span class="c">#ax2.plot(boax2, boay2, &#39;r-&#39;, label=&#39;PSA&#39;, lw = 3, visible = False)</span>
        <span class="c">#ax2.plot(datax1, datay1, &#39;r-&#39;, label=&#39;PSA&#39;, lw = 3, visible = False)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()[</span><span class="mi">1</span><span class="p">:])</span> <span class="c">#deletes the lowest y axis tick!</span>
        <span class="c">#ax2.set_yticks(ax2.get_yticks()[1:])</span>
        
        <span class="n">m</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">yminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="n">m</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">yminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">yminorLocator</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">yminorFormattor</span><span class="p">)</span>      
        
        <span class="k">if</span> <span class="n">G140L</span><span class="p">:</span>
            <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2140</span><span class="p">)</span>
            <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
            <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span> 
        <span class="k">elif</span> <span class="n">title</span> <span class="o">==</span> <span class="s">&#39;G230L&#39;</span><span class="p">:</span>
            <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1200</span><span class="p">,</span> <span class="mi">3300</span><span class="p">)</span>
            <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
            <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
            <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">logy</span><span class="p">:</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
 </div>
<div class="viewcode-block" id="Plotting.Chapter13Waves"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.Chapter13Waves">[docs]</a>    <span class="k">def</span> <span class="nf">Chapter13Waves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">grating</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="n">annosize</span> <span class="o">=</span> <span class="s">&#39;x-small&#39;</span>
        <span class="c">#FP = [1,2,3,4]</span>
        <span class="n">FP</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">G140L</span><span class="p">,</span> <span class="n">G130MS</span><span class="p">,</span> <span class="n">G130M</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">False</span>
        
        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>        
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Central Wavelength (\AA)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Wavelength (\AA)&#39;</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">FP</span><span class="p">:</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;fp-pos&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;grating&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;G140L&#39;</span><span class="p">:</span>
                    <span class="n">shifty</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">2.5</span><span class="p">)</span><span class="o">*</span><span class="mi">8</span>
                    <span class="n">shiftx</span> <span class="o">=</span> <span class="mi">90</span>
                    <span class="n">G140L</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="n">xl</span> <span class="o">=</span> <span class="mi">180</span>            
                <span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;grating&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;G130M&#39;</span><span class="p">:</span>
                    <span class="n">shifty</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">2.5</span><span class="p">)</span><span class="o">*</span><span class="mf">1.9</span>
                    <span class="n">shiftx</span> <span class="o">=</span> <span class="mi">20</span>
                    <span class="n">xl</span> <span class="o">=</span> <span class="mi">1050</span>
                    <span class="n">G130M</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;grating&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;G130MS&#39;</span><span class="p">:</span>
                    <span class="n">shifty</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">2.5</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span>
                    <span class="n">shiftx</span> <span class="o">=</span> <span class="mi">15</span>
                    <span class="n">xl</span> <span class="o">=</span> <span class="mi">830</span>
                    <span class="n">G130MS</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">shifty</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">2.5</span><span class="p">)</span><span class="o">*</span><span class="mf">1.8</span>
                    <span class="n">shiftx</span> <span class="o">=</span> <span class="mi">20</span>
                    <span class="n">xl</span> <span class="o">=</span> <span class="mi">1310</span>
                    
                <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;segment&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;FUVA&#39;</span><span class="p">:</span>
                    <span class="n">l1</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;start&#39;</span><span class="p">],</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;stop&#39;</span><span class="p">]],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">,</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">],</span>
                           <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
                    <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;stop&#39;</span><span class="p">]))),</span>
                               <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;stop&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">shiftx</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">),</span> 
                               <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">size</span> <span class="o">=</span> <span class="n">annosize</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">G140L</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1105</span><span class="p">:</span>
                        <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;start&#39;</span><span class="p">]))),</span>
                                   <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;start&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">shiftx</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">),</span> 
                                   <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">size</span> <span class="o">=</span> <span class="n">annosize</span><span class="p">)</span>
                        <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;fp-pos&#39;</span><span class="p">],</span>
                                   <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">xl</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">),</span>
                                   <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">size</span> <span class="o">=</span> <span class="n">annosize</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">G140L</span><span class="p">:</span>
                        <span class="n">l3</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">300</span><span class="p">,</span><span class="mi">900</span><span class="p">],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">,</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">],</span>
                               <span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
                        <span class="n">l2</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;start&#39;</span><span class="p">],</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;stop&#39;</span><span class="p">]],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">,</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">],</span>
                               <span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
                        <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;fp-pos&#39;</span><span class="p">],</span>
                                   <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">xl</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">),</span>
                                   <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">size</span> <span class="o">=</span> <span class="n">annosize</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">l2</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;start&#39;</span><span class="p">],</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;stop&#39;</span><span class="p">]],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">,</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">],</span>
                               <span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
                        <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;start&#39;</span><span class="p">]))),</span>
                                   <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;start&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">shiftx</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">),</span> 
                                   <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">size</span> <span class="o">=</span> <span class="n">annosize</span><span class="p">)</span>
                        <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;fp-pos&#39;</span><span class="p">],</span>
                                   <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">xl</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">),</span>
                                   <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">size</span> <span class="o">=</span> <span class="n">annosize</span><span class="p">)</span>

        
        <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s">&#39;FP-POS&#39;</span><span class="p">,</span>
                   <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.89</span><span class="p">),</span>
                   <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                   <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                   <span class="n">xycoords</span><span class="o">=</span><span class="s">&#39;axes fraction&#39;</span><span class="p">)</span>        
        

        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">()</span>
        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">()</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;fp-pos&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;segment&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;FUVA&#39;</span><span class="p">)][</span><span class="s">&#39;central&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span> 
        
        <span class="k">if</span> <span class="n">G140L</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">500</span><span class="o">/</span><span class="mi">5</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2700</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">+</span> <span class="mi">50</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">G130MS</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="o">/</span><span class="mi">5</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1280</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">G130M</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="o">/</span><span class="mi">5</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1020</span><span class="p">,</span> <span class="mi">1520</span><span class="p">)</span>
            <span class="c">#ax.set_ylim(ymin, ymax + 5)</span>
              
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="o">/</span><span class="mi">5</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span> <span class="o">-</span> <span class="mi">30</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">+</span> <span class="mi">15</span><span class="p">)</span>
        
        <span class="n">P</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;SEGMENT A&#39;</span><span class="p">,</span> <span class="s">&#39;SEGMENT B&#39;</span><span class="p">),</span> <span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>        
 </div>
<div class="viewcode-block" id="Plotting.Chapter13WavesOLD"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.Chapter13WavesOLD">[docs]</a>    <span class="k">def</span> <span class="nf">Chapter13WavesOLD</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">grating</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="n">annosize</span> <span class="o">=</span> <span class="s">&#39;x-small&#39;</span>
        <span class="c">#FP = [1,2,3,4]</span>
        <span class="n">FP</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">G140L</span><span class="p">,</span> <span class="n">G130M</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">False</span>
        
        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>        
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Central Wavelength (\AA)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Wavelength (\AA)&#39;</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">FP</span><span class="p">:</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;fp-pos&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;grating&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;G140L&#39;</span><span class="p">:</span>
                    <span class="n">shifty</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">2.5</span><span class="p">)</span><span class="o">*</span><span class="mi">8</span>
                    <span class="n">shiftx</span> <span class="o">=</span> <span class="mi">90</span>
                    <span class="n">G140L</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="n">xl</span> <span class="o">=</span> <span class="mi">180</span>            
                <span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;grating&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;G130M&#39;</span><span class="p">:</span>
                    <span class="n">shifty</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">2.5</span><span class="p">)</span><span class="o">*</span><span class="mf">1.9</span>
                    <span class="n">shiftx</span> <span class="o">=</span> <span class="mi">20</span>
                    <span class="n">xl</span> <span class="o">=</span> <span class="mi">820</span>
                    <span class="n">G130M</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1055</span><span class="p">:</span>
                        <span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">205</span>
                    <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1096</span><span class="p">:</span>
                        <span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">175</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">shifty</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">2.5</span><span class="p">)</span><span class="o">*</span><span class="mf">1.8</span>
                    <span class="n">shiftx</span> <span class="o">=</span> <span class="mi">20</span>
                    <span class="n">xl</span> <span class="o">=</span> <span class="mi">1310</span>
                <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;segment&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;FUVA&#39;</span><span class="p">:</span>
                    <span class="n">l1</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;start&#39;</span><span class="p">],</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;stop&#39;</span><span class="p">]],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">,</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">],</span>
                           <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
                    <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;stop&#39;</span><span class="p">]))),</span>
                               <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;stop&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">shiftx</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">),</span> 
                               <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">size</span> <span class="o">=</span> <span class="n">annosize</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">G140L</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1105</span><span class="p">:</span>
                        <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;start&#39;</span><span class="p">]))),</span>
                                   <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;start&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">shiftx</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">),</span> 
                                   <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">size</span> <span class="o">=</span> <span class="n">annosize</span><span class="p">)</span>
                        <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;fp-pos&#39;</span><span class="p">],</span>
                                   <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">xl</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">),</span>
                                   <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">size</span> <span class="o">=</span> <span class="n">annosize</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">G140L</span><span class="p">:</span>
                        <span class="n">l3</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">300</span><span class="p">,</span><span class="mi">900</span><span class="p">],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">,</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">],</span>
                               <span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
                        <span class="n">l2</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;start&#39;</span><span class="p">],</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;stop&#39;</span><span class="p">]],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">,</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">],</span>
                               <span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
                        <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;fp-pos&#39;</span><span class="p">],</span>
                                   <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">xl</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">),</span>
                                   <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">size</span> <span class="o">=</span> <span class="n">annosize</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">l2</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;start&#39;</span><span class="p">],</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;stop&#39;</span><span class="p">]],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">,</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">],</span>
                               <span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
                        <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;start&#39;</span><span class="p">]))),</span>
                                   <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;start&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">shiftx</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">),</span> 
                                   <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">size</span> <span class="o">=</span> <span class="n">annosize</span><span class="p">)</span>
                        <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s">&#39;fp-pos&#39;</span><span class="p">],</span>
                                   <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">xl</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="s">&#39;central&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">shifty</span><span class="p">),</span>
                                   <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">size</span> <span class="o">=</span> <span class="n">annosize</span><span class="p">)</span>

        
        <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s">&#39;FP-POS&#39;</span><span class="p">,</span>
                   <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.89</span><span class="p">),</span>
                   <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                   <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                   <span class="n">xycoords</span><span class="o">=</span><span class="s">&#39;axes fraction&#39;</span><span class="p">)</span>        
        

        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">()</span>
        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">G130M</span><span class="p">:</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1055</span><span class="o">+</span><span class="mi">205</span><span class="p">,</span> <span class="mi">1096</span><span class="o">+</span><span class="mi">175</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;fp-pos&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;segment&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;FUVA&#39;</span><span class="p">)][</span><span class="s">&#39;central&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">1100</span><span class="p">:</span>
                    <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
            <span class="c">#t = [str(x) for x in data[(data[&#39;fp-pos&#39;] == 1) &amp; (data[&#39;segment&#39;] == &#39;FUVA&#39;)][&#39;central&#39;]]</span>
            <span class="c">#ax.set_yticklabels(t)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s">&#39;1055&#39;</span><span class="p">,</span> <span class="s">&#39;1096&#39;</span><span class="p">,</span> <span class="s">&#39;1291&#39;</span><span class="p">,</span> <span class="s">&#39;1300&#39;</span><span class="p">,</span> <span class="s">&#39;1309&#39;</span><span class="p">,</span> <span class="s">&#39;1318&#39;</span><span class="p">,</span> <span class="s">&#39;1327&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;fp-pos&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;segment&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;FUVA&#39;</span><span class="p">)][</span><span class="s">&#39;central&#39;</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span> 
        
        <span class="k">if</span> <span class="n">G140L</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">500</span><span class="o">/</span><span class="mi">5</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2700</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">+</span> <span class="mi">50</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">G130M</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="o">/</span><span class="mi">5</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1520</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">+</span> <span class="mi">12</span><span class="p">)</span>            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="o">/</span><span class="mi">5</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span> <span class="o">-</span> <span class="mi">30</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">+</span> <span class="mi">15</span><span class="p">)</span>
        
        <span class="n">P</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;SEGMENT A&#39;</span><span class="p">,</span> <span class="s">&#39;SEGMENT B&#39;</span><span class="p">),</span> <span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>         
 </div>
<div class="viewcode-block" id="Plotting.Chapter13Wavelength"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.Chapter13Wavelength">[docs]</a>    <span class="k">def</span> <span class="nf">Chapter13Wavelength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grating</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">G140L</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots the FUV wavelength ranges for given grating setting.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">annosize</span> <span class="o">=</span> <span class="s">&#39;x-small&#39;</span> <span class="c"># &#39;small&#39;</span>
        
        <span class="n">xoff</span> <span class="o">=</span> <span class="n">offset</span>

        <span class="n">centwavs</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">grating</span><span class="p">:</span>
            <span class="n">centwavs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;FUVB&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">G140L</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">temp</span> <span class="o">!=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">temp</span> <span class="o">&gt;=</span> <span class="mf">1104.5</span><span class="p">:</span>
                            <span class="n">start</span> <span class="o">=</span> <span class="n">temp</span>
                            <span class="k">break</span>
                    <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">a</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">start</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
                                   <span class="s">&#39;b-&#39;</span><span class="p">,</span>
                                   <span class="n">label</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">lw</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
                        <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">start</span><span class="p">))),</span>
                                   <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">start</span> <span class="o">-</span> <span class="n">xoff</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> 
                                   <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">size</span> <span class="o">=</span> <span class="n">annosize</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s">&#39;1105&#39;</span><span class="p">,</span>
                                   <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1105</span> <span class="o">-</span> <span class="n">xoff</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                                   <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="n">size</span> <span class="o">=</span> <span class="n">annosize</span><span class="p">)</span>                        
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
                               <span class="s">&#39;b-&#39;</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                               <span class="n">lw</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
                    <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]))),</span>
                               <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">xoff</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> 
                               <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">size</span> <span class="o">=</span> <span class="n">annosize</span><span class="p">)</span>                
            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;FUVA&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">G140L</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">temp</span> <span class="o">!=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">temp</span> <span class="o">&gt;=</span> <span class="mf">1104.5</span><span class="p">:</span>
                            <span class="n">start</span> <span class="o">=</span> <span class="n">temp</span>
                            <span class="k">break</span>
                    <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]))),</span>
                               <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">xoff</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                               <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">size</span> <span class="o">=</span> <span class="n">annosize</span><span class="p">)</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">start</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
                               <span class="s">&#39;r-&#39;</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                               <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
                               <span class="s">&#39;r-&#39;</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                               <span class="n">lw</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
                    <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]))),</span>
                               <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">xoff</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> 
                               <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">size</span> <span class="o">=</span> <span class="n">annosize</span><span class="p">)</span>            
        
        <span class="c">#P.title(title) #or with title??????????????????</span>
        
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Central Wavelength (\AA)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Wavelength (\AA)&#39;</span><span class="p">)</span>  
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">()</span>
        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">()</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmin</span> <span class="o">-</span> <span class="mi">20</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">+</span> <span class="mi">20</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span> 
        <span class="n">P</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">centwavs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">G140L</span><span class="p">:</span>
            <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span> <span class="o">-</span> <span class="mi">170</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">+</span> <span class="mi">150</span><span class="p">)</span>
            <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
            <span class="c">#xmajorFormattor = FormatStrFormatter(&#39;%i&#39;)</span>
            <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
            <span class="c">#xmajorFormattor = FormatStrFormatter(&#39;%i&#39;)</span>
            <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;FUVA&#39;</span><span class="p">,</span> <span class="s">&#39;FUVB&#39;</span><span class="p">),</span> <span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span> <span class="c">#, loc=&#39;lower right&#39;) #, fancybox = True)    </span>
        
        <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
            <span class="n">tick</span><span class="o">.</span><span class="n">label1</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
            <span class="n">tick</span><span class="o">.</span><span class="n">label1</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    </div>
<div class="viewcode-block" id="Plotting.Chapter13WavelengthOLD"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.Chapter13WavelengthOLD">[docs]</a>    <span class="k">def</span> <span class="nf">Chapter13WavelengthOLD</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grating</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">G140L</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots the FUV wavelength ranges for given grating setting.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="mf">0.09</span> <span class="o">+</span> <span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="mf">0.21</span> <span class="o">+</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">xG</span><span class="p">,</span> <span class="n">yG</span> <span class="o">=</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.383</span>
        <span class="n">tmp</span><span class="p">,</span> <span class="n">extr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span>
        <span class="n">centwavs</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">grating</span><span class="p">:</span>
            <span class="n">tmp</span> <span class="o">+=</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">tmp</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">G140L</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">temp</span> <span class="o">!=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">temp</span> <span class="o">&gt;=</span> <span class="mf">1104.5</span><span class="p">:</span>
                            <span class="n">start</span> <span class="o">=</span> <span class="n">temp</span>
                            <span class="k">break</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">start</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
                               <span class="s">&#39;b-&#39;</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                               <span class="n">lw</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
                    <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]))),</span>
                               <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">xG</span> <span class="o">+</span> <span class="mf">0.73</span> <span class="o">+</span> <span class="n">extr</span><span class="p">,</span> <span class="n">yG</span><span class="p">),</span> 
                               <span class="n">xycoords</span><span class="o">=</span><span class="s">&#39;axes fraction&#39;</span><span class="p">,</span>
                               <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">)</span>
                    <span class="n">extr</span> <span class="o">+=</span> <span class="mf">0.08</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">dummy</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">]))],</span>
                               <span class="s">&#39;b-&#39;</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                               <span class="n">lw</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
                    <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]))),</span>
                               <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mf">0.72</span> <span class="o">+</span> <span class="n">offset</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="p">),</span>  
                               <span class="n">xycoords</span><span class="o">=</span><span class="s">&#39;axes fraction&#39;</span><span class="p">,</span>
                               <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">)</span>
                <span class="n">centwavs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">G140L</span><span class="p">:</span>
                    <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s">&#39;1105&#39;</span><span class="p">,</span>
                               <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">xG</span><span class="p">,</span> <span class="n">yG</span><span class="p">),</span>
                               <span class="n">xycoords</span><span class="o">=</span><span class="s">&#39;axes fraction&#39;</span><span class="p">,</span>
                               <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">1104.5</span><span class="p">:</span>
                        <span class="n">b</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">1104.5</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
                                   <span class="s">&#39;r-&#39;</span><span class="p">,</span>
                                   <span class="n">label</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">dummy</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">]))],</span>
                               <span class="s">&#39;r-&#39;</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                               <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
                    <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]))),</span>
                               <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span>
                               <span class="n">xycoords</span><span class="o">=</span><span class="s">&#39;axes fraction&#39;</span><span class="p">,</span>
                               <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">)</span>
                <span class="n">y</span> <span class="o">+=</span> <span class="mf">0.15</span> <span class="o">+</span> <span class="n">offset</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                <span class="n">x</span> <span class="o">+=</span> <span class="mf">0.023</span> <span class="o">+</span> <span class="n">offset</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
                <span class="n">yG</span> <span class="o">+=</span> <span class="mf">0.282</span>

        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Central Wavelength (\AA)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Wavelength (\AA)&#39;</span><span class="p">)</span>  
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">()</span>
        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">()</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmin</span> <span class="o">-</span> <span class="mi">20</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">+</span> <span class="mi">20</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span> 
        <span class="n">P</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">centwavs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">G140L</span><span class="p">:</span>
            <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">+</span> <span class="mi">100</span><span class="p">)</span>
            <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span> <span class="o">-</span> <span class="mi">150</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">+</span> <span class="mi">150</span><span class="p">)</span>         
        <span class="k">else</span><span class="p">:</span>
            <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmin</span> <span class="o">-</span> <span class="mi">20</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">+</span> <span class="mi">20</span><span class="p">)</span>
            <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span> 
            <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;FUVA&#39;</span><span class="p">,</span> <span class="s">&#39;FUVB&#39;</span><span class="p">),</span> <span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s">&#39;upper left&#39;</span><span class="p">)</span> <span class="c">#, fancybox = True)    </span>
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Plotting.Chapter13WavelengthNUVNew"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.Chapter13WavelengthNUVNew">[docs]</a>    <span class="k">def</span> <span class="nf">Chapter13WavelengthNUVNew</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">outputpath</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots the FUV wavelength ranges for given grating setting.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="mf">55.</span>
        <span class="n">length</span> <span class="o">=</span> <span class="mf">1023.</span>
        <span class="n">lsq</span> <span class="o">=</span> <span class="n">length</span><span class="o">**</span><span class="mi">2</span>
        
        <span class="n">annosize</span> <span class="o">=</span> <span class="s">&#39;x-small&#39;</span> <span class="c"># &#39;small&#39;</span>
        <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>

        <span class="c">#all gratings in data</span>
        <span class="n">gratings</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">gratings</span><span class="p">:</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="p">[[</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">g</span><span class="p">]</span>
            <span class="n">centwavs</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">])]</span>
            <span class="c">#use the dispersion solution to calculate the wavelength ranges</span>
            <span class="n">d</span> <span class="o">=</span> <span class="p">[[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span>
                  <span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">length</span><span class="o">*</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">lsq</span><span class="o">*</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> 
                   <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">shift</span><span class="o">*</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                   <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">2.</span><span class="o">*</span><span class="n">shift</span><span class="o">*</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">length</span><span class="o">*</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">lsq</span><span class="o">*</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">]]]</span>
                   <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">]</span>
           
            <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
                <span class="n">def_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
                <span class="n">ext_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">]]</span>
                <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
                <span class="k">print</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s"> </span><span class="si">%5i</span><span class="s"> </span><span class="si">%s</span><span class="s"> </span><span class="si">%6.0f</span><span class="s"> </span><span class="si">%6.0f</span><span class="s"> </span><span class="si">%5.2f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">def_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">def_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">def_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">ext_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="s">&#39;NUVA&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ext_range</span><span class="p">,</span> <span class="n">y</span> <span class="p">,</span><span class="s">&#39;b-&#39;</span><span class="p">,</span>
                            <span class="n">lw</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
                            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">)</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">def_range</span><span class="p">,</span> <span class="n">y</span> <span class="p">,</span><span class="s">&#39;b-&#39;</span><span class="p">,</span>
                                <span class="n">label</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                <span class="n">lw</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
                                <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">)</span>
                <span class="k">if</span> <span class="s">&#39;NUVB&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ext_range</span><span class="p">,</span> <span class="n">y</span> <span class="p">,</span><span class="s">&#39;g-&#39;</span><span class="p">,</span>
                            <span class="n">lw</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
                            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">)</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">def_range</span><span class="p">,</span> <span class="n">y</span> <span class="p">,</span><span class="s">&#39;g-&#39;</span><span class="p">,</span>
                                <span class="n">label</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                <span class="n">lw</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
                                <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">)</span>
                <span class="k">if</span> <span class="s">&#39;NUVC&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="s">&#39;G230L&#39;</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ext_range</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span><span class="s">&#39;r-&#39;</span><span class="p">,</span>
                                <span class="n">lw</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
                                <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">)</span>
                        <span class="n">c</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">def_range</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span><span class="s">&#39;r-&#39;</span><span class="p">,</span>
                                    <span class="n">label</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                    <span class="n">lw</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
                                    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>                    
                        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ext_range</span><span class="p">,</span> <span class="n">y</span> <span class="p">,</span><span class="s">&#39;r-&#39;</span><span class="p">,</span>
                                <span class="n">lw</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
                                <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">)</span>
                        <span class="n">c</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">def_range</span><span class="p">,</span> <span class="n">y</span> <span class="p">,</span><span class="s">&#39;r-&#39;</span><span class="p">,</span>
                                    <span class="n">label</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                    <span class="n">lw</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
                                    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;Central Wavelength (\AA)&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Wavelength (\AA)&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;NUVA&#39;</span><span class="p">,</span> <span class="s">&#39;NUVB&#39;</span><span class="p">,</span> <span class="s">&#39;NUVC&#39;</span><span class="p">),</span> <span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s">&#39;upper left&#39;</span><span class="p">)</span> 
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">centwavs</span><span class="p">)</span>
        
            <span class="k">if</span> <span class="s">&#39;G230L&#39;</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
                <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>   
                <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">900.</span><span class="p">,</span> <span class="mf">4000.</span><span class="p">)</span>
                <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">2500.</span><span class="p">,</span> <span class="mf">3500.</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>                   
            
            <span class="k">if</span> <span class="s">&#39;G285&#39;</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
                <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">2600.</span><span class="p">,</span> <span class="mf">3110.</span><span class="p">)</span>
                <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">2380.</span><span class="p">,</span> <span class="mf">3320.</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
                <span class="n">tick</span><span class="o">.</span><span class="n">label1</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
                <span class="n">tick</span><span class="o">.</span><span class="n">label1</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
            
            <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">outputpath</span> <span class="o">+</span> <span class="n">g</span> <span class="o">+</span> <span class="s">&#39;Wave&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
            <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="Plotting.Chapter13WavelengthNUV"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.Chapter13WavelengthNUV">[docs]</a>    <span class="k">def</span> <span class="nf">Chapter13WavelengthNUV</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grating</span><span class="p">,</span> <span class="n">xoffset</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots the FUV wavelength ranges for given grating setting.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">annosize</span> <span class="o">=</span> <span class="s">&#39;x-small&#39;</span> <span class="c"># &#39;small&#39;</span>

        <span class="n">G230</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">G285</span> <span class="o">=</span> <span class="bp">False</span>
        
        <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        
        <span class="n">centwavs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">xoff</span> <span class="o">=</span> <span class="n">xoffset</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        
        <span class="c">#(&#39;NUVC&#39;, &#39;G230L&#39;, 2950, &#39;PSA&#39;, WAVE, SENS)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">grating</span><span class="p">:</span>
            <span class="n">centwavs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;G285M&#39;</span><span class="p">:</span> <span class="n">G285</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;G230L&#39;</span><span class="p">:</span> <span class="n">G230</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;NUVA&#39;</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
                           <span class="s">&#39;b-&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                           <span class="n">lw</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;G230L&#39;</span><span class="p">:</span>
                    <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]))),</span>
                               <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">xoff</span> <span class="o">-</span> <span class="mi">85</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> 
                               <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">size</span> <span class="o">=</span> <span class="n">annosize</span><span class="p">)</span>                                  
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]))),</span>
                               <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">xoff</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> 
                               <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">size</span> <span class="o">=</span> <span class="n">annosize</span><span class="p">)</span>           
            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;NUVB&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">G230</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">3200</span><span class="p">:</span>
                        <span class="n">b</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
                               <span class="s">&#39;g-&#39;</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                               <span class="n">lw</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
                               <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
                        <span class="n">b</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="mi">3200</span><span class="p">],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
                               <span class="s">&#39;g-&#39;</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                               <span class="n">lw</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">b</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
                               <span class="s">&#39;g-&#39;</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                               <span class="n">lw</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
                    <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]))),</span>
                               <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">xoff</span> <span class="o">+</span> <span class="mi">90</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> 
                               <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">size</span> <span class="o">=</span> <span class="n">annosize</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
                           <span class="s">&#39;g-&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                           <span class="n">lw</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;NUVC&#39;</span><span class="p">:</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
                           <span class="s">&#39;r-&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                           <span class="n">lw</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
                           <span class="n">zorder</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&#39;G230L&#39;</span><span class="p">:</span>
                    <span class="n">P</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]))),</span>
                               <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">xoff</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> 
                               <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                               <span class="n">size</span> <span class="o">=</span> <span class="n">annosize</span><span class="p">)</span>
        
        <span class="c">#P.title(title)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Central Wavelength (\AA)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Wavelength (\AA)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;NUVA&#39;</span><span class="p">,</span> <span class="s">&#39;NUVB&#39;</span><span class="p">,</span> <span class="s">&#39;NUVC&#39;</span><span class="p">),</span> <span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s">&#39;upper left&#39;</span><span class="p">)</span> 
        <span class="n">P</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">centwavs</span><span class="p">)</span>

        
        <span class="k">if</span> <span class="n">G230</span><span class="p">:</span>
            <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>   
            <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">900.</span><span class="p">,</span> <span class="mf">4000.</span><span class="p">)</span>
            <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">2500.</span><span class="p">,</span> <span class="mf">3500.</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>                   
        
        <span class="k">if</span> <span class="n">G285</span><span class="p">:</span>
            <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">2600.</span><span class="p">,</span> <span class="mf">3110.</span><span class="p">)</span>
            <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">2380.</span><span class="p">,</span> <span class="mf">3320.</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
            <span class="n">tick</span><span class="o">.</span><span class="n">label1</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
            <span class="n">tick</span><span class="o">.</span><span class="n">label1</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="Plotting.FUVsensitivityBOA"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.FUVsensitivityBOA">[docs]</a>    <span class="k">def</span> <span class="nf">FUVsensitivityBOA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datax1</span><span class="p">,</span> <span class="n">datay1</span><span class="p">,</span> <span class="n">datax2</span><span class="p">,</span> <span class="n">datay2</span><span class="p">,</span> <span class="n">datax3</span><span class="p">,</span> <span class="n">datay3</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots the FUV BOA point-source sensitivities for three gratings.</span>
<span class="sd">        &#39;&#39;&#39;</span>    
        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;FUV BOA point-source sensitivities&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Wavelength (\AA)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;counts resel$^{-1}$ sec$^{-1}$ per FEFU&#39;</span><span class="p">)</span>      
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax1</span><span class="p">,</span> <span class="n">datay1</span><span class="p">,</span> <span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G130M&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax2</span><span class="p">,</span> <span class="n">datay2</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G140L&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax3</span><span class="p">,</span> <span class="n">datay3</span><span class="p">,</span> <span class="s">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G160M&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1077.</span><span class="p">,</span> <span class="mf">2140.</span><span class="p">)</span>
        
        <span class="c">#limits the y axis between realistic values</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">datax2</span><span class="p">,</span> <span class="n">datay2</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mf">1100.</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">2000</span><span class="p">]</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0000001</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="mf">1.05</span><span class="p">)</span>

        <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">()</span>
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    </div>
<div class="viewcode-block" id="Plotting.NUVsensitivity"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.NUVsensitivity">[docs]</a>    <span class="k">def</span> <span class="nf">NUVsensitivity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">G185</span><span class="p">,</span> <span class="n">G225</span><span class="p">,</span> <span class="n">G285</span><span class="p">,</span> <span class="n">G230</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots NUV point-source sensitivities in units of effective area</span>
<span class="sd">        and throughput.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">ar</span> <span class="o">=</span> <span class="mf">45238.93416</span> <span class="c">#HST primary area in cm**2</span>
        <span class="n">split</span> <span class="o">=</span> <span class="mi">3255</span> <span class="c">#3250</span>
        <span class="n">every</span> <span class="o">=</span> <span class="mi">3</span>
        
        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="c">#P.title(&#39;FUV point-source sensitivities&#39;)</span>

        <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

        <span class="n">G230L2ndX</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G230</span> <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1700</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2600</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">)]</span>
        <span class="n">G230L2ndY</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G230</span> <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1700</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2600</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">)]</span>
            
        <span class="n">G230LX</span><span class="p">,</span> <span class="n">G230LY</span> <span class="o">=</span> <span class="n">Fix</span><span class="p">(</span><span class="n">G230</span><span class="p">)</span>

        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G185</span><span class="p">][::</span><span class="n">every</span><span class="p">],</span> <span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G185</span><span class="p">][::</span><span class="n">every</span><span class="p">])</span><span class="o">/</span><span class="n">ar</span><span class="p">,</span> <span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G185M&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G225</span><span class="p">][::</span><span class="n">every</span><span class="p">],</span> <span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G225</span><span class="p">][::</span><span class="n">every</span><span class="p">])</span><span class="o">/</span><span class="n">ar</span><span class="p">,</span> <span class="s">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G225M&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G285</span><span class="p">][::</span><span class="n">every</span><span class="p">],</span> <span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G285</span><span class="p">][::</span><span class="n">every</span><span class="p">])</span><span class="o">/</span><span class="n">ar</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G285M&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">G230LX</span><span class="p">[</span><span class="n">G230LX</span> <span class="o">&lt;</span> <span class="n">split</span><span class="p">],</span> <span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">G230LY</span><span class="p">[</span><span class="n">G230LX</span> <span class="o">&lt;</span> <span class="n">split</span><span class="p">])</span><span class="o">/</span><span class="n">ar</span><span class="p">,</span> <span class="s">&#39;m-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G230L&#39;</span><span class="p">)</span>
        <span class="c">#ax2.plot(G230L2ndX, N.array(G230L2ndY)/ar, &#39;m:&#39;, label=&#39;G230L 2nd-order&#39;)</span>
        <span class="c">#ax2.plot([line[0] for line in G230 if line[0] &gt;= split], N.array([line[1] for line in G230 if line[0] &gt;= split])/ar, &#39;m:&#39;)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G185</span><span class="p">][::</span><span class="n">every</span><span class="p">],</span> <span class="p">[</span><span class="n">line</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G185</span><span class="p">][::</span><span class="n">every</span><span class="p">],</span> <span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G185M&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G225</span><span class="p">][::</span><span class="n">every</span><span class="p">],</span> <span class="p">[</span><span class="n">line</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G225</span><span class="p">][::</span><span class="n">every</span><span class="p">],</span> <span class="s">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G225M&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G285</span><span class="p">][::</span><span class="n">every</span><span class="p">],</span> <span class="p">[</span><span class="n">line</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">G285</span><span class="p">][::</span><span class="n">every</span><span class="p">],</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G285M&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">G230LX</span><span class="p">[</span><span class="n">G230LX</span> <span class="o">&lt;</span> <span class="n">split</span><span class="p">],</span> <span class="n">G230LY</span><span class="p">[</span><span class="n">G230LX</span> <span class="o">&lt;</span> <span class="n">split</span><span class="p">],</span> <span class="s">&#39;m-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G230L&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="c">#ax.plot(G230L2ndX, G230L2ndY, &#39;m:&#39;, label=&#39;G230L 2nd-order&#39;, lw = 3)</span>
        <span class="c">#ax2.plot([line[0] for line in G230 if line[0] &gt;= split], [line[1] for line in G230 if line[0] &gt;= split], &#39;m:&#39;)</span>

        <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">G230</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mf">2000.</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mf">3000.</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0001</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="mf">1.05</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0001</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="mf">1.05</span><span class="o">/</span><span class="n">ar</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">1200.</span><span class="p">,</span> <span class="mf">3300.</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">1200.</span><span class="p">,</span> <span class="mf">3300.</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Wavelength (\AA)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;Effective Area (cm$^{2}$)&#39;</span><span class="p">)</span> 
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;Fractional Throughput&#39;</span><span class="p">)</span> 
        
        <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">500</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="o">/</span><span class="mi">5</span><span class="p">))</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">0.005</span><span class="o">/</span><span class="mi">5</span><span class="p">))</span>

        <span class="n">P</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        </div>
<div class="viewcode-block" id="Plotting.NUVsensitivityM"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.NUVsensitivityM">[docs]</a>    <span class="k">def</span> <span class="nf">NUVsensitivityM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datax1</span><span class="p">,</span> <span class="n">datay1</span><span class="p">,</span> <span class="n">datax2</span><span class="p">,</span> <span class="n">datay2</span><span class="p">,</span> <span class="n">datax3</span><span class="p">,</span> <span class="n">datay3</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots NUV point-source sensitivities for M gratings.</span>
<span class="sd">        Corresponds to Figure 5.3 on page 41 at the first COS instrument handbook.</span>
<span class="sd">        &#39;&#39;&#39;</span>              
        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;NUV point-source sensitivities: M gratings&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Wavelength (\AA)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;counts resel$^{-1}$ sec$^{-1}$ per FEFU&#39;</span><span class="p">)</span>    
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax1</span><span class="p">,</span> <span class="n">datay1</span><span class="p">,</span> <span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G185M&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax2</span><span class="p">,</span> <span class="n">datay2</span><span class="p">,</span> <span class="s">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G225M&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax3</span><span class="p">,</span> <span class="n">datay3</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G285M&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1500.</span><span class="p">,</span> <span class="mf">3400.</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
        <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Plotting.NUVsensitivityG230L"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.NUVsensitivityG230L">[docs]</a>    <span class="k">def</span> <span class="nf">NUVsensitivityG230L</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots NUV point-source sensitivities for grating G230L.</span>
<span class="sd">        Corresponds to Figure 5.4 on page 41 at the first COS instrument handbook.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>        
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;NUV point-source sensitivity: G230L&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Wavelength (\AA)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;counts resel$^{-1}$ sec$^{-1}$ per FEFU&#39;</span><span class="p">)</span>     
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;G230L&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1000.</span><span class="p">,</span> <span class="mf">4000.</span><span class="p">)</span>
        <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        </div>
<div class="viewcode-block" id="Plotting.NUVFlatField"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.NUVFlatField">[docs]</a>    <span class="k">def</span> <span class="nf">NUVFlatField</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">,</span> <span class="n">yline</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">smooth</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">smoothing</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,)):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots the NUV MAMA flat field.</span>
<span class="sd">        Corresponds to Figure 5.6 on page 53 at the first COS instrument handbook.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;NUV Flat Field&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;x (pixels)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Normalized Counts&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">,</span> <span class="s">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">&#39;Profile&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">smooth</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">scipy.stsci.convolve</span> <span class="kn">as</span> <span class="nn">C</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">convolve</span> <span class="kn">as</span> <span class="nn">C</span>
            <span class="n">smoothed</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">boxcar</span><span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datay</span><span class="p">),</span> <span class="n">smoothing</span><span class="p">)</span>
            <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax</span><span class="p">,</span> <span class="n">smoothed</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Boxcar smoothed&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">datay</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Plotting.FUVFlatField"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.FUVFlatField">[docs]</a>    <span class="k">def</span> <span class="nf">FUVFlatField</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">,</span> <span class="n">yline</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">smooth</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">smoothing</span> <span class="o">=</span> <span class="p">(</span><span class="mi">50</span><span class="p">,)):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots the NUV MAMA flat field.</span>
<span class="sd">        Corresponds to Figure 5.6 on page 53 at the first COS instrument handbook.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;FUV Flat Field&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;x (pixels)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Normalized Counts&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">,</span> <span class="s">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Profile&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">smooth</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">scipy.stsci.convolve</span> <span class="kn">as</span> <span class="nn">C</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">convolve</span> <span class="kn">as</span> <span class="nn">C</span>
            <span class="n">smoothed</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">boxcar</span><span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datay</span><span class="p">),</span> <span class="n">smoothing</span><span class="p">)</span>
            <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax</span><span class="p">,</span> <span class="n">smoothed</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">&#39;Boxcar smoothed&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">datay</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Plotting.PSAMMIRRORANUVImaging"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.PSAMMIRRORANUVImaging">[docs]</a>    <span class="k">def</span> <span class="nf">PSAMMIRRORANUVImaging</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Test function to plot cross section through and image.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;PSA imaging with MIRRORA&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;y (pixels)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Counts&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">175.</span><span class="p">,</span> <span class="mf">225.</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Plotting.COSFUVSpectrumDev2"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.COSFUVSpectrumDev2">[docs]</a>    <span class="k">def</span> <span class="nf">COSFUVSpectrumDev2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">imagedata</span><span class="p">,</span> <span class="n">wave</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">exptime</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots an example of a COS FUV spectrum with annotate.</span>
<span class="sd">        A bug in matplotlib version of STScI installation prevents using this... </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">xlow</span> <span class="o">=</span> <span class="mi">800</span>
        <span class="n">xhigh</span> <span class="o">=</span> <span class="mi">15000</span>
        
        <span class="n">fig</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
        
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Segment B, G160M, 1600 \AA, </span><span class="si">%i</span><span class="s"> seconds&#39;</span> <span class="o">%</span> <span class="n">exptime</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">xticklabels</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticklabels</span><span class="o">=</span><span class="p">[])</span>
        
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">,</span> <span class="n">autoscale_on</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imagedata</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">gist_yarg</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">N</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">imagedata</span><span class="p">),</span> 
                   <span class="n">vmax</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">imagedata</span><span class="p">)</span> <span class="o">/</span> <span class="n">exptime</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="s">&#39;lower&#39;</span><span class="p">,</span> <span class="n">aspect</span> <span class="o">=</span> <span class="s">&#39;auto&#39;</span><span class="p">,</span>
                   <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;nearest&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s">&#39;WCA&#39;</span><span class="p">,</span> <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="mf">4000.</span><span class="p">,</span> <span class="mf">540.</span><span class="p">),</span> <span class="n">xycoords</span> <span class="o">=</span> <span class="s">&#39;data&#39;</span><span class="p">,</span>
                        <span class="n">xytext</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="n">textcoords</span> <span class="o">=</span> <span class="s">&#39;offset points&#39;</span><span class="p">,</span>
                        <span class="n">arrowprops</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s">&quot;-&gt;&quot;</span><span class="p">,</span>
                        <span class="n">connectionstyle</span> <span class="o">=</span> <span class="s">&quot;angle,angleA=0,angleB=90,rad=10&quot;</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;Y pixels&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">450.</span><span class="p">,</span><span class="mf">600.</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlow</span><span class="p">,</span> <span class="n">xhigh</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">xticklabels</span><span class="o">=</span><span class="p">[])</span>
        
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>   
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="n">exptime</span> <span class="o">*</span> <span class="n">counts</span><span class="p">,</span> <span class="s">&#39;k-&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;Counts&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;x pixels&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlow</span><span class="p">,</span> <span class="n">xhigh</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">exptime</span> <span class="o">*</span> <span class="n">N</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span><span class="o">*</span><span class="mf">1.1</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>        
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> 

    </div>
<div class="viewcode-block" id="Plotting.COSFUVSpectrum"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.COSFUVSpectrum">[docs]</a>    <span class="k">def</span> <span class="nf">COSFUVSpectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">imagedata</span><span class="p">,</span> <span class="n">wave</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">exptime</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots an example of a COS FUV spectrum.</span>
<span class="sd">        Corresponds to Figure 4.2 on page 29 at the first COS instrument handbook.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">xlow</span> <span class="o">=</span> <span class="mi">800</span>
        <span class="n">xhigh</span> <span class="o">=</span> <span class="mi">15000</span>
        
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Segment B, G160M, 1600 \AA, </span><span class="si">%i</span><span class="s"> seconds&#39;</span> <span class="o">%</span> <span class="n">exptime</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">xticklabels</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticklabels</span><span class="o">=</span><span class="p">[])</span>
        
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">,</span> <span class="n">autoscale_on</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imagedata</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">gist_yarg</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">N</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">imagedata</span><span class="p">),</span> 
                   <span class="n">vmax</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">imagedata</span><span class="p">)</span> <span class="o">/</span> <span class="n">exptime</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="s">&#39;lower&#39;</span><span class="p">,</span> <span class="n">aspect</span> <span class="o">=</span> <span class="s">&#39;auto&#39;</span><span class="p">,</span>
                   <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;nearest&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;Y pixels&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">450.</span><span class="p">,</span><span class="mf">600.</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlow</span><span class="p">,</span> <span class="n">xhigh</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">xticklabels</span><span class="o">=</span><span class="p">[])</span>
        
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>   
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="n">exptime</span> <span class="o">*</span> <span class="n">counts</span><span class="p">,</span> <span class="s">&#39;k-&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;Counts&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;x pixels&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlow</span><span class="p">,</span> <span class="n">xhigh</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">exptime</span> <span class="o">*</span> <span class="n">N</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span><span class="o">*</span><span class="mf">1.1</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>        
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> 
        </div>
<div class="viewcode-block" id="Plotting.WavecalSpecPSA"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.WavecalSpecPSA">[docs]</a>    <span class="k">def</span> <span class="nf">WavecalSpecPSA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wave</span><span class="p">,</span> <span class="n">countss</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots and example wavecal spectrum of PSA FUV.</span>
<span class="sd">        Corresponds to Figures 13.3 and 13.4 on page 138 of the fist COS instrument handbook.</span>
<span class="sd">        &#39;&#39;&#39;</span>  
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;G140L PSA&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="n">countss</span><span class="p">,</span> <span class="s">&#39;k-&#39;</span><span class="p">)</span>
        <span class="c">#P.xlabel(&#39;Wavelength (\AA)&#39;)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;x (pixels)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Counts per second&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="n">countss</span><span class="p">,</span> <span class="s">&#39;k-&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">12000</span><span class="p">)</span>
        <span class="n">inset</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="o">.</span><span class="mi">6</span><span class="p">,</span> <span class="o">.</span><span class="mi">65</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="n">countss</span><span class="p">,</span> <span class="s">&#39;k-&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">4600</span><span class="p">,</span> <span class="mi">4700</span><span class="p">))</span> <span class="c">#, xticks=[], yticks=[])</span>
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    </div>
<div class="viewcode-block" id="Plotting.MIRRORB"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.MIRRORB">[docs]</a>    <span class="k">def</span> <span class="nf">MIRRORB</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots the cross-section of a point-source image with MIRRORB.</span>
<span class="sd">        Corresponds to Figure 7.4 on page 73 at the first COS instrument handbook.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Point-source image with MIRRORB&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;x (pixels)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Counts&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">280</span><span class="p">,</span> <span class="mi">340</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">datay</span><span class="p">)</span> <span class="o">+</span> <span class="mi">30</span><span class="p">)</span>
        
        <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">10.</span><span class="o">/</span><span class="mf">5.</span><span class="p">)</span>
        <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>

        <span class="n">yminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">200</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">yminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">yminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">yminorFormattor</span><span class="p">)</span>
        
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        </div>
<div class="viewcode-block" id="Plotting.BOAprofile"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.BOAprofile">[docs]</a>    <span class="k">def</span> <span class="nf">BOAprofile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots the cross-section through an image obtained with the BOA.</span>
<span class="sd">        Corresponds to Figure 7.5 on page 74 at the first COS instrument handbook.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;BOA image profile&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;x (pixels)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Relative Counts&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">)</span>

        <span class="c">#P.xlim(280, 340)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">datay</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>

        <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">5.</span><span class="o">/</span><span class="mf">5.</span><span class="p">)</span>
        <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>
        
        <span class="n">yminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">yminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">yminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">yminorFormattor</span><span class="p">)</span>        
        
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        </div>
<div class="viewcode-block" id="Plotting.BOAMIRRORprofile"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.BOAMIRRORprofile">[docs]</a>    <span class="k">def</span> <span class="nf">BOAMIRRORprofile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataxx</span><span class="p">,</span> <span class="n">dataxy</span><span class="p">,</span> <span class="n">datayx</span><span class="p">,</span> <span class="n">datayy</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots the cross-section through an image obtained with the BOA + MIRRORB in both x and y direction.</span>
<span class="sd">        Corresponds to Figs. 7.6 and 7.7 on page 75 at the first COS instrument handbook.</span>
<span class="sd">        &#39;&#39;&#39;</span>
  
        <span class="c">#profile in x</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;BOA + MIRRORB profile in x&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;x (pixels)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Relative Counts&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dataxx</span><span class="p">,</span> <span class="n">dataxy</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">)</span>

        <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">dataxy</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">dataxx</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">dataxx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">20</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>

        <span class="n">yminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span>
        <span class="n">yminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">yminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">yminorFormattor</span><span class="p">)</span> 
                    
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span> <span class="o">+</span> <span class="s">&#39;_x&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>        
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        
        <span class="c">#profile in y</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;BOA + MIRRORB profile in y&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;y (pixels)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Relative Counts&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datayx</span><span class="p">,</span> <span class="n">datayy</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">)</span>

        <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">datayy</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">datayx</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">datayx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">20</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>

        <span class="n">yminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span>
        <span class="n">yminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">yminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">yminorFormattor</span><span class="p">)</span>
        
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span> <span class="o">+</span> <span class="s">&#39;_y&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        </div>
<div class="viewcode-block" id="Plotting.BOATransmission"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.BOATransmission">[docs]</a>    <span class="k">def</span> <span class="nf">BOATransmission</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">,</span> <span class="n">every</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots transmission of the COS BOA as a function of wavelength.</span>
<span class="sd">        Corresponds to Fig. 3.4 on page 14 of the first COS instrument handbook.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;BOA transmission&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Wavelength (\AA)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;BOA transmission&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax</span><span class="p">[::</span><span class="n">every</span><span class="p">],</span> <span class="n">datay</span><span class="p">[::</span><span class="n">every</span><span class="p">],</span> <span class="s">&#39;ro&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3050</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.003</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
        <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Plotting.ScatteredLight"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.ScatteredLight">[docs]</a>    <span class="k">def</span> <span class="nf">ScatteredLight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots the scattered light in the FUV.</span>
<span class="sd">        Corresponds to Fig. 5.1 on page 39 at the first COS instrument handbook.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Segment A, G130M, 1309 A, 300 seconds&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;x (pixels)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Counts&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">,</span> <span class="s">&#39;k-&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">17000</span><span class="p">)</span>
        <span class="n">inset</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="o">.</span><span class="mi">6</span><span class="p">,</span> <span class="o">.</span><span class="mi">6</span><span class="p">,</span> <span class="o">.</span><span class="mi">27</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">])</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">,</span> <span class="s">&#39;k-&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">5500</span><span class="p">,</span> <span class="mi">6600</span><span class="p">),</span> <span class="n">xticks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5500</span><span class="p">,</span> <span class="mi">6000</span><span class="p">,</span> <span class="mi">6500</span><span class="p">])</span>
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        </div>
<div class="viewcode-block" id="Plotting.NUVPSAImagingSensitivity"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.NUVPSAImagingSensitivity">[docs]</a>    <span class="k">def</span> <span class="nf">NUVPSAImagingSensitivity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots the sensitivity curve for COS NUV imaging with the PSA.</span>
<span class="sd">        Corresponds to Fig. 6.1 on page 61 at the first COS instrument handbook.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">ar</span> <span class="o">=</span> <span class="mf">45238.93416</span>
        
        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>      
        <span class="c">#P.title(&#39;System Throughput for NUV Imaging&#39;)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Wavelength (\AA)&#39;</span><span class="p">)</span>
        <span class="c">#P.ylabel(&#39;counts \AA$^{-1}$ per FEFU&#39;)</span>
        <span class="c">#P.ylabel(&#39;Throughput&#39;)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Effective Area (cm$^{-2}$)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datay</span><span class="p">)</span><span class="o">*</span><span class="n">ar</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1400</span><span class="p">,</span> <span class="mi">3700</span><span class="p">)</span>
        
        <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>

        <span class="n">yminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">200</span><span class="o">/</span><span class="mf">5.</span><span class="p">)</span>
        <span class="n">yminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">yminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">yminorFormattor</span><span class="p">)</span> 
        
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        </div>
<div class="viewcode-block" id="Plotting.NUVImageProfile"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.NUVImageProfile">[docs]</a>    <span class="k">def</span> <span class="nf">NUVImageProfile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xpixels</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots NUV imaging profile for COS.</span>
<span class="sd">        Corresponds to Fig. 6.3 on page 63 at the first COS instrument handbook.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span> 
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;NUV image profile&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;x (pixels)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Counts&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xpixels</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="c">#P.semilogy(xpixels, counts, &#39;r-&#39;, lw = 3)</span>
        <span class="c">#P.axhline(0)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">477</span><span class="p">,</span> <span class="mi">495</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>

        <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span>
        
        <span class="n">yminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">10</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">yminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">yminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">yminorFormattor</span><span class="p">)</span>         
        
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>        
        
        </div>
<div class="viewcode-block" id="Plotting.PSARelativeTransmission"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.PSARelativeTransmission">[docs]</a>    <span class="k">def</span> <span class="nf">PSARelativeTransmission</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plots the relative transmission of the COS PSA at 1450A.</span>
<span class="sd">        Corresponds to Fig. 7.1 on page 69 at the first COS instrument handbook.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span> 
        <span class="c">#P.title(&#39;Relative throughput of PSA at 1450 \AA&#39;)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;r (arcsec)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;relative flux&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">)</span>
        <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span> 
        <span class="n">yminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">0.04</span><span class="p">)</span>
        <span class="n">yminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">yminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">yminorFormattor</span><span class="p">)</span> 
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>        
    </div>
<div class="viewcode-block" id="Plotting.PSF"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.PSF">[docs]</a>    <span class="k">def</span> <span class="nf">PSF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">,</span> <span class="n">dataz</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Does not do very good job with matplotlib 0.99.0.</span>
<span class="sd">        The labels are somewhat tilted respect to the axis.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">dataz</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span> <span class="c">#cm.gist_gray)</span>
        <span class="c">#ax.plot_wireframe(X, Y, dataz, rstride=1, cstride=1)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;X Pixels&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;Y Pixels&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s">&#39;Counts / s&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>                
    </div>
<div class="viewcode-block" id="Plotting.PSFObsolete"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.PSFObsolete">[docs]</a>    <span class="k">def</span> <span class="nf">PSFObsolete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Surface plotting with Gnuplot. Output is horrible... do NOT use!</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">Gnuplot</span><span class="o">.</span><span class="n">Gnuplot</span><span class="p">()</span>
        <span class="n">g</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">g</span><span class="p">(</span><span class="s">&#39;set ticslevel 0&#39;</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;x (pixels)&#39;</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;y (pixels)&#39;</span><span class="p">)</span>
        <span class="n">g</span><span class="p">(</span><span class="s">&#39;set zlabel </span><span class="se">\&quot;</span><span class="s">counts</span><span class="se">\&quot;</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">g</span><span class="p">(</span><span class="s">&#39;set surface&#39;</span><span class="p">)</span>
        <span class="n">g</span><span class="p">(</span><span class="s">&#39;set style data lines&#39;</span><span class="p">)</span>
        <span class="c">#g(&#39;set dgrid3d 10,10&#39;)</span>
        <span class="n">g</span><span class="p">(</span><span class="s">&#39;set view 60,75&#39;</span><span class="p">)</span>
        <span class="c">#g(&#39;set hidden3d&#39;)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">splot</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">hardcopy</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">output</span> <span class="o">+</span> <span class="s">&#39;.ps&#39;</span><span class="p">,</span><span class="n">terminal</span><span class="o">=</span><span class="s">&quot;postscript&quot;</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="Plotting.LSFcomparison"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.LSFcomparison">[docs]</a>    <span class="k">def</span> <span class="nf">LSFcomparison</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">waves</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Line Spread Function Comparison plots for Chapter 13.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid.inset_locator</span> <span class="kn">import</span> <span class="n">zoomed_inset_axes</span>
        <span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid.inset_locator</span> <span class="kn">import</span> <span class="n">mark_inset</span>
        
        <span class="n">limites</span> <span class="o">=</span> <span class="mi">41</span>
        
        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        
        <span class="n">cols</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">cols</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">:</span>
                <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="n">waves</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;\AA&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">8</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">14</span><span class="p">:</span>
                <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="n">waves</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;\AA&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s">&#39;:&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="n">waves</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;\AA&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s">&#39;-.&#39;</span><span class="p">)</span>
        
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Displacement (pixels)&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Normalized Intensity&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="n">limites</span><span class="p">,</span> <span class="n">limites</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">shadow</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">10.</span><span class="o">/</span><span class="mf">5.</span><span class="p">)</span>
        <span class="n">xminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">xminorFormattor</span><span class="p">)</span> 
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">waves</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">14</span><span class="p">:</span> <span class="n">yminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">0.02</span><span class="o">/</span><span class="mf">5.</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">yminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">0.05</span><span class="o">/</span><span class="mf">5.</span><span class="p">)</span>
        <span class="n">yminorFormattor</span> <span class="o">=</span> <span class="n">NullFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">yminorLocator</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">yminorFormattor</span><span class="p">)</span> 

        <span class="c">#inset</span>
        <span class="c">#axins = zoomed_inset_axes(ax, 3.4, loc=2)</span>
        <span class="c">#for i in range(1,cols):</span>
        <span class="c">#    if i &lt; 8:</span>
        <span class="c">#        axins.plot(data[:,0], data[:,i], label = waves[i-1] + &#39;\AA&#39;, lw = 0.5)</span>
        <span class="c">#    elif i &gt;= 8 and i &lt; 14:</span>
        <span class="c">#        axins.plot(data[:,0], data[:,i], label = waves[i-1] + &#39;\AA&#39;, lw = 0.5, ls = &#39;:&#39;)</span>
        <span class="c">#    else:</span>
        <span class="c">#        axins.plot(data[:,0], data[:,i], label = waves[i-1] + &#39;\AA&#39;, lw = 0.5, ls = &#39;-.&#39;)       </span>
        <span class="c">#if &#39;NUV&#39; in title:</span>
        <span class="c">#    axins.set_xlim(-4.0, 4.0)</span>
        <span class="c">#    #axins.set_xlim(-1., 1.)</span>
        <span class="c">#else:</span>
        <span class="c">#    axins.set_xlim(-3.8, 3.8)</span>
        <span class="c">#    #axins.set_xlim(-2.5, 2.5)</span>
        <span class="c">#axins.set_ylim(max(data[:,i])-max(data[:,i])/7., max(data[:,i])+max(data[:,i])/110.)</span>
        <span class="c">#mark_inset(ax, axins, loc1=1, loc2=4, fc=&#39;none&#39;, ec=&#39;0.5&#39;)</span>

        <span class="c">#axins.set_xticks([100,])</span>
        <span class="c">#axins.set_yticks([0,])</span>
        
        <span class="c">#P.xticks(visible=False)</span>
        <span class="c">#P.yticks(visible=False)</span>
               
        <span class="c">#inset2</span>
        <span class="n">axins2</span> <span class="o">=</span> <span class="n">zoomed_inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">cols</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">:</span>
                <span class="n">axins2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="n">waves</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;\AA&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">8</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">14</span><span class="p">:</span>
                <span class="n">axins2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="n">waves</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;\AA&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s">&#39;:&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axins2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="n">waves</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;\AA&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s">&#39;-.&#39;</span><span class="p">)</span>       
        <span class="k">if</span> <span class="s">&#39;NUV&#39;</span> <span class="ow">in</span> <span class="n">title</span><span class="p">:</span>
            <span class="n">axins2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">9.</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.2</span><span class="p">)</span>
            <span class="n">axins2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mf">100.</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mf">8.</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axins2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">13.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
            <span class="n">axins2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mf">30.</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mf">8.</span><span class="p">)</span>
       
        <span class="n">mark_inset</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">axins2</span><span class="p">,</span> <span class="n">loc1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">loc2</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s">&#39;none&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s">&#39;0.5&#39;</span><span class="p">)</span>  

        <span class="c">#axins2.set_xticks([100,])</span>
        <span class="c">#axins2.set_yticks([0,])</span>
        <span class="n">axins2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
        <span class="n">axins2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

        <span class="n">P</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>         
        </div>
<div class="viewcode-block" id="Plotting.AcqImageExposureTimes"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.AcqImageExposureTimes">[docs]</a>    <span class="k">def</span> <span class="nf">AcqImageExposureTimes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Fig. 7.3. in the COS IHB, version 1.0, page 72.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>      
          
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Target flux (erg cm$^{-2}$ sec$^{-1}$ \AA$^{-1}$)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;Exposure time (sec)&#39;</span><span class="p">)</span>        
        
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="mi">15</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="mi">17</span><span class="p">,</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">10</span><span class="p">)</span>
        
        <span class="c">#ax.xaxis.set_major_formatter(FormatStrFormatter(&#39;%5.0f&#39;))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%i</span><span class="s">&#39;</span><span class="p">))</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>        
        
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    </div>
<div class="viewcode-block" id="Plotting.SpatialProfileFUV"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.SpatialProfileFUV">[docs]</a>    <span class="k">def</span> <span class="nf">SpatialProfileFUV</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corrtag_data</span><span class="p">,</span> <span class="n">disp</span><span class="p">,</span> <span class="n">xvalues</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">extr</span><span class="p">,</span> <span class="n">ewidth</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>            
        <span class="k">def</span> <span class="nf">WfP</span><span class="p">(</span><span class="n">pix</span><span class="p">,</span> <span class="n">disp</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">disp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">pix</span><span class="o">*</span><span class="n">disp</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">pix</span><span class="o">*</span><span class="n">pix</span><span class="o">*</span><span class="n">disp</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="c">#manipulates arguments</span>
        <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span> <span class="o">=</span> <span class="n">xvalues</span>         
        <span class="n">ran</span> <span class="o">=</span> <span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
        <span class="n">wave1</span><span class="p">,</span> <span class="n">wave2</span><span class="p">,</span> <span class="n">wave3</span> <span class="o">=</span> <span class="n">WfP</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">disp</span><span class="p">),</span> <span class="n">WfP</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">disp</span><span class="p">),</span> <span class="n">WfP</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span> <span class="n">disp</span><span class="p">)</span>
        
        <span class="c">#gets the data from corrtag</span>
        <span class="n">xf</span> <span class="o">=</span> <span class="n">corrtag_data</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s">&#39;XFULL&#39;</span><span class="p">)</span>
        <span class="n">yf</span> <span class="o">=</span> <span class="n">corrtag_data</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s">&#39;YFULL&#39;</span><span class="p">)</span>
        
        <span class="c">#lets limit the places</span>
        <span class="n">lim1y</span> <span class="o">=</span> <span class="n">yf</span><span class="p">[(</span><span class="n">xf</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">width</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">xf</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">width</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">yf</span> <span class="o">&gt;=</span> <span class="n">ymin</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">yf</span> <span class="o">&lt;=</span> <span class="n">ymax</span><span class="p">)]</span>
        <span class="n">lim2y</span> <span class="o">=</span> <span class="n">yf</span><span class="p">[(</span><span class="n">xf</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">x2</span> <span class="o">+</span> <span class="n">width</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">xf</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">width</span><span class="p">))</span>  <span class="o">&amp;</span> <span class="p">(</span><span class="n">yf</span> <span class="o">&gt;=</span> <span class="n">ymin</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">yf</span> <span class="o">&lt;=</span> <span class="n">ymax</span><span class="p">)]</span>
        <span class="n">lim3y</span> <span class="o">=</span> <span class="n">yf</span><span class="p">[(</span><span class="n">xf</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">x3</span> <span class="o">+</span> <span class="n">width</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">xf</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">x3</span> <span class="o">-</span> <span class="n">width</span><span class="p">))</span>  <span class="o">&amp;</span> <span class="p">(</span><span class="n">yf</span> <span class="o">&gt;=</span> <span class="n">ymin</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">yf</span> <span class="o">&lt;=</span> <span class="n">ymax</span><span class="p">)]</span>
        
        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        
        <span class="n">n1</span><span class="p">,</span> <span class="n">bins1</span><span class="p">,</span> <span class="n">patches1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">lim1y</span><span class="p">,</span>
                                      <span class="n">bins</span> <span class="o">=</span> <span class="p">(</span><span class="n">ymax</span><span class="o">-</span><span class="n">ymin</span><span class="p">),</span>
                                      <span class="nb">range</span> <span class="o">=</span> <span class="n">ran</span><span class="p">,</span>
                                      <span class="n">normed</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
                                      <span class="n">histtype</span><span class="o">=</span><span class="s">&#39;step&#39;</span><span class="p">,</span>
                                      <span class="n">ec</span> <span class="o">=</span> <span class="s">&#39;b&#39;</span><span class="p">)</span>
        <span class="n">yr1</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">normpdf</span><span class="p">(</span><span class="n">bins1</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lim1y</span><span class="p">),</span> <span class="n">N</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">lim1y</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins1</span><span class="p">,</span> <span class="n">yr1</span><span class="p">,</span> <span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%i</span><span class="s"> \AA&#39;</span> <span class="o">%</span> <span class="n">wave1</span><span class="p">,</span> <span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>

        <span class="n">n2</span><span class="p">,</span> <span class="n">bins2</span><span class="p">,</span> <span class="n">patches2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">lim2y</span><span class="p">,</span>
                                      <span class="n">bins</span> <span class="o">=</span> <span class="p">(</span><span class="n">ymax</span><span class="o">-</span><span class="n">ymin</span><span class="p">),</span>
                                      <span class="nb">range</span> <span class="o">=</span> <span class="n">ran</span><span class="p">,</span>
                                      <span class="n">normed</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
                                      <span class="n">histtype</span><span class="o">=</span><span class="s">&#39;step&#39;</span><span class="p">,</span>
                                      <span class="n">ec</span> <span class="o">=</span> <span class="s">&#39;g&#39;</span><span class="p">)</span>
        <span class="n">yr2</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">normpdf</span><span class="p">(</span><span class="n">bins2</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lim2y</span><span class="p">),</span> <span class="n">N</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">lim2y</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins2</span><span class="p">,</span> <span class="n">yr2</span><span class="p">,</span> <span class="s">&#39;g-&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%i</span><span class="s"> \AA&#39;</span> <span class="o">%</span> <span class="n">wave2</span><span class="p">,</span> <span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
        
        <span class="n">n3</span><span class="p">,</span> <span class="n">bins3</span><span class="p">,</span> <span class="n">patches3</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">lim3y</span><span class="p">,</span>
                                      <span class="n">bins</span> <span class="o">=</span> <span class="p">(</span><span class="n">ymax</span><span class="o">-</span><span class="n">ymin</span><span class="p">),</span>
                                      <span class="nb">range</span> <span class="o">=</span> <span class="n">ran</span><span class="p">,</span>
                                      <span class="n">normed</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
                                      <span class="n">histtype</span><span class="o">=</span><span class="s">&#39;step&#39;</span><span class="p">,</span>
                                      <span class="n">ec</span> <span class="o">=</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">yr3</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">normpdf</span><span class="p">(</span><span class="n">bins3</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lim3y</span><span class="p">),</span> <span class="n">N</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">lim3y</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins3</span><span class="p">,</span> <span class="n">yr3</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%i</span><span class="s"> \AA&#39;</span> <span class="o">%</span> <span class="n">wave3</span><span class="p">,</span> <span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
        
        <span class="n">ylimmax</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">N</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span> <span class="n">N</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">n2</span><span class="p">),</span> <span class="n">N</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">n3</span><span class="p">)])</span>

        <span class="c">#extractions</span>
        <span class="n">l1</span> <span class="o">=</span> <span class="n">extr</span> <span class="o">-</span> <span class="p">(</span><span class="n">ewidth</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">l2</span> <span class="o">=</span> <span class="n">extr</span> <span class="o">+</span> <span class="p">(</span><span class="n">ewidth</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">l1</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">ylimmax</span><span class="o">*</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;y&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">l2</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">ylimmax</span><span class="o">*</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;y&#39;</span><span class="p">)</span><span class="c">#, label = &#39;Extraction Box&#39;)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">ylimmax</span><span class="o">*</span><span class="mf">1.05</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;y (pixels)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;Normalized flux&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>        
        
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    </div>
<div class="viewcode-block" id="Plotting.DispersedLightAcquisitionTimes"><a class="viewcode-back" href="../../../../SamPy.plot.COSIHB.html#SamPy.plot.COSIHB.plotting.Plotting.DispersedLightAcquisitionTimes">[docs]</a>    <span class="k">def</span> <span class="nf">DispersedLightAcquisitionTimes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">gratings</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Fig. 8.9 in COS IHB, version 2.0, draft 1</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">do</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Dispersed-light Acquisition Exposure Times&#39;</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">grating</span> <span class="ow">in</span> <span class="n">gratings</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">grating</span> <span class="o">==</span> <span class="s">&#39;G285M&#39;</span> <span class="ow">or</span> <span class="n">grating</span> <span class="o">==</span> <span class="s">&#39;G185M&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">do</span> <span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;grating&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">grating</span><span class="p">][</span><span class="s">&#39;flux&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;grating&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">grating</span><span class="p">][</span><span class="s">&#39;time&#39;</span><span class="p">],</span>
                            <span class="n">label</span> <span class="o">=</span> <span class="s">&#39;G185M \&amp; G285M&#39;</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">1.4</span><span class="p">)</span>
                <span class="n">do</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;grating&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">grating</span><span class="p">][</span><span class="s">&#39;flux&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;grating&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">grating</span><span class="p">][</span><span class="s">&#39;time&#39;</span><span class="p">],</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="n">grating</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">1.4</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>         
        
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Flux (erg cm$^{-2}$ sec$^{-1}$ \AA$^{-1}$)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;Exposure Time (sec)&#39;</span><span class="p">)</span>  
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="c">#ax.set_xlim()  </span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%i</span><span class="s">&#39;</span><span class="p">))</span>
            
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>        
        
        <span class="n">P</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>        
        </div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../../index.html">home</a>|&nbsp;</li>
        <li><a href="../../../../search.html">search</a>|&nbsp;</li>

          <li><a href="../../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Sami-Matias Niemi.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.5.
    </div>
  </body>
</html>