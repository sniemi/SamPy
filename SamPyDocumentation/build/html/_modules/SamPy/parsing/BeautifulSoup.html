

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>SamPy.parsing.BeautifulSoup &mdash; SamPy v0.1 documentation</title>
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="SamPy v0.1 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">home</a>|&nbsp;</li>
        <li><a href="../../../search.html">search</a>|&nbsp;</li>

          <li><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for SamPy.parsing.BeautifulSoup</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;Beautiful Soup</span>
<span class="sd">Elixir and Tonic</span>
<span class="sd">&quot;The Screen-Scraper&#39;s Friend&quot;</span>
<span class="sd">http://www.crummy.com/software/BeautifulSoup/</span>

<span class="sd">Beautiful Soup parses a (possibly invalid) XML or HTML document into a</span>
<span class="sd">tree representation. It provides methods and Pythonic idioms that make</span>
<span class="sd">it easy to navigate, search, and modify the tree.</span>

<span class="sd">A well-formed XML/HTML document yields a well-formed data</span>
<span class="sd">structure. An ill-formed XML/HTML document yields a correspondingly</span>
<span class="sd">ill-formed data structure. If your document is only locally</span>
<span class="sd">well-formed, you can use this library to find and process the</span>
<span class="sd">well-formed part of it.</span>

<span class="sd">Beautiful Soup works with Python 2.2 and up. It has no external</span>
<span class="sd">dependencies, but you&#39;ll have more success at converting data to UTF-8</span>
<span class="sd">if you also install these three packages:</span>

<span class="sd">* chardet, for auto-detecting character encodings</span>
<span class="sd">  http://chardet.feedparser.org/</span>
<span class="sd">* cjkcodecs and iconv_codec, which add more encodings to the ones supported</span>
<span class="sd">  by stock Python.</span>
<span class="sd">  http://cjkpython.i18n.org/</span>

<span class="sd">Beautiful Soup defines classes for two main parsing strategies:</span>

<span class="sd"> * BeautifulStoneSoup, for parsing XML, SGML, or your domain-specific</span>
<span class="sd">   language that kind of looks like XML.</span>

<span class="sd"> * BeautifulSoup, for parsing run-of-the-mill HTML code, be it valid</span>
<span class="sd">   or invalid. This class has web browser-like heuristics for</span>
<span class="sd">   obtaining a sensible parse tree in the face of common HTML errors.</span>

<span class="sd">Beautiful Soup also defines a class (UnicodeDammit) for autodetecting</span>
<span class="sd">the encoding of an HTML or XML document, and converting it to</span>
<span class="sd">Unicode. Much of this code is taken from Mark Pilgrim&#39;s Universal Feed Parser.</span>

<span class="sd">For more than you ever wanted to know about Beautiful Soup, see the</span>
<span class="sd">documentation:</span>
<span class="sd">http://www.crummy.com/software/BeautifulSoup/documentation.html</span>

<span class="sd">Here, have some legalese:</span>

<span class="sd">Copyright (c) 2004-2009, Leonard Richardson</span>

<span class="sd">All rights reserved.</span>

<span class="sd">Redistribution and use in source and binary forms, with or without</span>
<span class="sd">modification, are permitted provided that the following conditions are</span>
<span class="sd">met:</span>

<span class="sd">  * Redistributions of source code must retain the above copyright</span>
<span class="sd">    notice, this list of conditions and the following disclaimer.</span>

<span class="sd">  * Redistributions in binary form must reproduce the above</span>
<span class="sd">    copyright notice, this list of conditions and the following</span>
<span class="sd">    disclaimer in the documentation and/or other materials provided</span>
<span class="sd">    with the distribution.</span>

<span class="sd">  * Neither the name of the the Beautiful Soup Consortium and All</span>
<span class="sd">    Night Kosher Bakery nor the names of its contributors may be</span>
<span class="sd">    used to endorse or promote products derived from this software</span>
<span class="sd">    without specific prior written permission.</span>

<span class="sd">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<span class="sd">&quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<span class="sd">LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<span class="sd">A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR</span>
<span class="sd">CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,</span>
<span class="sd">EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,</span>
<span class="sd">PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR</span>
<span class="sd">PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF</span>
<span class="sd">LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING</span>
<span class="sd">NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS</span>
<span class="sd">SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE, DAMMIT.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">generators</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s">&quot;Leonard Richardson (leonardr@segfault.org)&quot;</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s">&quot;3.1.0.1&quot;</span>
<span class="n">__copyright__</span> <span class="o">=</span> <span class="s">&quot;Copyright (c) 2004-2009 Leonard Richardson&quot;</span>
<span class="n">__license__</span> <span class="o">=</span> <span class="s">&quot;New-style BSD&quot;</span>

<span class="kn">import</span> <span class="nn">codecs</span>
<span class="kn">import</span> <span class="nn">markupbase</span>
<span class="kn">import</span> <span class="nn">types</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">HTMLParser</span> <span class="kn">import</span> <span class="n">HTMLParser</span><span class="p">,</span> <span class="n">HTMLParseError</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">htmlentitydefs</span> <span class="kn">import</span> <span class="n">name2codepoint</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">name2codepoint</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">try</span><span class="p">:</span>
    <span class="nb">set</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">sets</span> <span class="kn">import</span> <span class="n">Set</span> <span class="k">as</span> <span class="nb">set</span>

<span class="c">#These hacks make Beautiful Soup able to parse XML with namespaces</span>
<span class="n">markupbase</span><span class="o">.</span><span class="n">_declname_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&#39;[a-zA-Z][-_.:a-zA-Z0-9]*\s*&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">match</span>

<span class="n">DEFAULT_OUTPUT_ENCODING</span> <span class="o">=</span> <span class="s">&quot;utf-8&quot;</span>

<span class="c"># First, the classes that represent markup elements.</span>

<div class="viewcode-block" id="sob"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.sob">[docs]</a><span class="k">def</span> <span class="nf">sob</span><span class="p">(</span><span class="nb">unicode</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns either the given Unicode string or its encoding.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">unicode</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">unicode</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PageElement"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement">[docs]</a><span class="k">class</span> <span class="nc">PageElement</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Contains the navigational information for some part of the page</span>
<span class="sd">    (either a tag or a piece of text)&quot;&quot;&quot;</span>

<div class="viewcode-block" id="PageElement.setup"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.setup">[docs]</a>    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets up the initial relations between this element and</span>
<span class="sd">        other elements.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">previous</span> <span class="o">=</span> <span class="n">previous</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">previousSibling</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nextSibling</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">contents</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">previousSibling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">previousSibling</span><span class="o">.</span><span class="n">nextSibling</span> <span class="o">=</span> <span class="bp">self</span>
</div>
<div class="viewcode-block" id="PageElement.replaceWith"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.replaceWith">[docs]</a>    <span class="k">def</span> <span class="nf">replaceWith</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">replaceWith</span><span class="p">):</span>
        <span class="n">oldParent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>
        <span class="n">myIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">replaceWith</span><span class="p">,</span> <span class="s">&#39;parent&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">replaceWith</span><span class="o">.</span><span class="n">parent</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
            <span class="c"># We&#39;re replacing this element with one of its siblings.</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">replaceWith</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">index</span> <span class="ow">and</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">myIndex</span><span class="p">:</span>
                <span class="c"># Furthermore, it comes before this element. That</span>
                <span class="c"># means that when we extract it, the index of this</span>
                <span class="c"># element will change.</span>
                <span class="n">myIndex</span> <span class="o">=</span> <span class="n">myIndex</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extract</span><span class="p">()</span>
        <span class="n">oldParent</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">myIndex</span><span class="p">,</span> <span class="n">replaceWith</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PageElement.extract"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.extract">[docs]</a>    <span class="k">def</span> <span class="nf">extract</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Destructively rips this element out of the tree.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="c">#Find the two elements that would be next to each other if</span>
        <span class="c">#this element (and any children) hadn&#39;t been parsed. Connect</span>
        <span class="c">#the two.</span>
        <span class="n">lastChild</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lastRecursiveChild</span><span class="p">()</span>
        <span class="n">nextElement</span> <span class="o">=</span> <span class="n">lastChild</span><span class="o">.</span><span class="n">next</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="n">nextElement</span>
        <span class="k">if</span> <span class="n">nextElement</span><span class="p">:</span>
            <span class="n">nextElement</span><span class="o">.</span><span class="n">previous</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">previous</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">lastChild</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">previousSibling</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">previousSibling</span><span class="o">.</span><span class="n">nextSibling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nextSibling</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nextSibling</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nextSibling</span><span class="o">.</span><span class="n">previousSibling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">previousSibling</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">previousSibling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nextSibling</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="bp">self</span>
</div>
    <span class="k">def</span> <span class="nf">_lastRecursiveChild</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Finds the last element beneath this object to be parsed.&quot;</span>
        <span class="n">lastChild</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">while</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">lastChild</span><span class="p">,</span> <span class="s">&#39;contents&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">lastChild</span><span class="o">.</span><span class="n">contents</span><span class="p">:</span>
            <span class="n">lastChild</span> <span class="o">=</span> <span class="n">lastChild</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">lastChild</span>

<div class="viewcode-block" id="PageElement.insert"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.insert">[docs]</a>    <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">newChild</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">newChild</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">)</span>
            <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">newChild</span><span class="p">,</span> <span class="nb">unicode</span><span class="p">))</span> \
            <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">newChild</span><span class="p">,</span> <span class="n">NavigableString</span><span class="p">):</span>
            <span class="n">newChild</span> <span class="o">=</span> <span class="n">NavigableString</span><span class="p">(</span><span class="n">newChild</span><span class="p">)</span>

        <span class="n">position</span> <span class="o">=</span>  <span class="nb">min</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">newChild</span><span class="p">,</span> <span class="s">&#39;parent&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">newChild</span><span class="o">.</span><span class="n">parent</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c"># We&#39;re &#39;inserting&#39; an element that&#39;s already one</span>
            <span class="c"># of this object&#39;s children.</span>
            <span class="k">if</span> <span class="n">newChild</span><span class="o">.</span><span class="n">parent</span> <span class="o">==</span> <span class="bp">self</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">newChild</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">index</span> <span class="ow">and</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">position</span><span class="p">:</span>
                    <span class="c"># Furthermore we&#39;re moving it further down the</span>
                    <span class="c"># list of this object&#39;s children. That means that</span>
                    <span class="c"># when we extract this element, our target index</span>
                    <span class="c"># will jump down one.</span>
                    <span class="n">position</span> <span class="o">=</span> <span class="n">position</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">newChild</span><span class="o">.</span><span class="n">extract</span><span class="p">()</span>

        <span class="n">newChild</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">previousChild</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">position</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">newChild</span><span class="o">.</span><span class="n">previousSibling</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">newChild</span><span class="o">.</span><span class="n">previous</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">previousChild</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">position</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">newChild</span><span class="o">.</span><span class="n">previousSibling</span> <span class="o">=</span> <span class="n">previousChild</span>
            <span class="n">newChild</span><span class="o">.</span><span class="n">previousSibling</span><span class="o">.</span><span class="n">nextSibling</span> <span class="o">=</span> <span class="n">newChild</span>
            <span class="n">newChild</span><span class="o">.</span><span class="n">previous</span> <span class="o">=</span> <span class="n">previousChild</span><span class="o">.</span><span class="n">_lastRecursiveChild</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">newChild</span><span class="o">.</span><span class="n">previous</span><span class="p">:</span>
            <span class="n">newChild</span><span class="o">.</span><span class="n">previous</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="n">newChild</span>

        <span class="n">newChildsLastElement</span> <span class="o">=</span> <span class="n">newChild</span><span class="o">.</span><span class="n">_lastRecursiveChild</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">position</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">):</span>
            <span class="n">newChild</span><span class="o">.</span><span class="n">nextSibling</span> <span class="o">=</span> <span class="bp">None</span>

            <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="n">parentsNextSibling</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">while</span> <span class="ow">not</span> <span class="n">parentsNextSibling</span><span class="p">:</span>
                <span class="n">parentsNextSibling</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">nextSibling</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">parent</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">parent</span><span class="p">:</span> <span class="c"># This is the last element in the document.</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">parentsNextSibling</span><span class="p">:</span>
                <span class="n">newChildsLastElement</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="n">parentsNextSibling</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">newChildsLastElement</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nextChild</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">position</span><span class="p">]</span>
            <span class="n">newChild</span><span class="o">.</span><span class="n">nextSibling</span> <span class="o">=</span> <span class="n">nextChild</span>
            <span class="k">if</span> <span class="n">newChild</span><span class="o">.</span><span class="n">nextSibling</span><span class="p">:</span>
                <span class="n">newChild</span><span class="o">.</span><span class="n">nextSibling</span><span class="o">.</span><span class="n">previousSibling</span> <span class="o">=</span> <span class="n">newChild</span>
            <span class="n">newChildsLastElement</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="n">nextChild</span>

        <span class="k">if</span> <span class="n">newChildsLastElement</span><span class="o">.</span><span class="n">next</span><span class="p">:</span>
            <span class="n">newChildsLastElement</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">previous</span> <span class="o">=</span> <span class="n">newChildsLastElement</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">newChild</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PageElement.append"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.append">[docs]</a>    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Appends the given tag to the contents of this tag.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">),</span> <span class="n">tag</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PageElement.findNext"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.findNext">[docs]</a>    <span class="k">def</span> <span class="nf">findNext</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{},</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the first item that matches the given criteria and</span>
<span class="sd">        appears after this Tag in the document.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_findOne</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">findAllNext</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PageElement.findAllNext"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.findAllNext">[docs]</a>    <span class="k">def</span> <span class="nf">findAllNext</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{},</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns all items that match the given criteria and appear</span>
<span class="sd">        after this Tag in the document.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_findAll</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nextGenerator</span><span class="p">,</span>
                             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PageElement.findNextSibling"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.findNextSibling">[docs]</a>    <span class="k">def</span> <span class="nf">findNextSibling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{},</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the closest sibling to this Tag that matches the</span>
<span class="sd">        given criteria and appears after this Tag in the document.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_findOne</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">findNextSiblings</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span>
                             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PageElement.findNextSiblings"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.findNextSiblings">[docs]</a>    <span class="k">def</span> <span class="nf">findNextSiblings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{},</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                         <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the siblings of this Tag that match the given</span>
<span class="sd">        criteria and appear after this Tag in the document.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_findAll</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">nextSiblingGenerator</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
    <span class="n">fetchNextSiblings</span> <span class="o">=</span> <span class="n">findNextSiblings</span> <span class="c"># Compatibility with pre-3.x</span>

<div class="viewcode-block" id="PageElement.findPrevious"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.findPrevious">[docs]</a>    <span class="k">def</span> <span class="nf">findPrevious</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{},</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the first item that matches the given criteria and</span>
<span class="sd">        appears before this Tag in the document.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_findOne</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">findAllPrevious</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PageElement.findAllPrevious"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.findAllPrevious">[docs]</a>    <span class="k">def</span> <span class="nf">findAllPrevious</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{},</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns all items that match the given criteria and appear</span>
<span class="sd">        before this Tag in the document.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_findAll</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">previousGenerator</span><span class="p">,</span>
                           <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
    <span class="n">fetchPrevious</span> <span class="o">=</span> <span class="n">findAllPrevious</span> <span class="c"># Compatibility with pre-3.x</span>

<div class="viewcode-block" id="PageElement.findPreviousSibling"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.findPreviousSibling">[docs]</a>    <span class="k">def</span> <span class="nf">findPreviousSibling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{},</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the closest sibling to this Tag that matches the</span>
<span class="sd">        given criteria and appears before this Tag in the document.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_findOne</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">findPreviousSiblings</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span>
                             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PageElement.findPreviousSiblings"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.findPreviousSiblings">[docs]</a>    <span class="k">def</span> <span class="nf">findPreviousSiblings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{},</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                             <span class="n">limit</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the siblings of this Tag that match the given</span>
<span class="sd">        criteria and appear before this Tag in the document.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_findAll</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">previousSiblingGenerator</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
    <span class="n">fetchPreviousSiblings</span> <span class="o">=</span> <span class="n">findPreviousSiblings</span> <span class="c"># Compatibility with pre-3.x</span>

<div class="viewcode-block" id="PageElement.findParent"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.findParent">[docs]</a>    <span class="k">def</span> <span class="nf">findParent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the closest parent of this Tag that matches the given</span>
<span class="sd">        criteria.&quot;&quot;&quot;</span>
        <span class="c"># NOTE: We can&#39;t use _findOne because findParents takes a different</span>
        <span class="c"># set of arguments.</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findParents</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">l</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">r</span>
</div>
<div class="viewcode-block" id="PageElement.findParents"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.findParents">[docs]</a>    <span class="k">def</span> <span class="nf">findParents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{},</span> <span class="n">limit</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the parents of this Tag that match the given</span>
<span class="sd">        criteria.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_findAll</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentGenerator</span><span class="p">,</span>
                             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
    <span class="n">fetchParents</span> <span class="o">=</span> <span class="n">findParents</span> <span class="c"># Compatibility with pre-3.x</span>

    <span class="c">#These methods do the real heavy lifting.</span>

    <span class="k">def</span> <span class="nf">_findOne</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">l</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">r</span>

    <span class="k">def</span> <span class="nf">_findAll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">generator</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="s">&quot;Iterates over a generator looking for things that match.&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">SoupStrainer</span><span class="p">):</span>
            <span class="n">strainer</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Build a SoupStrainer</span>
            <span class="n">strainer</span> <span class="o">=</span> <span class="n">SoupStrainer</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">ResultSet</span><span class="p">(</span><span class="n">strainer</span><span class="p">)</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">generator</span><span class="p">()</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">i</span><span class="p">:</span>
                <span class="n">found</span> <span class="o">=</span> <span class="n">strainer</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
                    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">found</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">limit</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">limit</span><span class="p">:</span>
                        <span class="k">break</span>
        <span class="k">return</span> <span class="n">results</span>

    <span class="c">#These Generators can be used to navigate starting from both</span>
    <span class="c">#NavigableStrings and Tags.</span>
<div class="viewcode-block" id="PageElement.nextGenerator"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.nextGenerator">[docs]</a>    <span class="k">def</span> <span class="nf">nextGenerator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">while</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">next</span>
            <span class="k">yield</span> <span class="n">i</span>
</div>
<div class="viewcode-block" id="PageElement.nextSiblingGenerator"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.nextSiblingGenerator">[docs]</a>    <span class="k">def</span> <span class="nf">nextSiblingGenerator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">while</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">nextSibling</span>
            <span class="k">yield</span> <span class="n">i</span>
</div>
<div class="viewcode-block" id="PageElement.previousGenerator"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.previousGenerator">[docs]</a>    <span class="k">def</span> <span class="nf">previousGenerator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">while</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">previous</span>
            <span class="k">yield</span> <span class="n">i</span>
</div>
<div class="viewcode-block" id="PageElement.previousSiblingGenerator"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.previousSiblingGenerator">[docs]</a>    <span class="k">def</span> <span class="nf">previousSiblingGenerator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">while</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">previousSibling</span>
            <span class="k">yield</span> <span class="n">i</span>
</div>
<div class="viewcode-block" id="PageElement.parentGenerator"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.parentGenerator">[docs]</a>    <span class="k">def</span> <span class="nf">parentGenerator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">while</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">parent</span>
            <span class="k">yield</span> <span class="n">i</span>

    <span class="c"># Utility methods</span></div>
<div class="viewcode-block" id="PageElement.substituteEncoding"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.substituteEncoding">[docs]</a>    <span class="k">def</span> <span class="nf">substituteEncoding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span> <span class="ow">or</span> <span class="s">&quot;utf-8&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;%SOUP-ENCODING%&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PageElement.toEncoding"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.PageElement.toEncoding">[docs]</a>    <span class="k">def</span> <span class="nf">toEncoding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Encodes an object to a string in some encoding, or to Unicode.</span>
<span class="sd">        .&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">unicode</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">encoding</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">encoding</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">encoding</span><span class="p">:</span>
                <span class="n">s</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">toEncoding</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">encoding</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">s</span>
</div></div>
<div class="viewcode-block" id="NavigableString"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.NavigableString">[docs]</a><span class="k">class</span> <span class="nc">NavigableString</span><span class="p">(</span><span class="nb">unicode</span><span class="p">,</span> <span class="n">PageElement</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new NavigableString.</span>

<span class="sd">        When unpickling a NavigableString, this method is called with</span>
<span class="sd">        the string in DEFAULT_OUTPUT_ENCODING. That encoding needs to be</span>
<span class="sd">        passed in to the superclass&#39;s __new__ or the superclass won&#39;t know</span>
<span class="sd">        how to handle non-ASCII characters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">unicode</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">unicode</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">unicode</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">DEFAULT_OUTPUT_ENCODING</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">unicode</span><span class="p">(</span><span class="bp">self</span><span class="p">),)</span>

    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;text.string gives you text. This is for backwards</span>
<span class="sd">        compatibility for Navigable*String, but for CData* it lets you</span>
<span class="sd">        get the string without the CData wrapper.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="s">&#39;string&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">,</span> <span class="s">&quot;&#39;</span><span class="si">%s</span><span class="s">&#39; object has no attribute &#39;</span><span class="si">%s</span><span class="s">&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>

<div class="viewcode-block" id="NavigableString.encode"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.NavigableString.encode">[docs]</a>    <span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">DEFAULT_OUTPUT_ENCODING</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="NavigableString.decodeGivenEventualEncoding"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.NavigableString.decodeGivenEventualEncoding">[docs]</a>    <span class="k">def</span> <span class="nf">decodeGivenEventualEncoding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eventualEncoding</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>
</div></div>
<div class="viewcode-block" id="CData"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.CData">[docs]</a><span class="k">class</span> <span class="nc">CData</span><span class="p">(</span><span class="n">NavigableString</span><span class="p">):</span>

<div class="viewcode-block" id="CData.decodeGivenEventualEncoding"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.CData.decodeGivenEventualEncoding">[docs]</a>    <span class="k">def</span> <span class="nf">decodeGivenEventualEncoding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eventualEncoding</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">u&#39;&lt;![CDATA[&#39;</span> <span class="o">+</span> <span class="bp">self</span> <span class="o">+</span> <span class="s">u&#39;]]&gt;&#39;</span>
</div></div>
<div class="viewcode-block" id="ProcessingInstruction"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.ProcessingInstruction">[docs]</a><span class="k">class</span> <span class="nc">ProcessingInstruction</span><span class="p">(</span><span class="n">NavigableString</span><span class="p">):</span>

<div class="viewcode-block" id="ProcessingInstruction.decodeGivenEventualEncoding"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.ProcessingInstruction.decodeGivenEventualEncoding">[docs]</a>    <span class="k">def</span> <span class="nf">decodeGivenEventualEncoding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eventualEncoding</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">if</span> <span class="s">u&#39;%SOUP-ENCODING%&#39;</span> <span class="ow">in</span> <span class="n">output</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substituteEncoding</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">eventualEncoding</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">u&#39;&lt;?&#39;</span> <span class="o">+</span> <span class="n">output</span> <span class="o">+</span> <span class="s">u&#39;?&gt;&#39;</span>
</div></div>
<div class="viewcode-block" id="Comment"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.Comment">[docs]</a><span class="k">class</span> <span class="nc">Comment</span><span class="p">(</span><span class="n">NavigableString</span><span class="p">):</span>
<div class="viewcode-block" id="Comment.decodeGivenEventualEncoding"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.Comment.decodeGivenEventualEncoding">[docs]</a>    <span class="k">def</span> <span class="nf">decodeGivenEventualEncoding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eventualEncoding</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">u&#39;&lt;!--&#39;</span> <span class="o">+</span> <span class="bp">self</span> <span class="o">+</span> <span class="s">u&#39;--&gt;&#39;</span>
</div></div>
<div class="viewcode-block" id="Declaration"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.Declaration">[docs]</a><span class="k">class</span> <span class="nc">Declaration</span><span class="p">(</span><span class="n">NavigableString</span><span class="p">):</span>
<div class="viewcode-block" id="Declaration.decodeGivenEventualEncoding"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.Declaration.decodeGivenEventualEncoding">[docs]</a>    <span class="k">def</span> <span class="nf">decodeGivenEventualEncoding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eventualEncoding</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">u&#39;&lt;!&#39;</span> <span class="o">+</span> <span class="bp">self</span> <span class="o">+</span> <span class="s">u&#39;&gt;&#39;</span>
</div></div>
<div class="viewcode-block" id="Tag"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.Tag">[docs]</a><span class="k">class</span> <span class="nc">Tag</span><span class="p">(</span><span class="n">PageElement</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a found HTML tag with its attributes and contents.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_invert</span><span class="p">(</span><span class="n">h</span><span class="p">):</span>
        <span class="s">&quot;Cheap function to invert a hash.&quot;</span>
        <span class="n">i</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">h</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">i</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>
        <span class="k">return</span> <span class="n">i</span>

    <span class="n">XML_ENTITIES_TO_SPECIAL_CHARS</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;apos&quot;</span> <span class="p">:</span> <span class="s">&quot;&#39;&quot;</span><span class="p">,</span>
                                      <span class="s">&quot;quot&quot;</span> <span class="p">:</span> <span class="s">&#39;&quot;&#39;</span><span class="p">,</span>
                                      <span class="s">&quot;amp&quot;</span> <span class="p">:</span> <span class="s">&quot;&amp;&quot;</span><span class="p">,</span>
                                      <span class="s">&quot;lt&quot;</span> <span class="p">:</span> <span class="s">&quot;&lt;&quot;</span><span class="p">,</span>
                                      <span class="s">&quot;gt&quot;</span> <span class="p">:</span> <span class="s">&quot;&gt;&quot;</span> <span class="p">}</span>

    <span class="n">XML_SPECIAL_CHARS_TO_ENTITIES</span> <span class="o">=</span> <span class="n">_invert</span><span class="p">(</span><span class="n">XML_ENTITIES_TO_SPECIAL_CHARS</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_convertEntities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">match</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Used in a call to re.sub to replace HTML, XML, and numeric</span>
<span class="sd">        entities with the appropriate Unicode characters. If HTML</span>
<span class="sd">        entities are being converted, any unrecognized entities are</span>
<span class="sd">        escaped.&quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">convertHTMLEntities</span> <span class="ow">and</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">name2codepoint</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">unichr</span><span class="p">(</span><span class="n">name2codepoint</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">XML_ENTITIES_TO_SPECIAL_CHARS</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">convertXMLEntities</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">XML_ENTITIES_TO_SPECIAL_CHARS</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s">u&#39;&amp;</span><span class="si">%s</span><span class="s">;&#39;</span> <span class="o">%</span> <span class="n">x</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;#&#39;</span><span class="p">:</span>
            <span class="c"># Handle numeric entities</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;x&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">unichr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">:],</span> <span class="mi">16</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">unichr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">escapeUnrecognizedEntities</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">u&#39;&amp;amp;</span><span class="si">%s</span><span class="s">;&#39;</span> <span class="o">%</span> <span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">u&#39;&amp;</span><span class="si">%s</span><span class="s">;&#39;</span> <span class="o">%</span> <span class="n">x</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">previous</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="s">&quot;Basic constructor.&quot;</span>

        <span class="c"># We don&#39;t actually store the parser object: that lets extracted</span>
        <span class="c"># chunks be garbage-collected</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parserClass</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">__class__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">isSelfClosing</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">isSelfClosingTag</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">if</span> <span class="n">attrs</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">attrs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">attrs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">contents</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">previous</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hidden</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">containsSubstitutions</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convertHTMLEntities</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">convertHTMLEntities</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convertXMLEntities</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">convertXMLEntities</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">escapeUnrecognizedEntities</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">escapeUnrecognizedEntities</span>

        <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="n">kval</span><span class="p">):</span>
            <span class="s">&quot;Converts HTML, XML and numeric entities in the attribute value.&quot;</span>
            <span class="n">k</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">kval</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">kval</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&quot;&amp;(#\d+|#x[0-9a-fA-F]+|\w+);&quot;</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">_convertEntities</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">convert</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>

<div class="viewcode-block" id="Tag.get"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.Tag.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the value of the &#39;key&#39; attribute for the tag, or</span>
<span class="sd">        the value given for &#39;default&#39; if it doesn&#39;t have that</span>
<span class="sd">        attribute.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrMap</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tag.has_key"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.Tag.has_key">[docs]</a>    <span class="k">def</span> <span class="nf">has_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrMap</span><span class="p">()</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;tag[key] returns the value of the &#39;key&#39; attribute for the tag,</span>
<span class="sd">        and throws an exception if it&#39;s not there.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrMap</span><span class="p">()[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Iterating over a tag iterates over its contents.&quot;</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;The length of a tag is the length of its list of contents.&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">contents</span>

    <span class="k">def</span> <span class="nf">__nonzero__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;A tag is non-None even if it has no contents.&quot;</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Setting tag[key] sets the value of the &#39;key&#39; attribute for the</span>
<span class="sd">        tag.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrMap</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attrMap</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">found</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">)):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">key</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="n">found</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrMap</span><span class="p">()[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="s">&quot;Deleting tag[key] deletes all &#39;key&#39; attributes for the tag.&quot;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">key</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="c">#We don&#39;t break because bad HTML can define the same</span>
                <span class="c">#attribute multiple times.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrMap</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrMap</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrMap</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calling a tag like a function is the same as calling its</span>
<span class="sd">        findAll() method. Eg. tag(&#39;a&#39;) returns a list of all the A tags</span>
<span class="sd">        found within this tag.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">findAll</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">):</span>
        <span class="c">#print &quot;Getattr %s.%s&quot; % (self.__class__, tag)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">tag</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s">&#39;Tag&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">tag</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">tag</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;__&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">,</span> <span class="s">&quot;&#39;</span><span class="si">%s</span><span class="s">&#39; object has no attribute &#39;</span><span class="si">%s</span><span class="s">&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns true iff this tag has the same name, the same attributes,</span>
<span class="sd">        and the same contents (recursively) as the given tag.</span>

<span class="sd">        NOTE: right now this will return false if two tags have the</span>
<span class="sd">        same attributes in a different order. Should this be fixed?&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s">&#39;attrs&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s">&#39;contents&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">attrs</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">)):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns true iff this tag is not identical to the other tag,</span>
<span class="sd">        as defined in __eq__.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">other</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">DEFAULT_OUTPUT_ENCODING</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Renders this tag as a string.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">eventualEncoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span>

    <span class="n">BARE_AMPERSAND_OR_BRACKET</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&quot;([&lt;&gt;]|&quot;</span>
                                           <span class="o">+</span> <span class="s">&quot;&amp;(?!#\d+;|#x[0-9a-fA-F]+;|\w+;)&quot;</span>
                                           <span class="o">+</span> <span class="s">&quot;)&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_sub_entity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Used with a regular expression to substitute the</span>
<span class="sd">        appropriate XML entity for an XML special character.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s">&quot;&amp;&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">XML_SPECIAL_CHARS_TO_ENTITIES</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="s">&quot;;&quot;</span>

    <span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>

<div class="viewcode-block" id="Tag.encode"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.Tag.encode">[docs]</a>    <span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">DEFAULT_OUTPUT_ENCODING</span><span class="p">,</span>
               <span class="n">prettyPrint</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">indentLevel</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">prettyPrint</span><span class="p">,</span> <span class="n">indentLevel</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tag.decode"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.Tag.decode">[docs]</a>    <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prettyPrint</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">indentLevel</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
               <span class="n">eventualEncoding</span><span class="o">=</span><span class="n">DEFAULT_OUTPUT_ENCODING</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a string or Unicode representation of this tag and</span>
<span class="sd">        its contents. To get Unicode, pass None for encoding.&quot;&quot;&quot;</span>

        <span class="n">attrs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
                <span class="n">fmt</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">=&quot;</span><span class="si">%s</span><span class="s">&quot;&#39;</span>
                <span class="k">if</span> <span class="n">isString</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">containsSubstitutions</span>
                        <span class="ow">and</span> <span class="n">eventualEncoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
                        <span class="ow">and</span> <span class="s">&#39;%SOUP-ENCODING%&#39;</span> <span class="ow">in</span> <span class="n">val</span><span class="p">):</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substituteEncoding</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">eventualEncoding</span><span class="p">)</span>

                    <span class="c"># The attribute value either:</span>
                    <span class="c">#</span>
                    <span class="c"># * Contains no embedded double quotes or single quotes.</span>
                    <span class="c">#   No problem: we enclose it in double quotes.</span>
                    <span class="c"># * Contains embedded single quotes. No problem:</span>
                    <span class="c">#   double quotes work here too.</span>
                    <span class="c"># * Contains embedded double quotes. No problem:</span>
                    <span class="c">#   we enclose it in single quotes.</span>
                    <span class="c"># * Embeds both single _and_ double quotes. This</span>
                    <span class="c">#   can&#39;t happen naturally, but it can happen if</span>
                    <span class="c">#   you modify an attribute value after parsing</span>
                    <span class="c">#   the document. Now we have a bit of a</span>
                    <span class="c">#   problem. We solve it by enclosing the</span>
                    <span class="c">#   attribute in single quotes, and escaping any</span>
                    <span class="c">#   embedded single quotes to XML entities.</span>
                    <span class="k">if</span> <span class="s">&#39;&quot;&#39;</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                        <span class="n">fmt</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">=&#39;</span><span class="si">%s</span><span class="s">&#39;&quot;</span>
                        <span class="k">if</span> <span class="s">&quot;&#39;&quot;</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                            <span class="c"># TODO: replace with apos when</span>
                            <span class="c"># appropriate.</span>
                            <span class="n">val</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;&amp;squot;&quot;</span><span class="p">)</span>

                    <span class="c"># Now we&#39;re okay w/r/t quotes. But the attribute</span>
                    <span class="c"># value might also contain angle brackets, or</span>
                    <span class="c"># ampersands that aren&#39;t part of entities. We need</span>
                    <span class="c"># to escape those to XML entities too.</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BARE_AMPERSAND_OR_BRACKET</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sub_entity</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="c"># Handle boolean attributes.</span>
                    <span class="n">decoded</span> <span class="o">=</span> <span class="n">key</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">decoded</span> <span class="o">=</span> <span class="n">fmt</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
                <span class="n">attrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decoded</span><span class="p">)</span>
        <span class="n">close</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="n">closeTag</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isSelfClosing</span><span class="p">:</span>
            <span class="n">close</span> <span class="o">=</span> <span class="s">&#39; /&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">closeTag</span> <span class="o">=</span> <span class="s">&#39;&lt;/</span><span class="si">%s</span><span class="s">&gt;&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

        <span class="n">indentTag</span><span class="p">,</span> <span class="n">indentContents</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">prettyPrint</span><span class="p">:</span>
            <span class="n">indentTag</span> <span class="o">=</span> <span class="n">indentLevel</span>
            <span class="n">space</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="n">indentTag</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">indentContents</span> <span class="o">=</span> <span class="n">indentTag</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">contents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decodeContents</span><span class="p">(</span><span class="n">prettyPrint</span><span class="p">,</span> <span class="n">indentContents</span><span class="p">,</span>
                                       <span class="n">eventualEncoding</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">contents</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">attributeString</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
            <span class="k">if</span> <span class="n">attrs</span><span class="p">:</span>
                <span class="n">attributeString</span> <span class="o">=</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">attrs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">prettyPrint</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">space</span><span class="p">)</span>
            <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;&lt;</span><span class="si">%s%s%s</span><span class="s">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">attributeString</span><span class="p">,</span> <span class="n">close</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">prettyPrint</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">prettyPrint</span> <span class="ow">and</span> <span class="n">contents</span> <span class="ow">and</span> <span class="n">contents</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">prettyPrint</span> <span class="ow">and</span> <span class="n">closeTag</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">space</span><span class="p">)</span>
            <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">closeTag</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">prettyPrint</span> <span class="ow">and</span> <span class="n">closeTag</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">nextSibling</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">s</span>
</div>
<div class="viewcode-block" id="Tag.decompose"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.Tag.decompose">[docs]</a>    <span class="k">def</span> <span class="nf">decompose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Recursively destroys the contents of this tree.&quot;&quot;&quot;</span>
        <span class="n">contents</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">contents</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Tag</span><span class="p">):</span>
                <span class="n">i</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span><span class="o">.</span><span class="n">extract</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extract</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tag.prettify"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.Tag.prettify">[docs]</a>    <span class="k">def</span> <span class="nf">prettify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">DEFAULT_OUTPUT_ENCODING</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tag.encodeContents"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.Tag.encodeContents">[docs]</a>    <span class="k">def</span> <span class="nf">encodeContents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">DEFAULT_OUTPUT_ENCODING</span><span class="p">,</span>
                       <span class="n">prettyPrint</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">indentLevel</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">decodeContents</span><span class="p">(</span><span class="n">prettyPrint</span><span class="p">,</span> <span class="n">indentLevel</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tag.decodeContents"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.Tag.decodeContents">[docs]</a>    <span class="k">def</span> <span class="nf">decodeContents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prettyPrint</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">indentLevel</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                       <span class="n">eventualEncoding</span><span class="o">=</span><span class="n">DEFAULT_OUTPUT_ENCODING</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Renders the contents of this tag as a string in the given</span>
<span class="sd">        encoding. If encoding is None, returns a Unicode string..&quot;&quot;&quot;</span>
        <span class="n">s</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">NavigableString</span><span class="p">):</span>
                <span class="n">text</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">decodeGivenEventualEncoding</span><span class="p">(</span><span class="n">eventualEncoding</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Tag</span><span class="p">):</span>
                <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">prettyPrint</span><span class="p">,</span> <span class="n">indentLevel</span><span class="p">,</span> <span class="n">eventualEncoding</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">text</span> <span class="ow">and</span> <span class="n">prettyPrint</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">text</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">prettyPrint</span><span class="p">:</span>
                    <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">*</span> <span class="p">(</span><span class="n">indentLevel</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
                <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">prettyPrint</span><span class="p">:</span>
                    <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="c">#Soup methods</span>
</div>
<div class="viewcode-block" id="Tag.find"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.Tag.find">[docs]</a>    <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{},</span> <span class="n">recursive</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return only the first child of this Tag matching the given</span>
<span class="sd">        criteria.&quot;&quot;&quot;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">recursive</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">l</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">r</span></div>
    <span class="n">findChild</span> <span class="o">=</span> <span class="n">find</span>

<div class="viewcode-block" id="Tag.findAll"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.Tag.findAll">[docs]</a>    <span class="k">def</span> <span class="nf">findAll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{},</span> <span class="n">recursive</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">limit</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Extracts a list of Tag objects that match the given</span>
<span class="sd">        criteria.  You can specify the name of the Tag and any</span>
<span class="sd">        attributes you want the Tag to have.</span>

<span class="sd">        The value of a key-value pair in the &#39;attrs&#39; map can be a</span>
<span class="sd">        string, a list of strings, a regular expression object, or a</span>
<span class="sd">        callable that takes a string and returns whether or not the</span>
<span class="sd">        string matches for some custom definition of &#39;matches&#39;. The</span>
<span class="sd">        same is true of the tag name.&quot;&quot;&quot;</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursiveChildGenerator</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">recursive</span><span class="p">:</span>
            <span class="n">generator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">childGenerator</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_findAll</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">generator</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
    <span class="n">findChildren</span> <span class="o">=</span> <span class="n">findAll</span>

    <span class="c"># Pre-3.x compatibility methods. Will go away in 4.0.</span>
    <span class="n">first</span> <span class="o">=</span> <span class="n">find</span>
    <span class="n">fetch</span> <span class="o">=</span> <span class="n">findAll</span>

<div class="viewcode-block" id="Tag.fetchText"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.Tag.fetchText">[docs]</a>    <span class="k">def</span> <span class="nf">fetchText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="n">recursive</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tag.firstText"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.Tag.firstText">[docs]</a>    <span class="k">def</span> <span class="nf">firstText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="n">recursive</span><span class="p">)</span>

    <span class="c"># 3.x compatibility methods. Will go away in 4.0.</span></div>
<div class="viewcode-block" id="Tag.renderContents"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.Tag.renderContents">[docs]</a>    <span class="k">def</span> <span class="nf">renderContents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">DEFAULT_OUTPUT_ENCODING</span><span class="p">,</span>
                       <span class="n">prettyPrint</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">indentLevel</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">decodeContents</span><span class="p">(</span><span class="n">prettyPrint</span><span class="p">,</span> <span class="n">indentLevel</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">encodeContents</span><span class="p">(</span><span class="n">encoding</span><span class="p">,</span> <span class="n">prettyPrint</span><span class="p">,</span> <span class="n">indentLevel</span><span class="p">)</span>


    <span class="c">#Private methods</span>
</div>
    <span class="k">def</span> <span class="nf">_getAttrMap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initializes a map representation of this tag&#39;s attributes,</span>
<span class="sd">        if not already initialized.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;attrMap&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attrMap</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">attrMap</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrMap</span>

    <span class="c">#Generator methods</span>
<div class="viewcode-block" id="Tag.recursiveChildGenerator"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.Tag.recursiveChildGenerator">[docs]</a>    <span class="k">def</span> <span class="nf">recursiveChildGenerator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>
        <span class="n">stopNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lastRecursiveChild</span><span class="p">()</span><span class="o">.</span><span class="n">next</span>
        <span class="n">current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">while</span> <span class="n">current</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">stopNode</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">current</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="n">next</span>
</div>
<div class="viewcode-block" id="Tag.childGenerator"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.Tag.childGenerator">[docs]</a>    <span class="k">def</span> <span class="nf">childGenerator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>
        <span class="n">current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">while</span> <span class="n">current</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">current</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="n">nextSibling</span>
        <span class="k">raise</span> <span class="ne">StopIteration</span>

<span class="c"># Next, a couple classes to represent queries and their results.</span></div></div>
<div class="viewcode-block" id="SoupStrainer"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.SoupStrainer">[docs]</a><span class="k">class</span> <span class="nc">SoupStrainer</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Encapsulates a number of ways of matching a markup element (tag or</span>
<span class="sd">    text).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{},</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">if</span> <span class="n">isString</span><span class="p">(</span><span class="n">attrs</span><span class="p">):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">attrs</span>
            <span class="n">attrs</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attrs</span><span class="p">:</span>
                <span class="n">attrs</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">attrs</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">attrs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">|</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>

<div class="viewcode-block" id="SoupStrainer.searchTag"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.SoupStrainer.searchTag">[docs]</a>    <span class="k">def</span> <span class="nf">searchTag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">markupName</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">markupAttrs</span><span class="o">=</span><span class="p">{}):</span>
        <span class="n">found</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">markup</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">markupName</span><span class="p">,</span> <span class="n">Tag</span><span class="p">):</span>
            <span class="n">markup</span> <span class="o">=</span> <span class="n">markupName</span>
            <span class="n">markupAttrs</span> <span class="o">=</span> <span class="n">markup</span>
        <span class="n">callFunctionWithTagData</span> <span class="o">=</span> <span class="nb">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> \
                                <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">markupName</span><span class="p">,</span> <span class="n">Tag</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> \
               <span class="ow">or</span> <span class="n">callFunctionWithTagData</span> \
               <span class="ow">or</span> <span class="p">(</span><span class="n">markup</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matches</span><span class="p">(</span><span class="n">markup</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span> \
               <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="n">markup</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matches</span><span class="p">(</span><span class="n">markupName</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">callFunctionWithTagData</span><span class="p">:</span>
                <span class="n">match</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="n">markupName</span><span class="p">,</span> <span class="n">markupAttrs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">match</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="n">markupAttrMap</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">matchAgainst</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">markupAttrMap</span><span class="p">:</span>
                         <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">markupAttrs</span><span class="p">,</span> <span class="s">&#39;get&#39;</span><span class="p">):</span>
                            <span class="n">markupAttrMap</span> <span class="o">=</span> <span class="n">markupAttrs</span>
                         <span class="k">else</span><span class="p">:</span>
                            <span class="n">markupAttrMap</span> <span class="o">=</span> <span class="p">{}</span>
                            <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">markupAttrs</span><span class="p">:</span>
                                <span class="n">markupAttrMap</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
                    <span class="n">attrValue</span> <span class="o">=</span> <span class="n">markupAttrMap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matches</span><span class="p">(</span><span class="n">attrValue</span><span class="p">,</span> <span class="n">matchAgainst</span><span class="p">):</span>
                        <span class="n">match</span> <span class="o">=</span> <span class="bp">False</span>
                        <span class="k">break</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">markup</span><span class="p">:</span>
                    <span class="n">found</span> <span class="o">=</span> <span class="n">markup</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">found</span> <span class="o">=</span> <span class="n">markupName</span>
        <span class="k">return</span> <span class="n">found</span>
</div>
<div class="viewcode-block" id="SoupStrainer.search"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.SoupStrainer.search">[docs]</a>    <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">markup</span><span class="p">):</span>
        <span class="c">#print &#39;looking for %s in %s&#39; % (self, markup)</span>
        <span class="n">found</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c"># If given a list of items, scan it for a text element that</span>
        <span class="c"># matches.</span>
        <span class="k">if</span> <span class="n">isList</span><span class="p">(</span><span class="n">markup</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">markup</span><span class="p">,</span> <span class="n">Tag</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">markup</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">NavigableString</span><span class="p">)</span> \
                       <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">element</span><span class="p">):</span>
                    <span class="n">found</span> <span class="o">=</span> <span class="n">element</span>
                    <span class="k">break</span>
        <span class="c"># If it&#39;s a Tag, make sure its name or attributes match.</span>
        <span class="c"># Don&#39;t bother with Tags if we&#39;re searching for text.</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">markup</span><span class="p">,</span> <span class="n">Tag</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
                <span class="n">found</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">searchTag</span><span class="p">(</span><span class="n">markup</span><span class="p">)</span>
        <span class="c"># If it&#39;s text, make sure the text matches.</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">markup</span><span class="p">,</span> <span class="n">NavigableString</span><span class="p">)</span> <span class="ow">or</span> \
                 <span class="n">isString</span><span class="p">(</span><span class="n">markup</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matches</span><span class="p">(</span><span class="n">markup</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">):</span>
                <span class="n">found</span> <span class="o">=</span> <span class="n">markup</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">,</span> <span class="s">&quot;I don&#39;t know how to match against a </span><span class="si">%s</span><span class="s">&quot;</span> \
                  <span class="o">%</span> <span class="n">markup</span><span class="o">.</span><span class="n">__class__</span>
        <span class="k">return</span> <span class="n">found</span>
</div>
    <span class="k">def</span> <span class="nf">_matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">markup</span><span class="p">,</span> <span class="n">matchAgainst</span><span class="p">):</span>
        <span class="c">#print &quot;Matching %s against %s&quot; % (markup, matchAgainst)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="n">matchAgainst</span> <span class="o">==</span> <span class="bp">True</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">matchAgainst</span><span class="p">)</span> <span class="o">==</span> <span class="n">types</span><span class="o">.</span><span class="n">BooleanType</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">markup</span> <span class="o">!=</span> <span class="bp">None</span>
        <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">matchAgainst</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">matchAgainst</span><span class="p">(</span><span class="n">markup</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#Custom match methods take the tag as an argument, but all</span>
            <span class="c">#other ways of matching match the tag name as a string.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">markup</span><span class="p">,</span> <span class="n">Tag</span><span class="p">):</span>
                <span class="n">markup</span> <span class="o">=</span> <span class="n">markup</span><span class="o">.</span><span class="n">name</span>
            <span class="k">if</span> <span class="n">markup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isString</span><span class="p">(</span><span class="n">markup</span><span class="p">):</span>
                <span class="n">markup</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">markup</span><span class="p">)</span>
            <span class="c">#Now we know that chunk is either a string, or None.</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">matchAgainst</span><span class="p">,</span> <span class="s">&#39;match&#39;</span><span class="p">):</span>
                <span class="c"># It&#39;s a regexp object.</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">markup</span> <span class="ow">and</span> <span class="n">matchAgainst</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">markup</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">isList</span><span class="p">(</span><span class="n">matchAgainst</span><span class="p">)</span>
                  <span class="ow">and</span> <span class="p">(</span><span class="n">markup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">isString</span><span class="p">(</span><span class="n">matchAgainst</span><span class="p">))):</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">markup</span> <span class="ow">in</span> <span class="n">matchAgainst</span>
            <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">matchAgainst</span><span class="p">,</span> <span class="s">&#39;items&#39;</span><span class="p">):</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">markup</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">matchAgainst</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">matchAgainst</span> <span class="ow">and</span> <span class="n">isString</span><span class="p">(</span><span class="n">markup</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">markup</span><span class="p">,</span> <span class="nb">unicode</span><span class="p">):</span>
                    <span class="n">matchAgainst</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">matchAgainst</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">matchAgainst</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">matchAgainst</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">matchAgainst</span> <span class="o">==</span> <span class="n">markup</span>
        <span class="k">return</span> <span class="n">result</span>
</div>
<div class="viewcode-block" id="ResultSet"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.ResultSet">[docs]</a><span class="k">class</span> <span class="nc">ResultSet</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A ResultSet is just a list that keeps track of the SoupStrainer</span>
<span class="sd">    that created it.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
        <span class="nb">list</span><span class="o">.</span><span class="n">__init__</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">source</span>

<span class="c"># Now, some helper functions.</span>
</div>
<div class="viewcode-block" id="isList"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.isList">[docs]</a><span class="k">def</span> <span class="nf">isList</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convenience method that works with all 2.x versions of Python</span>
<span class="sd">    to determine whether or not something is listlike.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">((</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&#39;__iter__&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isString</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
            <span class="ow">or</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">ListType</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">TupleType</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="isString"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.isString">[docs]</a><span class="k">def</span> <span class="nf">isString</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convenience method that works with all 2.x versions of Python</span>
<span class="sd">    to determine whether or not something is stringlike.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">unicode</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="buildTagMap"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.buildTagMap">[docs]</a><span class="k">def</span> <span class="nf">buildTagMap</span><span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Turns a list of maps, lists, or scalars into a single map.</span>
<span class="sd">    Used to build the SELF_CLOSING_TAGS, NESTABLE_TAGS, and</span>
<span class="sd">    NESTING_RESET_TAGS maps out of lists and partial maps.&quot;&quot;&quot;</span>
    <span class="n">built</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">portion</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">portion</span><span class="p">,</span> <span class="s">&#39;items&#39;</span><span class="p">):</span>
            <span class="c">#It&#39;s a map. Merge it.</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">portion</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">built</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">elif</span> <span class="n">isList</span><span class="p">(</span><span class="n">portion</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isString</span><span class="p">(</span><span class="n">portion</span><span class="p">):</span>
            <span class="c">#It&#39;s a list. Map each item to the default.</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">portion</span><span class="p">:</span>
                <span class="n">built</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">default</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#It&#39;s a scalar. Map it to the default.</span>
            <span class="n">built</span><span class="p">[</span><span class="n">portion</span><span class="p">]</span> <span class="o">=</span> <span class="n">default</span>
    <span class="k">return</span> <span class="n">built</span>

<span class="c"># Now, the parser classes.</span>
</div>
<div class="viewcode-block" id="HTMLParserBuilder"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.HTMLParserBuilder">[docs]</a><span class="k">class</span> <span class="nc">HTMLParserBuilder</span><span class="p">(</span><span class="n">HTMLParser</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">soup</span><span class="p">):</span>
        <span class="n">HTMLParser</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soup</span> <span class="o">=</span> <span class="n">soup</span>

    <span class="c"># We inherit feed() and reset().</span>

<div class="viewcode-block" id="HTMLParserBuilder.handle_starttag"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.HTMLParserBuilder.handle_starttag">[docs]</a>    <span class="k">def</span> <span class="nf">handle_starttag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s">&#39;meta&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">soup</span><span class="o">.</span><span class="n">extractCharsetFromMeta</span><span class="p">(</span><span class="n">attrs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">soup</span><span class="o">.</span><span class="n">unknown_starttag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserBuilder.handle_endtag"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.HTMLParserBuilder.handle_endtag">[docs]</a>    <span class="k">def</span> <span class="nf">handle_endtag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soup</span><span class="o">.</span><span class="n">unknown_endtag</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserBuilder.handle_data"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.HTMLParserBuilder.handle_data">[docs]</a>    <span class="k">def</span> <span class="nf">handle_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soup</span><span class="o">.</span><span class="n">handle_data</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_toStringSubclass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">subclass</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a certain piece of text to the tree as a NavigableString</span>
<span class="sd">        subclass.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soup</span><span class="o">.</span><span class="n">endData</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handle_data</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soup</span><span class="o">.</span><span class="n">endData</span><span class="p">(</span><span class="n">subclass</span><span class="p">)</span>

<div class="viewcode-block" id="HTMLParserBuilder.handle_pi"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.HTMLParserBuilder.handle_pi">[docs]</a>    <span class="k">def</span> <span class="nf">handle_pi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Handle a processing instruction as a ProcessingInstruction</span>
<span class="sd">        object, possibly one with a %SOUP-ENCODING% slot into which an</span>
<span class="sd">        encoding will be plugged later.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">text</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;xml&quot;</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s">u&quot;xml version=&#39;1.0&#39; encoding=&#39;%SOUP-ENCODING%&#39;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_toStringSubclass</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">ProcessingInstruction</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserBuilder.handle_comment"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.HTMLParserBuilder.handle_comment">[docs]</a>    <span class="k">def</span> <span class="nf">handle_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="s">&quot;Handle comments as Comment objects.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_toStringSubclass</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">Comment</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserBuilder.handle_charref"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.HTMLParserBuilder.handle_charref">[docs]</a>    <span class="k">def</span> <span class="nf">handle_charref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref</span><span class="p">):</span>
        <span class="s">&quot;Handle character references as data.&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soup</span><span class="o">.</span><span class="n">convertEntities</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nb">unichr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">ref</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="s">&#39;&amp;#</span><span class="si">%s</span><span class="s">;&#39;</span> <span class="o">%</span> <span class="n">ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handle_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserBuilder.handle_entityref"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.HTMLParserBuilder.handle_entityref">[docs]</a>    <span class="k">def</span> <span class="nf">handle_entityref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Handle entity references as data, possibly converting known</span>
<span class="sd">        HTML and/or XML entity references to the corresponding Unicode</span>
<span class="sd">        characters.&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soup</span><span class="o">.</span><span class="n">convertHTMLEntities</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="nb">unichr</span><span class="p">(</span><span class="n">name2codepoint</span><span class="p">[</span><span class="n">ref</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">soup</span><span class="o">.</span><span class="n">convertXMLEntities</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">soup</span><span class="o">.</span><span class="n">XML_ENTITIES_TO_SPECIAL_CHARS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">soup</span><span class="o">.</span><span class="n">convertHTMLEntities</span> <span class="ow">and</span> \
            <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">soup</span><span class="o">.</span><span class="n">XML_ENTITIES_TO_SPECIAL_CHARS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ref</span><span class="p">):</span>
                <span class="c"># TODO: We&#39;ve got a problem here. We&#39;re told this is</span>
                <span class="c"># an entity reference, but it&#39;s not an XML entity</span>
                <span class="c"># reference or an HTML entity reference. Nonetheless,</span>
                <span class="c"># the logical thing to do is to pass it through as an</span>
                <span class="c"># unrecognized entity reference.</span>
                <span class="c">#</span>
                <span class="c"># Except: when the input is &quot;&amp;carol;&quot; this function</span>
                <span class="c"># will be called with input &quot;carol&quot;. When the input is</span>
                <span class="c"># &quot;AT&amp;T&quot;, this function will be called with input</span>
                <span class="c"># &quot;T&quot;. We have no way of knowing whether a semicolon</span>
                <span class="c"># was present originally, so we don&#39;t know whether</span>
                <span class="c"># this is an unknown entity or just a misplaced</span>
                <span class="c"># ampersand.</span>
                <span class="c">#</span>
                <span class="c"># The more common case is a misplaced ampersand, so I</span>
                <span class="c"># escape the ampersand and omit the trailing semicolon.</span>
                <span class="n">data</span> <span class="o">=</span> <span class="s">&quot;&amp;amp;</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">ref</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
            <span class="c"># This case is different from the one above, because we</span>
            <span class="c"># haven&#39;t already gone through a supposedly comprehensive</span>
            <span class="c"># mapping of entities to Unicode characters. We might not</span>
            <span class="c"># have gone through any mapping at all. So the chances are</span>
            <span class="c"># very high that this is a real entity, and not a</span>
            <span class="c"># misplaced ampersand.</span>
            <span class="n">data</span> <span class="o">=</span> <span class="s">&quot;&amp;</span><span class="si">%s</span><span class="s">;&quot;</span> <span class="o">%</span> <span class="n">ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handle_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserBuilder.handle_decl"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.HTMLParserBuilder.handle_decl">[docs]</a>    <span class="k">def</span> <span class="nf">handle_decl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="s">&quot;Handle DOCTYPEs and the like as Declaration objects.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_toStringSubclass</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">Declaration</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HTMLParserBuilder.parse_declaration"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.HTMLParserBuilder.parse_declaration">[docs]</a>    <span class="k">def</span> <span class="nf">parse_declaration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Treat a bogus SGML declaration as raw data. Treat a CDATA</span>
<span class="sd">        declaration as a CData object.&quot;&quot;&quot;</span>
        <span class="n">j</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rawdata</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">9</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;&lt;![CDATA[&#39;</span><span class="p">:</span>
             <span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rawdata</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;]]&gt;&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
             <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                 <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rawdata</span><span class="p">)</span>
             <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rawdata</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">9</span><span class="p">:</span><span class="n">k</span><span class="p">]</span>
             <span class="n">j</span> <span class="o">=</span> <span class="n">k</span><span class="o">+</span><span class="mi">3</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">_toStringSubclass</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">CData</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">HTMLParser</span><span class="o">.</span><span class="n">parse_declaration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">HTMLParseError</span><span class="p">:</span>
                <span class="n">toHandle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rawdata</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle_data</span><span class="p">(</span><span class="n">toHandle</span><span class="p">)</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">toHandle</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">j</span>

</div></div>
<div class="viewcode-block" id="BeautifulStoneSoup"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.BeautifulStoneSoup">[docs]</a><span class="k">class</span> <span class="nc">BeautifulStoneSoup</span><span class="p">(</span><span class="n">Tag</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;This class contains the basic parser and search code. It defines</span>
<span class="sd">    a parser that knows nothing about tag behavior except for the</span>
<span class="sd">    following:</span>

<span class="sd">      You can&#39;t close a tag without closing all the tags it encloses.</span>
<span class="sd">      That is, &quot;&lt;foo&gt;&lt;bar&gt;&lt;/foo&gt;&quot; actually means</span>
<span class="sd">      &quot;&lt;foo&gt;&lt;bar&gt;&lt;/bar&gt;&lt;/foo&gt;&quot;.</span>

<span class="sd">    [Another possible explanation is &quot;&lt;foo&gt;&lt;bar /&gt;&lt;/foo&gt;&quot;, but since</span>
<span class="sd">    this class defines no SELF_CLOSING_TAGS, it will never use that</span>
<span class="sd">    explanation.]</span>

<span class="sd">    This class is useful for parsing XML or made-up markup languages,</span>
<span class="sd">    or when BeautifulSoup makes an assumption counter to what you were</span>
<span class="sd">    expecting.&quot;&quot;&quot;</span>

    <span class="n">SELF_CLOSING_TAGS</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">NESTABLE_TAGS</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">RESET_NESTING_TAGS</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">QUOTE_TAGS</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">PRESERVE_WHITESPACE_TAGS</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">MARKUP_MASSAGE</span> <span class="o">=</span> <span class="p">[(</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(&lt;[^&lt;&gt;]*)/&gt;&#39;</span><span class="p">),</span>
                       <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; /&gt;&#39;</span><span class="p">),</span>
                      <span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;&lt;!\s+([^&lt;&gt;]*)&gt;&#39;</span><span class="p">),</span>
                       <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s">&#39;&lt;!&#39;</span> <span class="o">+</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;&gt;&#39;</span><span class="p">)</span>
                      <span class="p">]</span>

    <span class="n">ROOT_TAG_NAME</span> <span class="o">=</span> <span class="s">u&#39;[document]&#39;</span>

    <span class="n">HTML_ENTITIES</span> <span class="o">=</span> <span class="s">&quot;html&quot;</span>
    <span class="n">XML_ENTITIES</span> <span class="o">=</span> <span class="s">&quot;xml&quot;</span>
    <span class="n">XHTML_ENTITIES</span> <span class="o">=</span> <span class="s">&quot;xhtml&quot;</span>
    <span class="c"># TODO: This only exists for backwards-compatibility</span>
    <span class="n">ALL_ENTITIES</span> <span class="o">=</span> <span class="n">XHTML_ENTITIES</span>

    <span class="c"># Used when determining whether a text node is all whitespace and</span>
    <span class="c"># can be replaced with a single space. A text node that contains</span>
    <span class="c"># fancy Unicode spaces (usually non-breaking) should be left</span>
    <span class="c"># alone.</span>
    <span class="n">STRIP_ASCII_SPACES</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">9</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">32</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="p">}</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">markup</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">parseOnlyThese</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fromEncoding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">markupMassage</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">smartQuotesTo</span><span class="o">=</span><span class="n">XML_ENTITIES</span><span class="p">,</span>
                 <span class="n">convertEntities</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">selfClosingTags</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">isHTML</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                 <span class="n">builder</span><span class="o">=</span><span class="n">HTMLParserBuilder</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The Soup object is initialized as the &#39;root tag&#39;, and the</span>
<span class="sd">        provided markup (which can be a string or a file-like object)</span>
<span class="sd">        is fed into the underlying parser.</span>

<span class="sd">        HTMLParser will process most bad HTML, and the BeautifulSoup</span>
<span class="sd">        class has some tricks for dealing with some HTML that kills</span>
<span class="sd">        HTMLParser, but Beautiful Soup can nonetheless choke or lose data</span>
<span class="sd">        if your data uses self-closing tags or declarations</span>
<span class="sd">        incorrectly.</span>

<span class="sd">        By default, Beautiful Soup uses regexes to sanitize input,</span>
<span class="sd">        avoiding the vast majority of these problems. If the problems</span>
<span class="sd">        don&#39;t apply to you, pass in False for markupMassage, and</span>
<span class="sd">        you&#39;ll get better performance.</span>

<span class="sd">        The default parser massage techniques fix the two most common</span>
<span class="sd">        instances of invalid HTML that choke HTMLParser:</span>

<span class="sd">         &lt;br/&gt; (No space between name of closing tag and tag close)</span>
<span class="sd">         &lt;! --Comment--&gt; (Extraneous whitespace in declaration)</span>

<span class="sd">        You can pass in a custom list of (RE object, replace method)</span>
<span class="sd">        tuples to get Beautiful Soup to scrub your input the way you</span>
<span class="sd">        want.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">parseOnlyThese</span> <span class="o">=</span> <span class="n">parseOnlyThese</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fromEncoding</span> <span class="o">=</span> <span class="n">fromEncoding</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smartQuotesTo</span> <span class="o">=</span> <span class="n">smartQuotesTo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convertEntities</span> <span class="o">=</span> <span class="n">convertEntities</span>
        <span class="c"># Set the rules for how we&#39;ll deal with the entities we</span>
        <span class="c"># encounter</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">convertEntities</span><span class="p">:</span>
            <span class="c"># It doesn&#39;t make sense to convert encoded characters to</span>
            <span class="c"># entities even while you&#39;re converting entities to Unicode.</span>
            <span class="c"># Just convert it all to Unicode.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">smartQuotesTo</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">if</span> <span class="n">convertEntities</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">HTML_ENTITIES</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">convertXMLEntities</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">convertHTMLEntities</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">escapeUnrecognizedEntities</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">elif</span> <span class="n">convertEntities</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">XHTML_ENTITIES</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">convertXMLEntities</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">convertHTMLEntities</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">escapeUnrecognizedEntities</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">elif</span> <span class="n">convertEntities</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">XML_ENTITIES</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">convertXMLEntities</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">convertHTMLEntities</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">escapeUnrecognizedEntities</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convertXMLEntities</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convertHTMLEntities</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">escapeUnrecognizedEntities</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">instanceSelfClosingTags</span> <span class="o">=</span> <span class="n">buildTagMap</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">selfClosingTags</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">builder</span> <span class="o">=</span> <span class="n">builder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">markup</span><span class="p">,</span> <span class="s">&#39;read&#39;</span><span class="p">):</span>        <span class="c"># It&#39;s a file-type object.</span>
            <span class="n">markup</span> <span class="o">=</span> <span class="n">markup</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">markup</span> <span class="o">=</span> <span class="n">markup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">markupMassage</span> <span class="o">=</span> <span class="n">markupMassage</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="n">isHTML</span><span class="o">=</span><span class="n">isHTML</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">StopParsing</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">markup</span> <span class="o">=</span> <span class="bp">None</span>                 <span class="c"># The markup can now be GCed.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">builder</span> <span class="o">=</span> <span class="bp">None</span>                <span class="c"># So can the builder.</span>

    <span class="k">def</span> <span class="nf">_feed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inDocumentEncoding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">isHTML</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="c"># Convert the document to Unicode.</span>
        <span class="n">markup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">markup</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">markup</span><span class="p">,</span> <span class="nb">unicode</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;originalEncoding&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">originalEncoding</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dammit</span> <span class="o">=</span> <span class="n">UnicodeDammit</span>\
                     <span class="p">(</span><span class="n">markup</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fromEncoding</span><span class="p">,</span> <span class="n">inDocumentEncoding</span><span class="p">],</span>
                      <span class="n">smartQuotesTo</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">smartQuotesTo</span><span class="p">,</span> <span class="n">isHTML</span><span class="o">=</span><span class="n">isHTML</span><span class="p">)</span>
            <span class="n">markup</span> <span class="o">=</span> <span class="n">dammit</span><span class="o">.</span><span class="n">unicode</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">originalEncoding</span> <span class="o">=</span> <span class="n">dammit</span><span class="o">.</span><span class="n">originalEncoding</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">declaredHTMLEncoding</span> <span class="o">=</span> <span class="n">dammit</span><span class="o">.</span><span class="n">declaredHTMLEncoding</span>
        <span class="k">if</span> <span class="n">markup</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">markupMassage</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">isList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">markupMassage</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">markupMassage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MARKUP_MASSAGE</span>
                <span class="k">for</span> <span class="n">fix</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">markupMassage</span><span class="p">:</span>
                    <span class="n">markup</span> <span class="o">=</span> <span class="n">fix</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">markup</span><span class="p">)</span>
                <span class="c"># TODO: We get rid of markupMassage so that the</span>
                <span class="c"># soup object can be deepcopied later on. Some</span>
                <span class="c"># Python installations can&#39;t copy regexes. If anyone</span>
                <span class="c"># was relying on the existence of markupMassage, this</span>
                <span class="c"># might cause problems.</span>
                <span class="k">del</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">markupMassage</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="n">markup</span><span class="p">)</span>
        <span class="c"># Close out any unfinished strings and close all the open tags.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endData</span><span class="p">()</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentTag</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ROOT_TAG_NAME</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">popTag</span><span class="p">()</span>

<div class="viewcode-block" id="BeautifulStoneSoup.isSelfClosingTag"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.BeautifulStoneSoup.isSelfClosingTag">[docs]</a>    <span class="k">def</span> <span class="nf">isSelfClosingTag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns true iff the given string is the name of a</span>
<span class="sd">        self-closing tag according to this parser.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">SELF_CLOSING_TAGS</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> \
               <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">instanceSelfClosingTags</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BeautifulStoneSoup.reset"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.BeautifulStoneSoup.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Tag</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ROOT_TAG_NAME</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hidden</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentData</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentTag</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tagStack</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quoteStack</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushTag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BeautifulStoneSoup.popTag"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.BeautifulStoneSoup.popTag">[docs]</a>    <span class="k">def</span> <span class="nf">popTag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tagStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="c"># Tags with just one string-owning child get the child as a</span>
        <span class="c"># &#39;string&#39; property, so that soup.tag.string is shorthand for</span>
        <span class="c"># soup.tag.contents[0]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTag</span><span class="o">.</span><span class="n">contents</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> \
           <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTag</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">NavigableString</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentTag</span><span class="o">.</span><span class="n">string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentTag</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c">#print &quot;Pop&quot;, tag.name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tagStack</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentTag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tagStack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentTag</span>
</div>
<div class="viewcode-block" id="BeautifulStoneSoup.pushTag"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.BeautifulStoneSoup.pushTag">[docs]</a>    <span class="k">def</span> <span class="nf">pushTag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">):</span>
        <span class="c">#print &quot;Push&quot;, tag.name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentTag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentTag</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tagStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentTag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tagStack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="BeautifulStoneSoup.endData"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.BeautifulStoneSoup.endData">[docs]</a>    <span class="k">def</span> <span class="nf">endData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">containerClass</span><span class="o">=</span><span class="n">NavigableString</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentData</span><span class="p">:</span>
            <span class="n">currentData</span> <span class="o">=</span> <span class="s">u&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentData</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">currentData</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STRIP_ASCII_SPACES</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;&#39;</span> <span class="ow">and</span>
                <span class="ow">not</span> <span class="nb">set</span><span class="p">([</span><span class="n">tag</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tagStack</span><span class="p">])</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">PRESERVE_WHITESPACE_TAGS</span><span class="p">)):</span>
                <span class="k">if</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span> <span class="ow">in</span> <span class="n">currentData</span><span class="p">:</span>
                    <span class="n">currentData</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">currentData</span> <span class="o">=</span> <span class="s">&#39; &#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentData</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseOnlyThese</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tagStack</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="ow">and</span> \
                   <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseOnlyThese</span><span class="o">.</span><span class="n">text</span> <span class="ow">or</span> \
                    <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseOnlyThese</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">currentData</span><span class="p">)):</span>
                <span class="k">return</span>
            <span class="n">o</span> <span class="o">=</span> <span class="n">containerClass</span><span class="p">(</span><span class="n">currentData</span><span class="p">)</span>
            <span class="n">o</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentTag</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="n">o</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">previous</span> <span class="o">=</span> <span class="n">o</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentTag</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>

</div>
    <span class="k">def</span> <span class="nf">_popToTag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">inclusivePop</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Pops the tag stack up to and including the most recent</span>
<span class="sd">        instance of the given tag. If inclusivePop is false, pops the tag</span>
<span class="sd">        stack up to but *not* including the most recent instqance of</span>
<span class="sd">        the given tag.&quot;&quot;&quot;</span>
        <span class="c">#print &quot;Popping to %s&quot; % name</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ROOT_TAG_NAME</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">numPops</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">mostRecentTag</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tagStack</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">tagStack</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="n">numPops</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tagStack</span><span class="p">)</span><span class="o">-</span><span class="n">i</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inclusivePop</span><span class="p">:</span>
            <span class="n">numPops</span> <span class="o">=</span> <span class="n">numPops</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">numPops</span><span class="p">):</span>
            <span class="n">mostRecentTag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">popTag</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">mostRecentTag</span>

    <span class="k">def</span> <span class="nf">_smartPop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;We need to pop up to the previous tag of this type, unless</span>
<span class="sd">        one of this tag&#39;s nesting reset triggers comes between this</span>
<span class="sd">        tag and the previous tag of this type, OR unless this tag is a</span>
<span class="sd">        generic nesting trigger and another generic nesting trigger</span>
<span class="sd">        comes between this tag and the previous tag of this type.</span>

<span class="sd">        Examples:</span>
<span class="sd">         &lt;p&gt;Foo&lt;b&gt;Bar *&lt;p&gt;* should pop to &#39;p&#39;, not &#39;b&#39;.</span>
<span class="sd">         &lt;p&gt;Foo&lt;table&gt;Bar *&lt;p&gt;* should pop to &#39;table&#39;, not &#39;p&#39;.</span>
<span class="sd">         &lt;p&gt;Foo&lt;table&gt;&lt;tr&gt;Bar *&lt;p&gt;* should pop to &#39;tr&#39;, not &#39;p&#39;.</span>

<span class="sd">         &lt;li&gt;&lt;ul&gt;&lt;li&gt; *&lt;li&gt;* should pop to &#39;ul&#39;, not the first &#39;li&#39;.</span>
<span class="sd">         &lt;tr&gt;&lt;table&gt;&lt;tr&gt; *&lt;tr&gt;* should pop to &#39;table&#39;, not the first &#39;tr&#39;</span>
<span class="sd">         &lt;td&gt;&lt;tr&gt;&lt;td&gt; *&lt;td&gt;* should pop to &#39;tr&#39;, not the first &#39;td&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">nestingResetTriggers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NESTABLE_TAGS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">isNestable</span> <span class="o">=</span> <span class="n">nestingResetTriggers</span> <span class="o">!=</span> <span class="bp">None</span>
        <span class="n">isResetNesting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RESET_NESTING_TAGS</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">popTo</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">inclusive</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tagStack</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tagStack</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">p</span> <span class="ow">or</span> <span class="n">p</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isNestable</span><span class="p">:</span>
                <span class="c">#Non-nestable tags get popped to the top or to their</span>
                <span class="c">#last occurance.</span>
                <span class="n">popTo</span> <span class="o">=</span> <span class="n">name</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">nestingResetTriggers</span> <span class="o">!=</span> <span class="bp">None</span>
                <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">nestingResetTriggers</span><span class="p">)</span> \
                <span class="ow">or</span> <span class="p">(</span><span class="n">nestingResetTriggers</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">isResetNesting</span>
                    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">RESET_NESTING_TAGS</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">name</span><span class="p">)):</span>

                <span class="c">#If we encounter one of the nesting reset triggers</span>
                <span class="c">#peculiar to this tag, or we encounter another tag</span>
                <span class="c">#that causes nesting to reset, pop up to but not</span>
                <span class="c">#including that tag.</span>
                <span class="n">popTo</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">name</span>
                <span class="n">inclusive</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">break</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">parent</span>
        <span class="k">if</span> <span class="n">popTo</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_popToTag</span><span class="p">(</span><span class="n">popTo</span><span class="p">,</span> <span class="n">inclusive</span><span class="p">)</span>

<div class="viewcode-block" id="BeautifulStoneSoup.unknown_starttag"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.BeautifulStoneSoup.unknown_starttag">[docs]</a>    <span class="k">def</span> <span class="nf">unknown_starttag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">selfClosing</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="c">#print &quot;Start tag %s: %s&quot; % (name, attrs)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quoteStack</span><span class="p">:</span>
            <span class="c">#This is not a real tag.</span>
            <span class="c">#print &quot;&lt;%s&gt; is not real!&quot; % name</span>
            <span class="n">attrs</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span> <span class="s">&#39; </span><span class="si">%s</span><span class="s">=&quot;</span><span class="si">%s</span><span class="s">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">attrs</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handle_data</span><span class="p">(</span><span class="s">&#39;&lt;</span><span class="si">%s%s</span><span class="s">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endData</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isSelfClosingTag</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">selfClosing</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_smartPop</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseOnlyThese</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tagStack</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span> \
               <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parseOnlyThese</span><span class="o">.</span><span class="n">text</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseOnlyThese</span><span class="o">.</span><span class="n">searchTag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)):</span>
            <span class="k">return</span>

        <span class="n">tag</span> <span class="o">=</span> <span class="n">Tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentTag</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="n">tag</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">previous</span> <span class="o">=</span> <span class="n">tag</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushTag</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">selfClosing</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">isSelfClosingTag</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">popTag</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">QUOTE_TAGS</span><span class="p">:</span>
            <span class="c">#print &quot;Beginning quote (%s)&quot; % name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">quoteStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">literal</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">tag</span>
</div>
<div class="viewcode-block" id="BeautifulStoneSoup.unknown_endtag"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.BeautifulStoneSoup.unknown_endtag">[docs]</a>    <span class="k">def</span> <span class="nf">unknown_endtag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="c">#print &quot;End tag %s&quot; % name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quoteStack</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">quoteStack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">name</span><span class="p">:</span>
            <span class="c">#This is not a real end tag.</span>
            <span class="c">#print &quot;&lt;/%s&gt; is not real!&quot; % name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handle_data</span><span class="p">(</span><span class="s">&#39;&lt;/</span><span class="si">%s</span><span class="s">&gt;&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endData</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_popToTag</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quoteStack</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">quoteStack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">quoteStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">literal</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quoteStack</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BeautifulStoneSoup.handle_data"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.BeautifulStoneSoup.handle_data">[docs]</a>    <span class="k">def</span> <span class="nf">handle_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BeautifulStoneSoup.extractCharsetFromMeta"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.BeautifulStoneSoup.extractCharsetFromMeta">[docs]</a>    <span class="k">def</span> <span class="nf">extractCharsetFromMeta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unknown_starttag</span><span class="p">(</span><span class="s">&#39;meta&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="BeautifulSoup"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.BeautifulSoup">[docs]</a><span class="k">class</span> <span class="nc">BeautifulSoup</span><span class="p">(</span><span class="n">BeautifulStoneSoup</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;This parser knows the following facts about HTML:</span>

<span class="sd">    * Some tags have no closing tag and should be interpreted as being</span>
<span class="sd">      closed as soon as they are encountered.</span>

<span class="sd">    * The text inside some tags (ie. &#39;script&#39;) may contain tags which</span>
<span class="sd">      are not really part of the document and which should be parsed</span>
<span class="sd">      as text, not tags. If you want to parse the text as tags, you can</span>
<span class="sd">      always fetch it and parse it explicitly.</span>

<span class="sd">    * Tag nesting rules:</span>

<span class="sd">      Most tags can&#39;t be nested at all. For instance, the occurance of</span>
<span class="sd">      a &lt;p&gt; tag should implicitly close the previous &lt;p&gt; tag.</span>

<span class="sd">       &lt;p&gt;Para1&lt;p&gt;Para2</span>
<span class="sd">        should be transformed into:</span>
<span class="sd">       &lt;p&gt;Para1&lt;/p&gt;&lt;p&gt;Para2</span>

<span class="sd">      Some tags can be nested arbitrarily. For instance, the occurance</span>
<span class="sd">      of a &lt;blockquote&gt; tag should _not_ implicitly close the previous</span>
<span class="sd">      &lt;blockquote&gt; tag.</span>

<span class="sd">       Alice said: &lt;blockquote&gt;Bob said: &lt;blockquote&gt;Blah</span>
<span class="sd">        should NOT be transformed into:</span>
<span class="sd">       Alice said: &lt;blockquote&gt;Bob said: &lt;/blockquote&gt;&lt;blockquote&gt;Blah</span>

<span class="sd">      Some tags can be nested, but the nesting is reset by the</span>
<span class="sd">      interposition of other tags. For instance, a &lt;tr&gt; tag should</span>
<span class="sd">      implicitly close the previous &lt;tr&gt; tag within the same &lt;table&gt;,</span>
<span class="sd">      but not close a &lt;tr&gt; tag in another table.</span>

<span class="sd">       &lt;table&gt;&lt;tr&gt;Blah&lt;tr&gt;Blah</span>
<span class="sd">        should be transformed into:</span>
<span class="sd">       &lt;table&gt;&lt;tr&gt;Blah&lt;/tr&gt;&lt;tr&gt;Blah</span>
<span class="sd">        but,</span>
<span class="sd">       &lt;tr&gt;Blah&lt;table&gt;&lt;tr&gt;Blah</span>
<span class="sd">        should NOT be transformed into</span>
<span class="sd">       &lt;tr&gt;Blah&lt;table&gt;&lt;/tr&gt;&lt;tr&gt;Blah</span>

<span class="sd">    Differing assumptions about tag nesting rules are a major source</span>
<span class="sd">    of problems with the BeautifulSoup class. If BeautifulSoup is not</span>
<span class="sd">    treating as nestable a tag your page author treats as nestable,</span>
<span class="sd">    try ICantBelieveItsBeautifulSoup, MinimalSoup, or</span>
<span class="sd">    BeautifulStoneSoup before writing your own subclass.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s">&#39;smartQuotesTo&#39;</span><span class="p">):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;smartQuotesTo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HTML_ENTITIES</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;isHTML&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">BeautifulStoneSoup</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">SELF_CLOSING_TAGS</span> <span class="o">=</span> <span class="n">buildTagMap</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span>
                                    <span class="p">[</span><span class="s">&#39;br&#39;</span> <span class="p">,</span> <span class="s">&#39;hr&#39;</span><span class="p">,</span> <span class="s">&#39;input&#39;</span><span class="p">,</span> <span class="s">&#39;img&#39;</span><span class="p">,</span> <span class="s">&#39;meta&#39;</span><span class="p">,</span>
                                    <span class="s">&#39;spacer&#39;</span><span class="p">,</span> <span class="s">&#39;link&#39;</span><span class="p">,</span> <span class="s">&#39;frame&#39;</span><span class="p">,</span> <span class="s">&#39;base&#39;</span><span class="p">])</span>

    <span class="n">PRESERVE_WHITESPACE_TAGS</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="s">&#39;pre&#39;</span><span class="p">,</span> <span class="s">&#39;textarea&#39;</span><span class="p">])</span>

    <span class="n">QUOTE_TAGS</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;script&#39;</span> <span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;textarea&#39;</span> <span class="p">:</span> <span class="bp">None</span><span class="p">}</span>

    <span class="c">#According to the HTML standard, each of these inline tags can</span>
    <span class="c">#contain another tag of the same type. Furthermore, it&#39;s common</span>
    <span class="c">#to actually use these tags this way.</span>
    <span class="n">NESTABLE_INLINE_TAGS</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;span&#39;</span><span class="p">,</span> <span class="s">&#39;font&#39;</span><span class="p">,</span> <span class="s">&#39;q&#39;</span><span class="p">,</span> <span class="s">&#39;object&#39;</span><span class="p">,</span> <span class="s">&#39;bdo&#39;</span><span class="p">,</span> <span class="s">&#39;sub&#39;</span><span class="p">,</span> <span class="s">&#39;sup&#39;</span><span class="p">,</span>
                            <span class="s">&#39;center&#39;</span><span class="p">]</span>

    <span class="c">#According to the HTML standard, these block tags can contain</span>
    <span class="c">#another tag of the same type. Furthermore, it&#39;s common</span>
    <span class="c">#to actually use these tags this way.</span>
    <span class="n">NESTABLE_BLOCK_TAGS</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;blockquote&#39;</span><span class="p">,</span> <span class="s">&#39;div&#39;</span><span class="p">,</span> <span class="s">&#39;fieldset&#39;</span><span class="p">,</span> <span class="s">&#39;ins&#39;</span><span class="p">,</span> <span class="s">&#39;del&#39;</span><span class="p">]</span>

    <span class="c">#Lists can contain other lists, but there are restrictions.</span>
    <span class="n">NESTABLE_LIST_TAGS</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;ol&#39;</span> <span class="p">:</span> <span class="p">[],</span>
                           <span class="s">&#39;ul&#39;</span> <span class="p">:</span> <span class="p">[],</span>
                           <span class="s">&#39;li&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;ul&#39;</span><span class="p">,</span> <span class="s">&#39;ol&#39;</span><span class="p">],</span>
                           <span class="s">&#39;dl&#39;</span> <span class="p">:</span> <span class="p">[],</span>
                           <span class="s">&#39;dd&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;dl&#39;</span><span class="p">],</span>
                           <span class="s">&#39;dt&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;dl&#39;</span><span class="p">]</span> <span class="p">}</span>

    <span class="c">#Tables can contain other tables, but there are restrictions.</span>
    <span class="n">NESTABLE_TABLE_TAGS</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;table&#39;</span> <span class="p">:</span> <span class="p">[],</span>
                           <span class="s">&#39;tr&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;table&#39;</span><span class="p">,</span> <span class="s">&#39;tbody&#39;</span><span class="p">,</span> <span class="s">&#39;tfoot&#39;</span><span class="p">,</span> <span class="s">&#39;thead&#39;</span><span class="p">],</span>
                           <span class="s">&#39;td&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;tr&#39;</span><span class="p">],</span>
                           <span class="s">&#39;th&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;tr&#39;</span><span class="p">],</span>
                           <span class="s">&#39;thead&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;table&#39;</span><span class="p">],</span>
                           <span class="s">&#39;tbody&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;table&#39;</span><span class="p">],</span>
                           <span class="s">&#39;tfoot&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;table&#39;</span><span class="p">],</span>
                           <span class="p">}</span>

    <span class="n">NON_NESTABLE_BLOCK_TAGS</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;address&#39;</span><span class="p">,</span> <span class="s">&#39;form&#39;</span><span class="p">,</span> <span class="s">&#39;p&#39;</span><span class="p">,</span> <span class="s">&#39;pre&#39;</span><span class="p">]</span>

    <span class="c">#If one of these tags is encountered, all tags up to the next tag of</span>
    <span class="c">#this type are popped.</span>
    <span class="n">RESET_NESTING_TAGS</span> <span class="o">=</span> <span class="n">buildTagMap</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">NESTABLE_BLOCK_TAGS</span><span class="p">,</span> <span class="s">&#39;noscript&#39;</span><span class="p">,</span>
                                     <span class="n">NON_NESTABLE_BLOCK_TAGS</span><span class="p">,</span>
                                     <span class="n">NESTABLE_LIST_TAGS</span><span class="p">,</span>
                                     <span class="n">NESTABLE_TABLE_TAGS</span><span class="p">)</span>

    <span class="n">NESTABLE_TAGS</span> <span class="o">=</span> <span class="n">buildTagMap</span><span class="p">([],</span> <span class="n">NESTABLE_INLINE_TAGS</span><span class="p">,</span> <span class="n">NESTABLE_BLOCK_TAGS</span><span class="p">,</span>
                                <span class="n">NESTABLE_LIST_TAGS</span><span class="p">,</span> <span class="n">NESTABLE_TABLE_TAGS</span><span class="p">)</span>

    <span class="c"># Used to detect the charset in a META tag; see start_meta</span>
    <span class="n">CHARSET_RE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&quot;((^|;)\s*charset=)([^;]*)&quot;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">M</span><span class="p">)</span>

<div class="viewcode-block" id="BeautifulSoup.extractCharsetFromMeta"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.BeautifulSoup.extractCharsetFromMeta">[docs]</a>    <span class="k">def</span> <span class="nf">extractCharsetFromMeta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Beautiful Soup can detect a charset included in a META tag,</span>
<span class="sd">        try to convert the document to that charset, and re-parse the</span>
<span class="sd">        document from the beginning.&quot;&quot;&quot;</span>
        <span class="n">httpEquiv</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">contentType</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">contentTypeIndex</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">tagNeedsEncodingSubstitution</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">attrs</span><span class="p">)):</span>
            <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">attrs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s">&#39;http-equiv&#39;</span><span class="p">:</span>
                <span class="n">httpEquiv</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s">&#39;content&#39;</span><span class="p">:</span>
                <span class="n">contentType</span> <span class="o">=</span> <span class="n">value</span>
                <span class="n">contentTypeIndex</span> <span class="o">=</span> <span class="n">i</span>

        <span class="k">if</span> <span class="n">httpEquiv</span> <span class="ow">and</span> <span class="n">contentType</span><span class="p">:</span> <span class="c"># It&#39;s an interesting meta tag.</span>
            <span class="n">match</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CHARSET_RE</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">contentType</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">declaredHTMLEncoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">originalEncoding</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">fromEncoding</span><span class="p">):</span>
                    <span class="c"># An HTML encoding was sniffed while converting</span>
                    <span class="c"># the document to Unicode, or an HTML encoding was</span>
                    <span class="c"># sniffed during a previous pass through the</span>
                    <span class="c"># document, or an encoding was specified</span>
                    <span class="c"># explicitly and it worked. Rewrite the meta tag.</span>
                    <span class="k">def</span> <span class="nf">rewrite</span><span class="p">(</span><span class="n">match</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;%SOUP-ENCODING%&quot;</span>
                    <span class="n">newAttr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CHARSET_RE</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">rewrite</span><span class="p">,</span> <span class="n">contentType</span><span class="p">)</span>
                    <span class="n">attrs</span><span class="p">[</span><span class="n">contentTypeIndex</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">attrs</span><span class="p">[</span><span class="n">contentTypeIndex</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                                               <span class="n">newAttr</span><span class="p">)</span>
                    <span class="n">tagNeedsEncodingSubstitution</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c"># This is our first pass through the document.</span>
                    <span class="c"># Go through it again with the encoding information.</span>
                    <span class="n">newCharset</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">newCharset</span> <span class="ow">and</span> <span class="n">newCharset</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">originalEncoding</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">declaredHTMLEncoding</span> <span class="o">=</span> <span class="n">newCharset</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">declaredHTMLEncoding</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="n">StopParsing</span>
                    <span class="k">pass</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unknown_starttag</span><span class="p">(</span><span class="s">&quot;meta&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tag</span> <span class="ow">and</span> <span class="n">tagNeedsEncodingSubstitution</span><span class="p">:</span>
            <span class="n">tag</span><span class="o">.</span><span class="n">containsSubstitutions</span> <span class="o">=</span> <span class="bp">True</span>

</div></div>
<div class="viewcode-block" id="StopParsing"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.StopParsing">[docs]</a><span class="k">class</span> <span class="nc">StopParsing</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>
</div>
<div class="viewcode-block" id="ICantBelieveItsBeautifulSoup"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.ICantBelieveItsBeautifulSoup">[docs]</a><span class="k">class</span> <span class="nc">ICantBelieveItsBeautifulSoup</span><span class="p">(</span><span class="n">BeautifulSoup</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;The BeautifulSoup class is oriented towards skipping over</span>
<span class="sd">    common HTML errors like unclosed tags. However, sometimes it makes</span>
<span class="sd">    errors of its own. For instance, consider this fragment:</span>

<span class="sd">     &lt;b&gt;Foo&lt;b&gt;Bar&lt;/b&gt;&lt;/b&gt;</span>

<span class="sd">    This is perfectly valid (if bizarre) HTML. However, the</span>
<span class="sd">    BeautifulSoup class will implicitly close the first b tag when it</span>
<span class="sd">    encounters the second &#39;b&#39;. It will think the author wrote</span>
<span class="sd">    &quot;&lt;b&gt;Foo&lt;b&gt;Bar&quot;, and didn&#39;t close the first &#39;b&#39; tag, because</span>
<span class="sd">    there&#39;s no real-world reason to bold something that&#39;s already</span>
<span class="sd">    bold. When it encounters &#39;&lt;/b&gt;&lt;/b&gt;&#39; it will close two more &#39;b&#39;</span>
<span class="sd">    tags, for a grand total of three tags closed instead of two. This</span>
<span class="sd">    can throw off the rest of your document structure. The same is</span>
<span class="sd">    true of a number of other tags, listed below.</span>

<span class="sd">    It&#39;s much more common for someone to forget to close a &#39;b&#39; tag</span>
<span class="sd">    than to actually use nested &#39;b&#39; tags, and the BeautifulSoup class</span>
<span class="sd">    handles the common case. This class handles the not-co-common</span>
<span class="sd">    case: where you can&#39;t believe someone wrote what they did, but</span>
<span class="sd">    it&#39;s valid HTML and BeautifulSoup screwed up by assuming it</span>
<span class="sd">    wouldn&#39;t be.&quot;&quot;&quot;</span>

    <span class="n">I_CANT_BELIEVE_THEYRE_NESTABLE_INLINE_TAGS</span> <span class="o">=</span> \
     <span class="p">[</span><span class="s">&#39;em&#39;</span><span class="p">,</span> <span class="s">&#39;big&#39;</span><span class="p">,</span> <span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="s">&#39;small&#39;</span><span class="p">,</span> <span class="s">&#39;tt&#39;</span><span class="p">,</span> <span class="s">&#39;abbr&#39;</span><span class="p">,</span> <span class="s">&#39;acronym&#39;</span><span class="p">,</span> <span class="s">&#39;strong&#39;</span><span class="p">,</span>
      <span class="s">&#39;cite&#39;</span><span class="p">,</span> <span class="s">&#39;code&#39;</span><span class="p">,</span> <span class="s">&#39;dfn&#39;</span><span class="p">,</span> <span class="s">&#39;kbd&#39;</span><span class="p">,</span> <span class="s">&#39;samp&#39;</span><span class="p">,</span> <span class="s">&#39;strong&#39;</span><span class="p">,</span> <span class="s">&#39;var&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span>
      <span class="s">&#39;big&#39;</span><span class="p">]</span>

    <span class="n">I_CANT_BELIEVE_THEYRE_NESTABLE_BLOCK_TAGS</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;noscript&#39;</span><span class="p">]</span>

    <span class="n">NESTABLE_TAGS</span> <span class="o">=</span> <span class="n">buildTagMap</span><span class="p">([],</span> <span class="n">BeautifulSoup</span><span class="o">.</span><span class="n">NESTABLE_TAGS</span><span class="p">,</span>
                                <span class="n">I_CANT_BELIEVE_THEYRE_NESTABLE_BLOCK_TAGS</span><span class="p">,</span>
                                <span class="n">I_CANT_BELIEVE_THEYRE_NESTABLE_INLINE_TAGS</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="MinimalSoup"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.MinimalSoup">[docs]</a><span class="k">class</span> <span class="nc">MinimalSoup</span><span class="p">(</span><span class="n">BeautifulSoup</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The MinimalSoup class is for parsing HTML that contains</span>
<span class="sd">    pathologically bad markup. It makes no assumptions about tag</span>
<span class="sd">    nesting, but it does know which tags are self-closing, that</span>
<span class="sd">    &lt;script&gt; tags contain Javascript and should not be parsed, that</span>
<span class="sd">    META tags may contain encoding information, and so on.</span>

<span class="sd">    This also makes it better for subclassing than BeautifulStoneSoup</span>
<span class="sd">    or BeautifulSoup.&quot;&quot;&quot;</span>

    <span class="n">RESET_NESTING_TAGS</span> <span class="o">=</span> <span class="n">buildTagMap</span><span class="p">(</span><span class="s">&#39;noscript&#39;</span><span class="p">)</span>
    <span class="n">NESTABLE_TAGS</span> <span class="o">=</span> <span class="p">{}</span>
</div>
<div class="viewcode-block" id="BeautifulSOAP"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.BeautifulSOAP">[docs]</a><span class="k">class</span> <span class="nc">BeautifulSOAP</span><span class="p">(</span><span class="n">BeautifulStoneSoup</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class will push a tag with only a single string child into</span>
<span class="sd">    the tag&#39;s parent as an attribute. The attribute&#39;s name is the tag</span>
<span class="sd">    name, and the value is the string child. An example should give</span>
<span class="sd">    the flavor of the change:</span>

<span class="sd">    &lt;foo&gt;&lt;bar&gt;baz&lt;/bar&gt;&lt;/foo&gt;</span>
<span class="sd">     =&gt;</span>
<span class="sd">    &lt;foo bar=&quot;baz&quot;&gt;&lt;bar&gt;baz&lt;/bar&gt;&lt;/foo&gt;</span>

<span class="sd">    You can then access fooTag[&#39;bar&#39;] instead of fooTag.barTag.string.</span>

<span class="sd">    This is, of course, useful for scraping structures that tend to</span>
<span class="sd">    use subelements instead of attributes, such as SOAP messages. Note</span>
<span class="sd">    that it modifies its input, so don&#39;t print the modified version</span>
<span class="sd">    out.</span>

<span class="sd">    I&#39;m not sure how many people really want to use this class; let me</span>
<span class="sd">    know if you do. Mainly I like the name.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="BeautifulSOAP.popTag"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.BeautifulSOAP.popTag">[docs]</a>    <span class="k">def</span> <span class="nf">popTag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tagStack</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tagStack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tagStack</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">parent</span><span class="o">.</span><span class="n">_getAttrMap</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">Tag</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">contents</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">NavigableString</span><span class="p">)</span> <span class="ow">and</span>
                <span class="ow">not</span> <span class="n">parent</span><span class="o">.</span><span class="n">attrMap</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">name</span><span class="p">)):</span>
                <span class="n">parent</span><span class="p">[</span><span class="n">tag</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">BeautifulStoneSoup</span><span class="o">.</span><span class="n">popTag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<span class="c">#Enterprise class names! It has come to our attention that some people</span>
<span class="c">#think the names of the Beautiful Soup parser classes are too silly</span>
<span class="c">#and &quot;unprofessional&quot; for use in enterprise screen-scraping. We feel</span>
<span class="c">#your pain! For such-minded folk, the Beautiful Soup Consortium And</span>
<span class="c">#All-Night Kosher Bakery recommends renaming this file to</span>
<span class="c">#&quot;RobustParser.py&quot; (or, in cases of extreme enterprisiness,</span>
<span class="c">#&quot;RobustParserBeanInterface.class&quot;) and using the following</span>
<span class="c">#enterprise-friendly class aliases:</span></div></div>
<div class="viewcode-block" id="RobustXMLParser"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.RobustXMLParser">[docs]</a><span class="k">class</span> <span class="nc">RobustXMLParser</span><span class="p">(</span><span class="n">BeautifulStoneSoup</span><span class="p">):</span>
    <span class="k">pass</span></div>
<div class="viewcode-block" id="RobustHTMLParser"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.RobustHTMLParser">[docs]</a><span class="k">class</span> <span class="nc">RobustHTMLParser</span><span class="p">(</span><span class="n">BeautifulSoup</span><span class="p">):</span>
    <span class="k">pass</span></div>
<div class="viewcode-block" id="RobustWackAssHTMLParser"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.RobustWackAssHTMLParser">[docs]</a><span class="k">class</span> <span class="nc">RobustWackAssHTMLParser</span><span class="p">(</span><span class="n">ICantBelieveItsBeautifulSoup</span><span class="p">):</span>
    <span class="k">pass</span></div>
<div class="viewcode-block" id="RobustInsanelyWackAssHTMLParser"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.RobustInsanelyWackAssHTMLParser">[docs]</a><span class="k">class</span> <span class="nc">RobustInsanelyWackAssHTMLParser</span><span class="p">(</span><span class="n">MinimalSoup</span><span class="p">):</span>
    <span class="k">pass</span></div>
<div class="viewcode-block" id="SimplifyingSOAPParser"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.SimplifyingSOAPParser">[docs]</a><span class="k">class</span> <span class="nc">SimplifyingSOAPParser</span><span class="p">(</span><span class="n">BeautifulSOAP</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="c">######################################################</span>
<span class="c">#</span>
<span class="c"># Bonus library: Unicode, Dammit</span>
<span class="c">#</span>
<span class="c"># This class forces XML data into a standard format (usually to UTF-8</span>
<span class="c"># or Unicode).  It is heavily based on code from Mark Pilgrim&#39;s</span>
<span class="c"># Universal Feed Parser. It does not rewrite the XML or HTML to</span>
<span class="c"># reflect a new encoding: that happens in BeautifulStoneSoup.handle_pi</span>
<span class="c"># (XML) and BeautifulSoup.start_meta (HTML).</span>

<span class="c"># Autodetects character encodings.</span>
<span class="c"># Download from http://chardet.feedparser.org/</span></div>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">chardet</span>
<span class="c">#    import chardet.constants</span>
<span class="c">#    chardet.constants._debug = 1</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">chardet</span> <span class="o">=</span> <span class="bp">None</span>

<span class="c"># cjkcodecs and iconv_codec make Python know about more character encodings.</span>
<span class="c"># Both are available from http://cjkpython.i18n.org/</span>
<span class="c"># They&#39;re built in if you use Python 2.4.</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">cjkcodecs.aliases</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">iconv_codec</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">pass</span>

<div class="viewcode-block" id="UnicodeDammit"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.UnicodeDammit">[docs]</a><span class="k">class</span> <span class="nc">UnicodeDammit</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;A class for detecting the encoding of a *ML document and</span>
<span class="sd">    converting it to a Unicode string. If the source encoding is</span>
<span class="sd">    windows-1252, can replace MS smart quotes with their HTML or XML</span>
<span class="sd">    equivalents.&quot;&quot;&quot;</span>

    <span class="c"># This dictionary maps commonly seen values for &quot;charset&quot; in HTML</span>
    <span class="c"># meta tags to the corresponding Python codec names. It only covers</span>
    <span class="c"># values that aren&#39;t in Python&#39;s aliases and can&#39;t be determined</span>
    <span class="c"># by the heuristics in find_codec.</span>
    <span class="n">CHARSET_ALIASES</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;macintosh&quot;</span> <span class="p">:</span> <span class="s">&quot;mac-roman&quot;</span><span class="p">,</span>
                        <span class="s">&quot;x-sjis&quot;</span> <span class="p">:</span> <span class="s">&quot;shift-jis&quot;</span> <span class="p">}</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">markup</span><span class="p">,</span> <span class="n">overrideEncodings</span><span class="o">=</span><span class="p">[],</span>
                 <span class="n">smartQuotesTo</span><span class="o">=</span><span class="s">&#39;xml&#39;</span><span class="p">,</span> <span class="n">isHTML</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">declaredHTMLEncoding</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">markup</span><span class="p">,</span> <span class="n">documentEncoding</span><span class="p">,</span> <span class="n">sniffedEncoding</span> <span class="o">=</span> \
                     <span class="bp">self</span><span class="o">.</span><span class="n">_detectEncoding</span><span class="p">(</span><span class="n">markup</span><span class="p">,</span> <span class="n">isHTML</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smartQuotesTo</span> <span class="o">=</span> <span class="n">smartQuotesTo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">triedEncodings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">markup</span> <span class="o">==</span> <span class="s">&#39;&#39;</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">markup</span><span class="p">,</span> <span class="nb">unicode</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">originalEncoding</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unicode</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">markup</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">u</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">proposedEncoding</span> <span class="ow">in</span> <span class="n">overrideEncodings</span><span class="p">:</span>
            <span class="n">u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convertFrom</span><span class="p">(</span><span class="n">proposedEncoding</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">u</span><span class="p">:</span> <span class="k">break</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">u</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">proposedEncoding</span> <span class="ow">in</span> <span class="p">(</span><span class="n">documentEncoding</span><span class="p">,</span> <span class="n">sniffedEncoding</span><span class="p">):</span>
                <span class="n">u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convertFrom</span><span class="p">(</span><span class="n">proposedEncoding</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">u</span><span class="p">:</span> <span class="k">break</span>

        <span class="c"># If no luck and we have auto-detection library, try that:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">u</span> <span class="ow">and</span> <span class="n">chardet</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">markup</span><span class="p">,</span> <span class="nb">unicode</span><span class="p">):</span>
            <span class="n">u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convertFrom</span><span class="p">(</span><span class="n">chardet</span><span class="o">.</span><span class="n">detect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">markup</span><span class="p">)[</span><span class="s">&#39;encoding&#39;</span><span class="p">])</span>

        <span class="c"># As a last resort, try utf-8 and windows-1252:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">u</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">proposed_encoding</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;utf-8&quot;</span><span class="p">,</span> <span class="s">&quot;windows-1252&quot;</span><span class="p">):</span>
                <span class="n">u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convertFrom</span><span class="p">(</span><span class="n">proposed_encoding</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">u</span><span class="p">:</span> <span class="k">break</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">unicode</span> <span class="o">=</span> <span class="n">u</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">u</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">originalEncoding</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">_subMSChar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">match</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Changes a MS smart quote character to an XML or HTML</span>
<span class="sd">        entity.&quot;&quot;&quot;</span>
        <span class="n">orig</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">sub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MS_CHARS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">orig</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span> <span class="o">==</span> <span class="n">types</span><span class="o">.</span><span class="n">TupleType</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">smartQuotesTo</span> <span class="o">==</span> <span class="s">&#39;xml&#39;</span><span class="p">:</span>
                <span class="n">sub</span> <span class="o">=</span> <span class="s">&#39;&amp;#x&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span> <span class="o">+</span> <span class="n">sub</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span> <span class="o">+</span> <span class="s">&#39;;&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sub</span> <span class="o">=</span> <span class="s">&#39;&amp;&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span> <span class="o">+</span> <span class="n">sub</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span> <span class="o">+</span> <span class="s">&#39;;&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sub</span> <span class="o">=</span> <span class="n">sub</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">sub</span>

    <span class="k">def</span> <span class="nf">_convertFrom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proposed</span><span class="p">):</span>
        <span class="n">proposed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_codec</span><span class="p">(</span><span class="n">proposed</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">proposed</span> <span class="ow">or</span> <span class="n">proposed</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">triedEncodings</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">triedEncodings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">proposed</span><span class="p">)</span>
        <span class="n">markup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">markup</span>

        <span class="c"># Convert smart quotes to HTML if coming from an encoding</span>
        <span class="c"># that might have them.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">smartQuotesTo</span> <span class="ow">and</span> <span class="n">proposed</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span><span class="p">(</span><span class="s">&quot;windows-1252&quot;</span><span class="p">,</span>
                                                      <span class="s">&quot;iso-8859-1&quot;</span><span class="p">,</span>
                                                      <span class="s">&quot;iso-8859-2&quot;</span><span class="p">):</span>
            <span class="n">smart_quotes_re</span> <span class="o">=</span> <span class="s">&quot;([</span><span class="se">\x80</span><span class="s">-</span><span class="se">\x9f</span><span class="s">])&quot;</span>
            <span class="n">smart_quotes_compiled</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">smart_quotes_re</span><span class="p">)</span>
            <span class="n">markup</span> <span class="o">=</span> <span class="n">smart_quotes_compiled</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subMSChar</span><span class="p">,</span> <span class="n">markup</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c"># print &quot;Trying to convert document to %s&quot; % proposed</span>
            <span class="n">u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_toUnicode</span><span class="p">(</span><span class="n">markup</span><span class="p">,</span> <span class="n">proposed</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">markup</span> <span class="o">=</span> <span class="n">u</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">originalEncoding</span> <span class="o">=</span> <span class="n">proposed</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
            <span class="c"># print &quot;That didn&#39;t work!&quot;</span>
            <span class="c"># print e</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="c">#print &quot;Correct encoding: %s&quot; % proposed</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">markup</span>

    <span class="k">def</span> <span class="nf">_toUnicode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Given a string and its encoding, decodes the string into Unicode.</span>
<span class="sd">        %encoding is a string recognized by encodings.aliases&#39;&#39;&#39;</span>

        <span class="c"># strip Byte Order Mark (if present)</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">data</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;</span><span class="se">\xfe\xff</span><span class="s">&#39;</span><span class="p">)</span> \
               <span class="ow">and</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&#39;</span><span class="se">\x00\x00</span><span class="s">&#39;</span><span class="p">):</span>
            <span class="n">encoding</span> <span class="o">=</span> <span class="s">&#39;utf-16be&#39;</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
        <span class="k">elif</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">data</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;</span><span class="se">\xff\xfe</span><span class="s">&#39;</span><span class="p">)</span> \
                 <span class="ow">and</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&#39;</span><span class="se">\x00\x00</span><span class="s">&#39;</span><span class="p">):</span>
            <span class="n">encoding</span> <span class="o">=</span> <span class="s">&#39;utf-16le&#39;</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
        <span class="k">elif</span> <span class="n">data</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;</span><span class="se">\xef\xbb\xbf</span><span class="s">&#39;</span><span class="p">:</span>
            <span class="n">encoding</span> <span class="o">=</span> <span class="s">&#39;utf-8&#39;</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
        <span class="k">elif</span> <span class="n">data</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;</span><span class="se">\x00\x00\xfe\xff</span><span class="s">&#39;</span><span class="p">:</span>
            <span class="n">encoding</span> <span class="o">=</span> <span class="s">&#39;utf-32be&#39;</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
        <span class="k">elif</span> <span class="n">data</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;</span><span class="se">\xff\xfe\x00\x00</span><span class="s">&#39;</span><span class="p">:</span>
            <span class="n">encoding</span> <span class="o">=</span> <span class="s">&#39;utf-32le&#39;</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
        <span class="n">newdata</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">newdata</span>

    <span class="k">def</span> <span class="nf">_detectEncoding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xml_data</span><span class="p">,</span> <span class="n">isHTML</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Given a document, tries to detect its XML encoding.&quot;&quot;&quot;</span>
        <span class="n">xml_encoding</span> <span class="o">=</span> <span class="n">sniffed_xml_encoding</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xml_data</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;</span><span class="se">\x4c\x6f\xa7\x94</span><span class="s">&#39;</span><span class="p">:</span>
                <span class="c"># EBCDIC</span>
                <span class="n">xml_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ebcdic_to_ascii</span><span class="p">(</span><span class="n">xml_data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">xml_data</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;</span><span class="se">\x00\x3c\x00\x3f</span><span class="s">&#39;</span><span class="p">:</span>
                <span class="c"># UTF-16BE</span>
                <span class="n">sniffed_xml_encoding</span> <span class="o">=</span> <span class="s">&#39;utf-16be&#39;</span>
                <span class="n">xml_data</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">xml_data</span><span class="p">,</span> <span class="s">&#39;utf-16be&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xml_data</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">xml_data</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;</span><span class="se">\xfe\xff</span><span class="s">&#39;</span><span class="p">)</span> \
                     <span class="ow">and</span> <span class="p">(</span><span class="n">xml_data</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&#39;</span><span class="se">\x00\x00</span><span class="s">&#39;</span><span class="p">):</span>
                <span class="c"># UTF-16BE with BOM</span>
                <span class="n">sniffed_xml_encoding</span> <span class="o">=</span> <span class="s">&#39;utf-16be&#39;</span>
                <span class="n">xml_data</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">xml_data</span><span class="p">[</span><span class="mi">2</span><span class="p">:],</span> <span class="s">&#39;utf-16be&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">xml_data</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;</span><span class="se">\x3c\x00\x3f\x00</span><span class="s">&#39;</span><span class="p">:</span>
                <span class="c"># UTF-16LE</span>
                <span class="n">sniffed_xml_encoding</span> <span class="o">=</span> <span class="s">&#39;utf-16le&#39;</span>
                <span class="n">xml_data</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">xml_data</span><span class="p">,</span> <span class="s">&#39;utf-16le&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xml_data</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">xml_data</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;</span><span class="se">\xff\xfe</span><span class="s">&#39;</span><span class="p">)</span> <span class="ow">and</span> \
                     <span class="p">(</span><span class="n">xml_data</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&#39;</span><span class="se">\x00\x00</span><span class="s">&#39;</span><span class="p">):</span>
                <span class="c"># UTF-16LE with BOM</span>
                <span class="n">sniffed_xml_encoding</span> <span class="o">=</span> <span class="s">&#39;utf-16le&#39;</span>
                <span class="n">xml_data</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">xml_data</span><span class="p">[</span><span class="mi">2</span><span class="p">:],</span> <span class="s">&#39;utf-16le&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">xml_data</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;</span><span class="se">\x00\x00\x00\x3c</span><span class="s">&#39;</span><span class="p">:</span>
                <span class="c"># UTF-32BE</span>
                <span class="n">sniffed_xml_encoding</span> <span class="o">=</span> <span class="s">&#39;utf-32be&#39;</span>
                <span class="n">xml_data</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">xml_data</span><span class="p">,</span> <span class="s">&#39;utf-32be&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">xml_data</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;</span><span class="se">\x3c\x00\x00\x00</span><span class="s">&#39;</span><span class="p">:</span>
                <span class="c"># UTF-32LE</span>
                <span class="n">sniffed_xml_encoding</span> <span class="o">=</span> <span class="s">&#39;utf-32le&#39;</span>
                <span class="n">xml_data</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">xml_data</span><span class="p">,</span> <span class="s">&#39;utf-32le&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">xml_data</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;</span><span class="se">\x00\x00\xfe\xff</span><span class="s">&#39;</span><span class="p">:</span>
                <span class="c"># UTF-32BE with BOM</span>
                <span class="n">sniffed_xml_encoding</span> <span class="o">=</span> <span class="s">&#39;utf-32be&#39;</span>
                <span class="n">xml_data</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">xml_data</span><span class="p">[</span><span class="mi">4</span><span class="p">:],</span> <span class="s">&#39;utf-32be&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">xml_data</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;</span><span class="se">\xff\xfe\x00\x00</span><span class="s">&#39;</span><span class="p">:</span>
                <span class="c"># UTF-32LE with BOM</span>
                <span class="n">sniffed_xml_encoding</span> <span class="o">=</span> <span class="s">&#39;utf-32le&#39;</span>
                <span class="n">xml_data</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">xml_data</span><span class="p">[</span><span class="mi">4</span><span class="p">:],</span> <span class="s">&#39;utf-32le&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">xml_data</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;</span><span class="se">\xef\xbb\xbf</span><span class="s">&#39;</span><span class="p">:</span>
                <span class="c"># UTF-8 with BOM</span>
                <span class="n">sniffed_xml_encoding</span> <span class="o">=</span> <span class="s">&#39;utf-8&#39;</span>
                <span class="n">xml_data</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">xml_data</span><span class="p">[</span><span class="mi">3</span><span class="p">:],</span> <span class="s">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sniffed_xml_encoding</span> <span class="o">=</span> <span class="s">&#39;ascii&#39;</span>
                <span class="k">pass</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">xml_encoding_match</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">xml_encoding_re</span> <span class="o">=</span> <span class="s">&#39;^&lt;\?.*encoding=[</span><span class="se">\&#39;</span><span class="s">&quot;](.*?)[</span><span class="se">\&#39;</span><span class="s">&quot;].*\?&gt;&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">xml_encoding_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">xml_encoding_re</span><span class="p">)</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">xml_data</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">xml_encoding_match</span> <span class="ow">and</span> <span class="n">isHTML</span><span class="p">:</span>
            <span class="n">meta_re</span> <span class="o">=</span> <span class="s">&#39;&lt;\s*meta[^&gt;]+charset=([^&gt;]*?)[;</span><span class="se">\&#39;</span><span class="s">&quot;&gt;]&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
            <span class="n">regexp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">meta_re</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span>
            <span class="n">xml_encoding_match</span> <span class="o">=</span> <span class="n">regexp</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">xml_data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xml_encoding_match</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">xml_encoding</span> <span class="o">=</span> <span class="n">xml_encoding_match</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span>
                <span class="s">&#39;ascii&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">isHTML</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">declaredHTMLEncoding</span> <span class="o">=</span> <span class="n">xml_encoding</span>
            <span class="k">if</span> <span class="n">sniffed_xml_encoding</span> <span class="ow">and</span> \
               <span class="p">(</span><span class="n">xml_encoding</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;iso-10646-ucs-2&#39;</span><span class="p">,</span> <span class="s">&#39;ucs-2&#39;</span><span class="p">,</span> <span class="s">&#39;csunicode&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;iso-10646-ucs-4&#39;</span><span class="p">,</span> <span class="s">&#39;ucs-4&#39;</span><span class="p">,</span> <span class="s">&#39;csucs4&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;utf-16&#39;</span><span class="p">,</span> <span class="s">&#39;utf-32&#39;</span><span class="p">,</span> <span class="s">&#39;utf_16&#39;</span><span class="p">,</span> <span class="s">&#39;utf_32&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;utf16&#39;</span><span class="p">,</span> <span class="s">&#39;u16&#39;</span><span class="p">)):</span>
                <span class="n">xml_encoding</span> <span class="o">=</span> <span class="n">sniffed_xml_encoding</span>
        <span class="k">return</span> <span class="n">xml_data</span><span class="p">,</span> <span class="n">xml_encoding</span><span class="p">,</span> <span class="n">sniffed_xml_encoding</span>


<div class="viewcode-block" id="UnicodeDammit.find_codec"><a class="viewcode-back" href="../../../SamPy.parsing.html#SamPy.parsing.BeautifulSoup.UnicodeDammit.find_codec">[docs]</a>    <span class="k">def</span> <span class="nf">find_codec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">charset</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_codec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CHARSET_ALIASES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">charset</span><span class="p">,</span> <span class="n">charset</span><span class="p">))</span> \
               <span class="ow">or</span> <span class="p">(</span><span class="n">charset</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_codec</span><span class="p">(</span><span class="n">charset</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;-&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)))</span> \
               <span class="ow">or</span> <span class="p">(</span><span class="n">charset</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_codec</span><span class="p">(</span><span class="n">charset</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;-&quot;</span><span class="p">,</span> <span class="s">&quot;_&quot;</span><span class="p">)))</span> \
               <span class="ow">or</span> <span class="n">charset</span>
</div>
    <span class="k">def</span> <span class="nf">_codec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">charset</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">charset</span><span class="p">:</span> <span class="k">return</span> <span class="n">charset</span>
        <span class="n">codec</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">codecs</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">charset</span><span class="p">)</span>
            <span class="n">codec</span> <span class="o">=</span> <span class="n">charset</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">LookupError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">return</span> <span class="n">codec</span>

    <span class="n">EBCDIC_TO_ASCII_MAP</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">def</span> <span class="nf">_ebcdic_to_ascii</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">c</span><span class="o">.</span><span class="n">EBCDIC_TO_ASCII_MAP</span><span class="p">:</span>
            <span class="n">emap</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">156</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">134</span><span class="p">,</span><span class="mi">127</span><span class="p">,</span><span class="mi">151</span><span class="p">,</span><span class="mi">141</span><span class="p">,</span><span class="mi">142</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span>
                    <span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">157</span><span class="p">,</span><span class="mi">133</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">135</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">146</span><span class="p">,</span><span class="mi">143</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span>
                    <span class="mi">128</span><span class="p">,</span><span class="mi">129</span><span class="p">,</span><span class="mi">130</span><span class="p">,</span><span class="mi">131</span><span class="p">,</span><span class="mi">132</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">136</span><span class="p">,</span><span class="mi">137</span><span class="p">,</span><span class="mi">138</span><span class="p">,</span><span class="mi">139</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span>
                    <span class="mi">144</span><span class="p">,</span><span class="mi">145</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">147</span><span class="p">,</span><span class="mi">148</span><span class="p">,</span><span class="mi">149</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">152</span><span class="p">,</span><span class="mi">153</span><span class="p">,</span><span class="mi">154</span><span class="p">,</span><span class="mi">155</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">158</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span>
                    <span class="mi">32</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="mi">161</span><span class="p">,</span><span class="mi">162</span><span class="p">,</span><span class="mi">163</span><span class="p">,</span><span class="mi">164</span><span class="p">,</span><span class="mi">165</span><span class="p">,</span><span class="mi">166</span><span class="p">,</span><span class="mi">167</span><span class="p">,</span><span class="mi">168</span><span class="p">,</span><span class="mi">91</span><span class="p">,</span><span class="mi">46</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span>
                    <span class="mi">38</span><span class="p">,</span><span class="mi">169</span><span class="p">,</span><span class="mi">170</span><span class="p">,</span><span class="mi">171</span><span class="p">,</span><span class="mi">172</span><span class="p">,</span><span class="mi">173</span><span class="p">,</span><span class="mi">174</span><span class="p">,</span><span class="mi">175</span><span class="p">,</span><span class="mi">176</span><span class="p">,</span><span class="mi">177</span><span class="p">,</span><span class="mi">93</span><span class="p">,</span><span class="mi">36</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">59</span><span class="p">,</span><span class="mi">94</span><span class="p">,</span>
                    <span class="mi">45</span><span class="p">,</span><span class="mi">47</span><span class="p">,</span><span class="mi">178</span><span class="p">,</span><span class="mi">179</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">181</span><span class="p">,</span><span class="mi">182</span><span class="p">,</span><span class="mi">183</span><span class="p">,</span><span class="mi">184</span><span class="p">,</span><span class="mi">185</span><span class="p">,</span><span class="mi">124</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">37</span><span class="p">,</span><span class="mi">95</span><span class="p">,</span><span class="mi">62</span><span class="p">,</span><span class="mi">63</span><span class="p">,</span>
                    <span class="mi">186</span><span class="p">,</span><span class="mi">187</span><span class="p">,</span><span class="mi">188</span><span class="p">,</span><span class="mi">189</span><span class="p">,</span><span class="mi">190</span><span class="p">,</span><span class="mi">191</span><span class="p">,</span><span class="mi">192</span><span class="p">,</span><span class="mi">193</span><span class="p">,</span><span class="mi">194</span><span class="p">,</span><span class="mi">96</span><span class="p">,</span><span class="mi">58</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">39</span><span class="p">,</span><span class="mi">61</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span>
                    <span class="mi">195</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="mi">98</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">101</span><span class="p">,</span><span class="mi">102</span><span class="p">,</span><span class="mi">103</span><span class="p">,</span><span class="mi">104</span><span class="p">,</span><span class="mi">105</span><span class="p">,</span><span class="mi">196</span><span class="p">,</span><span class="mi">197</span><span class="p">,</span><span class="mi">198</span><span class="p">,</span><span class="mi">199</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span>
                    <span class="mi">201</span><span class="p">,</span><span class="mi">202</span><span class="p">,</span><span class="mi">106</span><span class="p">,</span><span class="mi">107</span><span class="p">,</span><span class="mi">108</span><span class="p">,</span><span class="mi">109</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">111</span><span class="p">,</span><span class="mi">112</span><span class="p">,</span><span class="mi">113</span><span class="p">,</span><span class="mi">114</span><span class="p">,</span><span class="mi">203</span><span class="p">,</span><span class="mi">204</span><span class="p">,</span><span class="mi">205</span><span class="p">,</span>
                    <span class="mi">206</span><span class="p">,</span><span class="mi">207</span><span class="p">,</span><span class="mi">208</span><span class="p">,</span><span class="mi">209</span><span class="p">,</span><span class="mi">126</span><span class="p">,</span><span class="mi">115</span><span class="p">,</span><span class="mi">116</span><span class="p">,</span><span class="mi">117</span><span class="p">,</span><span class="mi">118</span><span class="p">,</span><span class="mi">119</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">121</span><span class="p">,</span><span class="mi">122</span><span class="p">,</span><span class="mi">210</span><span class="p">,</span>
                    <span class="mi">211</span><span class="p">,</span><span class="mi">212</span><span class="p">,</span><span class="mi">213</span><span class="p">,</span><span class="mi">214</span><span class="p">,</span><span class="mi">215</span><span class="p">,</span><span class="mi">216</span><span class="p">,</span><span class="mi">217</span><span class="p">,</span><span class="mi">218</span><span class="p">,</span><span class="mi">219</span><span class="p">,</span><span class="mi">220</span><span class="p">,</span><span class="mi">221</span><span class="p">,</span><span class="mi">222</span><span class="p">,</span><span class="mi">223</span><span class="p">,</span><span class="mi">224</span><span class="p">,</span>
                    <span class="mi">225</span><span class="p">,</span><span class="mi">226</span><span class="p">,</span><span class="mi">227</span><span class="p">,</span><span class="mi">228</span><span class="p">,</span><span class="mi">229</span><span class="p">,</span><span class="mi">230</span><span class="p">,</span><span class="mi">231</span><span class="p">,</span><span class="mi">123</span><span class="p">,</span><span class="mi">65</span><span class="p">,</span><span class="mi">66</span><span class="p">,</span><span class="mi">67</span><span class="p">,</span><span class="mi">68</span><span class="p">,</span><span class="mi">69</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">71</span><span class="p">,</span><span class="mi">72</span><span class="p">,</span>
                    <span class="mi">73</span><span class="p">,</span><span class="mi">232</span><span class="p">,</span><span class="mi">233</span><span class="p">,</span><span class="mi">234</span><span class="p">,</span><span class="mi">235</span><span class="p">,</span><span class="mi">236</span><span class="p">,</span><span class="mi">237</span><span class="p">,</span><span class="mi">125</span><span class="p">,</span><span class="mi">74</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">76</span><span class="p">,</span><span class="mi">77</span><span class="p">,</span><span class="mi">78</span><span class="p">,</span><span class="mi">79</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">81</span><span class="p">,</span>
                    <span class="mi">82</span><span class="p">,</span><span class="mi">238</span><span class="p">,</span><span class="mi">239</span><span class="p">,</span><span class="mi">240</span><span class="p">,</span><span class="mi">241</span><span class="p">,</span><span class="mi">242</span><span class="p">,</span><span class="mi">243</span><span class="p">,</span><span class="mi">92</span><span class="p">,</span><span class="mi">159</span><span class="p">,</span><span class="mi">83</span><span class="p">,</span><span class="mi">84</span><span class="p">,</span><span class="mi">85</span><span class="p">,</span><span class="mi">86</span><span class="p">,</span><span class="mi">87</span><span class="p">,</span><span class="mi">88</span><span class="p">,</span><span class="mi">89</span><span class="p">,</span>
                    <span class="mi">90</span><span class="p">,</span><span class="mi">244</span><span class="p">,</span><span class="mi">245</span><span class="p">,</span><span class="mi">246</span><span class="p">,</span><span class="mi">247</span><span class="p">,</span><span class="mi">248</span><span class="p">,</span><span class="mi">249</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">57</span><span class="p">,</span>
                    <span class="mi">250</span><span class="p">,</span><span class="mi">251</span><span class="p">,</span><span class="mi">252</span><span class="p">,</span><span class="mi">253</span><span class="p">,</span><span class="mi">254</span><span class="p">,</span><span class="mi">255</span><span class="p">)</span>
            <span class="kn">import</span> <span class="nn">string</span>
            <span class="n">c</span><span class="o">.</span><span class="n">EBCDIC_TO_ASCII_MAP</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span> \
            <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">chr</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">))),</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">chr</span><span class="p">,</span> <span class="n">emap</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">EBCDIC_TO_ASCII_MAP</span><span class="p">)</span>

    <span class="n">MS_CHARS</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;</span><span class="se">\x80</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;euro&#39;</span><span class="p">,</span> <span class="s">&#39;20AC&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x81</span><span class="s">&#39;</span> <span class="p">:</span> <span class="s">&#39; &#39;</span><span class="p">,</span>
                 <span class="s">&#39;</span><span class="se">\x82</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;sbquo&#39;</span><span class="p">,</span> <span class="s">&#39;201A&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x83</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;fnof&#39;</span><span class="p">,</span> <span class="s">&#39;192&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x84</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;bdquo&#39;</span><span class="p">,</span> <span class="s">&#39;201E&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x85</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;hellip&#39;</span><span class="p">,</span> <span class="s">&#39;2026&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x86</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;dagger&#39;</span><span class="p">,</span> <span class="s">&#39;2020&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x87</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;Dagger&#39;</span><span class="p">,</span> <span class="s">&#39;2021&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x88</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;circ&#39;</span><span class="p">,</span> <span class="s">&#39;2C6&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x89</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;permil&#39;</span><span class="p">,</span> <span class="s">&#39;2030&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x8A</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;Scaron&#39;</span><span class="p">,</span> <span class="s">&#39;160&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x8B</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;lsaquo&#39;</span><span class="p">,</span> <span class="s">&#39;2039&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x8C</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;OElig&#39;</span><span class="p">,</span> <span class="s">&#39;152&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x8D</span><span class="s">&#39;</span> <span class="p">:</span> <span class="s">&#39;?&#39;</span><span class="p">,</span>
                 <span class="s">&#39;</span><span class="se">\x8E</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;#x17D&#39;</span><span class="p">,</span> <span class="s">&#39;17D&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x8F</span><span class="s">&#39;</span> <span class="p">:</span> <span class="s">&#39;?&#39;</span><span class="p">,</span>
                 <span class="s">&#39;</span><span class="se">\x90</span><span class="s">&#39;</span> <span class="p">:</span> <span class="s">&#39;?&#39;</span><span class="p">,</span>
                 <span class="s">&#39;</span><span class="se">\x91</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;lsquo&#39;</span><span class="p">,</span> <span class="s">&#39;2018&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x92</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;rsquo&#39;</span><span class="p">,</span> <span class="s">&#39;2019&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x93</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;ldquo&#39;</span><span class="p">,</span> <span class="s">&#39;201C&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x94</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;rdquo&#39;</span><span class="p">,</span> <span class="s">&#39;201D&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x95</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;bull&#39;</span><span class="p">,</span> <span class="s">&#39;2022&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x96</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;ndash&#39;</span><span class="p">,</span> <span class="s">&#39;2013&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x97</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;mdash&#39;</span><span class="p">,</span> <span class="s">&#39;2014&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x98</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;tilde&#39;</span><span class="p">,</span> <span class="s">&#39;2DC&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x99</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;trade&#39;</span><span class="p">,</span> <span class="s">&#39;2122&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x9a</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;scaron&#39;</span><span class="p">,</span> <span class="s">&#39;161&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x9b</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;rsaquo&#39;</span><span class="p">,</span> <span class="s">&#39;203A&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x9c</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;oelig&#39;</span><span class="p">,</span> <span class="s">&#39;153&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x9d</span><span class="s">&#39;</span> <span class="p">:</span> <span class="s">&#39;?&#39;</span><span class="p">,</span>
                 <span class="s">&#39;</span><span class="se">\x9e</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;#x17E&#39;</span><span class="p">,</span> <span class="s">&#39;17E&#39;</span><span class="p">),</span>
                 <span class="s">&#39;</span><span class="se">\x9f</span><span class="s">&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s">&#39;Yuml&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">),}</span>

<span class="c">#######################################################################</span>


<span class="c">#By default, act as an HTML pretty-printer.</span></div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">prettify</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">home</a>|&nbsp;</li>
        <li><a href="../../../search.html">search</a>|&nbsp;</li>

          <li><a href="../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Sami-Matias Niemi.
    </div>
  </body>
</html>